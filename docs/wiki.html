

<HTML><HEAD><TITLE>Assembled JSPWiki Page</TITLE></HEAD> <link rel="stylesheet" type="text/css" href="style.css" /> <style type="text/css">body {margin: 20px}</style><BODY><UL><LI><A HREF="#Link_AppFuse">AppFuse</LI>
<LI><A HREF="#Link_AppFuseAntTasks">AppFuseAntTasks</LI>
<LI><A HREF="#Link_AppFuseCruiseControl">AppFuseCruiseControl</LI>
<LI><A HREF="#Link_AppFuseEclipse">AppFuseEclipse</LI>
<LI><A HREF="#Link_AppFuseOnPostgreSQL">AppFuseOnPostgreSQL</LI>
<LI><A HREF="#Link_AppFuseQuickStart">AppFuseQuickStart</LI>
<LI><A HREF="#Link_AppFuseSupport">AppFuseSupport</LI>
<LI><A HREF="#Link_AppGen">AppGen</LI>
<LI><A HREF="#Link_Articles">Articles</LI>
<LI><A HREF="#Link_CreateActions">CreateActions</LI>
<LI><A HREF="#Link_CreateDAO">CreateDAO</LI>
<LI><A HREF="#Link_CreateManager">CreateManager</LI>
<LI><A HREF="#Link_DevelopmentEnvironment">DevelopmentEnvironment</LI>
<LI><A HREF="#Link_HibernateRelationships">HibernateRelationships</LI>
<LI><A HREF="#Link_JSFBeans">JSFBeans</LI>
<LI><A HREF="#Link_RunningOnOracle">RunningOnOracle</LI>
<LI><A HREF="#Link_SpringControllers">SpringControllers</LI>
<LI><A HREF="#Link_TapestryPages">TapestryPages</LI>
<LI><A HREF="#Link_ValidationAndList">ValidationAndList</LI>
<LI><A HREF="#Link_ValidationAndListJSF">ValidationAndListJSF</LI>
<LI><A HREF="#Link_ValidationAndListSpring">ValidationAndListSpring</LI>
<LI><A HREF="#Link_ValidationAndListTapestry">ValidationAndListTapestry</LI>
<LI><A HREF="#Link_ValidationAndListWebWork">ValidationAndListWebWork</LI>
<LI><A HREF="#Link_WebWorkActions">WebWorkActions</LI>
</UL><A NAME="Link_AppFuse">
<h1>AppFuse</h1>
</A>
<div style="float: right; margin-left: 10px; margin-bottom: 10px">

<script language="JavaScript">
<!--

function SymError()
{
  return true;
}

window.onerror = SymError;

var SymRealWinOpen = window.open;

function SymWinOpen(url, name, attributes)
{
  return (new Object());
}

window.open = SymWinOpen;

//-->
</script>

<script type="text/javascript"><!--
google_ad_client = "pub-7968247362757416";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "990000";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "CC0000";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</div>
<h3 id='section-AppFuse-WhatIsAppFuse'>What is AppFuse?</h3>
<p><a href="http://appfuse.org"><img src="https://appfuse.dev.java.net/images/icon.gif" alt="AppFuse Logo" style="margin: 0px 10px 10px 0px; float: left" /></a><a href="http://www.frappr.com/appfuse"><img src="http://www.frappr.com/i/frapper_sticker.gif" style="float: right; margin: 0px 5px 10px 10px" alt="Check out our Frappr!" title="Check out our Frappr!"></a>
AppFuse is an application for "kickstarting" webapp development. <a class="external" href="https://appfuse.dev.java.net/servlets/ProjectDocumentList">Download</a><img class="outlink" src="images/out.png" alt="" />, extract and execute <b>ant new</b> to instantly be up and running with a Tomcat/MySQL app. Uses Ant, XDoclet, Spring, Hibernate (or iBATIS), JUnit, StrutsTestCase, Canoo's WebTest, Struts Menu, Display Tag Library, OSCache, JSTL and Struts (or Spring MVC). The Spring Framework has greatly enhanced AppFuse since February 2004.  It's used throughout for its Hibernate/iBATIS support, declarative transactions, dependency binding and layer decoupling.  This clean and simple framework has greatly reduced the complexity of AppFuse, and also eliminated
many lines of code.  In short, for J2EE - it's the best thing since sliced bread.  To learn more about what AppFuse is check out <a class="wikipage" href="Wiki.jsp?page=AppFuseDefinition">this wiki page</a>.
</p>
<p>Features include Authentication (using Acegi Security), Remember Me, Self Registration, Password Hint and GZip Compression. <i>The fuse to start your apps</i>.  
</p>
<p><p style="text-align: center"><strong style="font-size: 11px">Live Demos</strong><br/><a href="http://demo.appfuse.org/demos.html"><img src="https://appfuse.dev.java.net/images/screenshot.gif" alt="Screenshot" style="border: 1px solid silver" /></a></p>
</p>
<p>        <table style="width: 100%" style="margin: 0px auto">
            <tr>
            <td style="text-align: center">
                <strong style="font-size: 10px">Video: New Project and Feature Tour</strong><br/>
                <a href="http://demo.appfuse.org/setup.html">
                <img src="http://static.appfuse.org/images/setup-screenshot.png" alt="Setup Screenshot" width="300" height="187" style="border: 1px solid silver" /></a>
            </td>
            <td style="text-align: center">
                <strong style="font-size: 10px">Video: Code Generation with AppGen</strong><br/>
                <a href="http://demo.appfuse.org/appgen.html">
                <img src="http://static.appfuse.org/images/appgen-screenshot.png" alt="AppGen Screenshot" width="300" height="187" style="border: 1px solid silver" /></a>
            </td>
            </tr>
        </table>
</p>
</p>
<ul>
<li> <strong style="color: blue;">October 23, 2006:</strong> <a href="https://appfuse.dev.java.net/servlets/NewsItemView?newsItemID=4305">AppFuse 1.9.4 Released</a>. Spring 2.0, Hibernate 3.2, Facelets, Ajax4JSF and many other library upgrades.
</li>
<li> <strong style="color: blue">October 20, 2006:</strong> <a href="https://appfuse.dev.java.net/servlets/NewsItemView?newsItemID=4298">Equinox 1.7 Released</a>. Spring 2.0, Hibernate 3.2, Acegi Security, Ajax and Facelets/Ajax4JSF. All 50 combinations now available for <a class="external" href="https://equinox.dev.java.net/servlets/ProjectDocumentList?folderID=6185">download</a><img class="outlink" src="images/out.png" alt="" />.
</li>
<li> <strong style="color: blue">August 8, 2006:</strong> <a class="external" href="http://www-128.ibm.com/developerworks/java/library/j-appfuse/">Seven simple reasons to use AppFuse</a><img class="outlink" src="images/out.png" alt="" /> published on IBM developerWorks.
</li>
<li> <strong style="color: blue;">July 11, 2006:</strong> <a href="https://appfuse.dev.java.net/servlets/NewsItemView?newsItemID=3927">AppFuse 1.9.3 Released</a>. Bug fixes and upgrades to several dependencies.
</li>
<li> <strong style="color: blue;">June 6, 2006:</strong> <a href="https://appfuse.dev.java.net/servlets/NewsItemView?newsItemID=3826">AppFuse 1.9.2 Released</a>. CSS Framework integration, EMMA code-coverage support and AppGen sub-package support.
</li>
<li> <strong style="color: blue">April 7, 2006:</strong> <a href="https://appfuse.dev.java.net/servlets/NewsItemView?newsItemID=3526">AppFuse 1.9.1 Released</a>. This release includes XFire 1.0, Tapestry 4.0.1 and WebWork 2.2.2, as well as support for using AppGen to reverse engineer database tables (using Middlegen). iBATIS is now supported by AppGen and a <a href="http://raibledesigns.com/wiki/CreateDAOiBATIS.html">Create iBATIS DAO Tutorial</a> has been put together.
</li>
</ul>
<p>If you want to get started with AppFuse right away, view the <a class="wikipage" href="Wiki.jsp?page=AppFuseQuickStart">QuickStart Guide</a>.  If you want to learn more about AppFuse's architecture view my <a class="external" href="http://static.raibledesigns.com/downloads/appfuse-architecture.ppt">&quot;About AppFuse&quot; PowerPoint&quot;</a><img class="outlink" src="images/out.png" alt="" /> or checkout <a class="external" href="http://demo.raibledesigns.com/appfuse">a live demo</a><img class="outlink" src="images/out.png" alt="" />. I also wrote a <a class="external" href="http://appfuse.dev.java.net/AppFuse.pdf">recent presentation</a><img class="outlink" src="images/out.png" alt="" /> for Denver's No Fluff Just Stuff conference.
</p>
<div style="background: #ffd; border: 1px solid maroon; padding: 5px; padding-bottom: 0; margin-right: 140px">
For HowTos when developing with AppFuse, view the <a class="wikipage" href="Wiki.jsp?page=Articles">AppFuse Tutorials</a>.
<p>For common questions and howto's, view the  <a class="wikipage" href="Wiki.jsp?page=AppFuseSupport">FAQ</a>, the <a class="external" href="https://appfuse.dev.java.net/servlets/SummarizeList?listName=users">mailing list archive</a><img class="outlink" src="images/out.png" alt="" /> or visit the <a class="wikipage" href="Wiki.jsp?page=AppFuseIRC">AppFuse IRC channel</a>. AppFuse's project homepage is at <a class="external" href="http://appfuse.dev.java.net">http://appfuse.dev.java.net</a><img class="outlink" src="images/out.png" alt="" />.</div>
</p>
<p><i>To see what's next for AppFuse, see the <a class="wikipage" href="Wiki.jsp?page=AppFuseRoadmap">Roadmap</a>.</i>
</p>
<h3 id='section-AppFuse-October232006AppFuse1.9.4'><b>October 23, 2006</b> - AppFuse 1.9.4</h3>
This release's major new features are upgrading to Spring 2.0, Hibernate 3.2, and Facelets + Ajax4JSF integration for the JSF option. In addition, many libraries have been fixed and a few bugs have been squashed.
<ul>
<li> <a class="external" href="https://appfuse.dev.java.net/servlets/ProjectDocumentList?folderID=6196">Download</a><img class="outlink" src="images/out.png" alt="" /> 
</li>
<li> <a class="external" href="https://appfuse.dev.java.net/servlets/ProjectDocumentView?documentID=42722">Release Notes</a><img class="outlink" src="images/out.png" alt="" />
</li>
<li> <a class="external" href="http://demo.appfuse.org/demos.html">Online Demos</a><img class="outlink" src="images/out.png" alt="" />
</li>
<li> <a class="external" href="https://appfuse.dev.java.net/servlets/ProjectMailingListList">Mailing Lists</a><img class="outlink" src="images/out.png" alt="" /> &middot; <a class="external" href="http://appfuse.org/forums">Archives</a><img class="outlink" src="images/out.png" alt="" />
</li>
</ul>
<h3 id='section-AppFuse-July112006AppFuse1.9.3'><b>July 11, 2006</b> - AppFuse 1.9.3</h3>
This release is primarily a bug fix release, but also contains upgrades to several dependent libraries, including Acegi Security 1.0.1. 
<ul>
<li> <a class="external" href="https://appfuse.dev.java.net/servlets/ProjectDocumentList?folderID=5618">Download</a><img class="outlink" src="images/out.png" alt="" /> 
</li>
<li> <a class="external" href="https://appfuse.dev.java.net/servlets/ProjectDocumentView?documentID=37281">Release Notes</a><img class="outlink" src="images/out.png" alt="" />
</li>
<li> <a class="external" href="http://demo.appfuse.org/demos.html">Online Demos</a><img class="outlink" src="images/out.png" alt="" />
</li>
<li> <a class="external" href="https://appfuse.dev.java.net/servlets/ProjectMailingListList">Mailing Lists</a><img class="outlink" src="images/out.png" alt="" /> &middot; <a class="external" href="http://appfuse.org/forums">Archives</a><img class="outlink" src="images/out.png" alt="" />
</li>
</ul>
<h3 id='section-AppFuse-June62006AppFuse1.9.2'><b>June 6, 2006</b> - AppFuse 1.9.2</h3>
This release includes <a href="http://www.contentwithstyle.co.uk/Articles/17/">CSS Framework</a> integration, <a href="http://emma.sourceforge.net/">EMMA</a> code-coverage support and AppGen sub-package support. Thanks to the <a href="http://raibledesigns.com/page/rd?entry=css_framework_design_contest_final">CSS Framework Design Contest Winners</a>, Doug Hays and Mika Göckel for their help with this release.
<ul>
<li> <a class="external" href="https://appfuse.dev.java.net/servlets/ProjectDocumentList?folderID=5447">Download</a><img class="outlink" src="images/out.png" alt="" /> 
</li>
<li> <a class="external" href="https://appfuse.dev.java.net/servlets/ProjectDocumentView?documentID=35762">Release Notes</a><img class="outlink" src="images/out.png" alt="" />
</li>
<li> <a class="external" href="http://demo.appfuse.org/demos.html">Online Demos</a><img class="outlink" src="images/out.png" alt="" />
</li>
<li> <a class="external" href="https://appfuse.dev.java.net/servlets/ProjectMailingListList">Mailing Lists</a><img class="outlink" src="images/out.png" alt="" /> &middot; <a class="external" href="http://appfuse.org/forums">Archives</a><img class="outlink" src="images/out.png" alt="" />
</li>
</ul>
<h3 id='section-AppFuse-April72006AppFuse1.9.1'><b>April 7, 2006</b> - AppFuse 1.9.1</h3>
This release includes improvements and upgrades to Tapestry 4.0.1, WebWork 2.2.2, as well as support for using AppGen to reverse engineer database tables (using Middlegen). iBATIS is now supported by AppGen and a <a href="http://raibledesigns.com/wiki/CreateDAOiBATIS.html">Create DAO</a> tutorial has been put together for iBATIS. iBATIS and Middlegen support were provided by Bobby Diaz - <em>thanks Bobby!</em>
Also, a big thanks goes to Mika Göckel for writing an <a href="http://raibledesigns.com/wiki/AppFuseXFire.html">XFire Tutorial</a> and installer. To install and configure AppFuse for development, see the <a href="http://raibledesigns.com/wiki/AppFuseQuickStart.html">QuickStart Guide</a>. Thanks to all the <a href="http://appfuse.dev.java.net/sponsors.html">sponsors</a> who have contributed products and free hosting to the <a href="http://appfuse.org">AppFuse</a> project.
<ul>
<li> <a class="external" href="https://appfuse.dev.java.net/servlets/ProjectDocumentList?folderID=5108">Download</a><img class="outlink" src="images/out.png" alt="" /> 
</li>
<li> <a class="external" href="https://appfuse.dev.java.net/servlets/ProjectDocumentView?documentID=32408">Release Notes</a><img class="outlink" src="images/out.png" alt="" />
</li>
<li> <a class="external" href="http://demo.appfuse.org/demos.html">Online Demos</a><img class="outlink" src="images/out.png" alt="" />
</li>
<li> <a class="external" href="https://appfuse.dev.java.net/servlets/ProjectMailingListList">Mailing Lists</a><img class="outlink" src="images/out.png" alt="" /> &middot; <a class="external" href="http://appfuse.org/forums">Archives</a><img class="outlink" src="images/out.png" alt="" />
</li>
</ul>
<h3 id='section-AppFuse-January142006AppFuse1.9'><b>January 14, 2006</b> - AppFuse 1.9</h3>
This release includes full Acegi Security integration, support for Ajax with DWR and Scriptaculous and many bug fixes/upgrades. 
In addition, AppFuse can now be deployed without configuring your appserver. Of course, if you'd prefer to use a JNDI DataSource, that's easy as well. To install and configure AppFuse for development, see the <a class="editpage" title="Create 'QuickStartGuide'" href="Edit.jsp?page=QuickStartGuide">AppFuseQuickStart</a>. Thanks to all the <a href="http://appfuse.dev.java.net/sponsors.html">sponsors</a> who have contributed products and free hosting to the AppFuse project. 
<ul>
<li> <a class="external" href="https://appfuse.dev.java.net/servlets/ProjectDocumentList?folderID=4695">Download</a><img class="outlink" src="images/out.png" alt="" /> 
</li>
<li> <a class="external" href="https://appfuse.dev.java.net/servlets/ProjectDocumentView?documentID=27428">Release Notes</a><img class="outlink" src="images/out.png" alt="" />
</li>
<li> <a class="external" href="http://demo.appfuse.org/demos.html">Online Demos</a><img class="outlink" src="images/out.png" alt="" />
</li>
<li> <a class="external" href="https://appfuse.dev.java.net/servlets/ProjectMailingListList">Mailing Lists</a><img class="outlink" src="images/out.png" alt="" /> &middot; <a class="external" href="http://appfuse.org/forums">Archives</a><img class="outlink" src="images/out.png" alt="" />
</li>
</ul>
<h3 id='section-AppFuse-August272005AppFuse1.8.2'><b>August 27, 2005</b> - AppFuse 1.8.2</h3>
&#8203;&#8203;&#8203;&#8203;This release is mostly a bug fix release with no new features. It also includes upgrades to Acegi Security and the Spring Framework.
Thanks to all the <a class="external" href="http://appfuse.dev.java.net/sponsors.html">sponsors</a><img class="outlink" src="images/out.png" alt="" /> who have contributed products and free hosting to this project. 
<ul>
<li> <a class="external" href="https://appfuse.dev.java.net/servlets/ProjectDocumentList?folderID=3931">Download</a><img class="outlink" src="images/out.png" alt="" /> 
</li>
<li> <a class="external" href="https://appfuse.dev.java.net/servlets/ProjectDocumentView?documentID=19329">Release Notes</a><img class="outlink" src="images/out.png" alt="" />
</li>
<li> <a class="external" href="http://demo.appfuse.org/demos.html">Online Demos</a><img class="outlink" src="images/out.png" alt="" />
</li>
<li> <a class="external" href="https://appfuse.dev.java.net/servlets/ProjectMailingListList">Mailing Lists</a><img class="outlink" src="images/out.png" alt="" /> &middot; <a class="external" href="http://news.gmane.org/group/gmane.comp.java.appfuse.user">Archives</a><img class="outlink" src="images/out.png" alt="" />
</li>
</ul>
<h3 id='section-AppFuse-June152005AppFuse1.8.1'><b>June 15, 2005</b> - AppFuse 1.8.1</h3>
This release is mostly a bug fix release with no new features. It also includes many upgrades to the core libraries (Hibernate, Spring, iBATIS, MyFaces). Thanks to all the <a class="external" href="http://appfuse.dev.java.net/sponsors.html">sponsors</a><img class="outlink" src="images/out.png" alt="" /> who have contributed products and free hosting to the AppFuse project.  
<ul>
<li> <a class="external" href="https://appfuse.dev.java.net/servlets/ProjectDocumentList?folderID=3543">Download</a><img class="outlink" src="images/out.png" alt="" /> 
</li>
<li> <a class="external" href="https://appfuse.dev.java.net/servlets/ProjectDocumentView?documentID=16122">Release Notes</a><img class="outlink" src="images/out.png" alt="" />
</li>
<li> <a class="external" href="http://demo.appfuse.org/demos.html">Online Demos</a><img class="outlink" src="images/out.png" alt="" />
</li>
<li> <a class="external" href="https://appfuse.dev.java.net/servlets/ProjectMailingListList">Mailing Lists</a><img class="outlink" src="images/out.png" alt="" /> &middot; <a class="external" href="http://news.gmane.org/group/gmane.comp.java.appfuse.user">Archives</a><img class="outlink" src="images/out.png" alt="" />
</li>
</ul>
<h3 id='section-AppFuse-June152005ThogausTutorials'><b>June 15, 2005</b> - Thogau's Tutorials</h3>
Thomas Gaudin has put together a couple of detailed and easy-to-follow tutorials on his site.
<ul>
<li> <a class="external" href="http://www.thogau.net/page/thogau/tutorial01">Handling Dates with AppFuse and Struts</a><img class="outlink" src="images/out.png" alt="" />
</li>
<li> <a class="external" href="http://www.thogau.net/page/thogau/tutorial02">Building a persisted dynamic web tree</a><img class="outlink" src="images/out.png" alt="" />
</li>
</ul>
<h3 id='section-AppFuse-May62005JIRAInstalled'><b>May 6, 2005</b> - JIRA Installed</h3>
<a href="http://raibledesigns.com/page/rd?anchor=appfuse_videos">AppFuse Videos</a> created and setup a new <a href="http://issues.appfuse.org">JIRA Issue Tracker</a>. Thanks to <a href="http://atlassian.com">Atlassian</a> for the            free JIRA license and to <a href="http://contegix.com">Contegix</a> for hosting it.  Also thanks to <a href="http://kgbinternet.com">KGB Internet Solutions</a> for sponsoring the hosting of the <a href="http://demo.appfuse.org/demos.html">AppFuse Demos</a>.
<h3 id='section-AppFuse-April292005AppFuse1.8'><b>April 29, 2005</b> - AppFuse 1.8</h3>
This release replaces Container Managed Authentication (CMA) with <a class="external" href="http://acegisecurity.sf.net">Acegi Security</a><img class="outlink" src="images/out.png" alt="" />.  Other major features include numerous bug fixes to AppGen and a refactoring of build.xml to use Ant 1.6 features.  Eclipse and IDEA project files were also improved so you can easily run tests from within your IDE. A MyJavaPack <a class="external" href="https://appfuse.dev.java.net/files/documents/1397/13863/appfuse-installer-1.8.zip">all-in-one installer</a><img class="outlink" src="images/out.png" alt="" /> was also added so you can download everything you need for AppFuse at once.  Eclipse and its plugins were not included in the initial release, but may be in a future release.
<ul>
<li> <a class="external" href="https://appfuse.dev.java.net/servlets/ProjectDocumentList?folderID=3205">Download</a><img class="outlink" src="images/out.png" alt="" /> 
</li>
<li> <a class="external" href="https://appfuse.dev.java.net/servlets/ProjectDocumentView?documentID=13896">Release Notes</a><img class="outlink" src="images/out.png" alt="" />
</li>
<li> <a class="external" href="https://appfuse.dev.java.net/servlets/ProjectMailingListList">Mailing Lists</a><img class="outlink" src="images/out.png" alt="" /> &middot; <a class="external" href="http://news.gmane.org/group/gmane.comp.java.appfuse.user">Archives</a><img class="outlink" src="images/out.png" alt="" />
</li>
</ul>
<h3 id='section-AppFuse-December82004AppFuse1.7'><b>December 8, 2004</b> - AppFuse 1.7</h3>
This release adds support for <a class="external" href="http://myfaces.org">JSF/MyFaces</a><img class="outlink" src="images/out.png" alt="" /> and <a class="external" href="http://jakarta.apache.org/tapestry">Tapestry</a><img class="outlink" src="images/out.png" alt="" /> as web framework options. <a class="external" href="http://raibledesigns.com/wiki/Wiki.jsp?page=CreateDAO#appgen">AppGen</a><img class="outlink" src="images/out.png" alt="" /> has been updated to work with both of these frameworks and I added
new <a class="wikipage" href="Wiki.jsp?page=Articles">tutorials</a> as well. You can read about my experience in <a class="external" href="http://raibledesigns.com/page/rd?anchor=integrating_jsf_and_tapestry_into">Integrating JSF and Tapestry into AppFuse</a><img class="outlink" src="images/out.png" alt="" />.
<ul>
<li> <a class="external" href="https://appfuse.dev.java.net/servlets/ProjectDocumentList?folderID=2351">Download</a><img class="outlink" src="images/out.png" alt="" /> 
</li>
<li> <a class="external" href="https://appfuse.dev.java.net/servlets/ProjectDocumentView?documentID=9559">Release Notes</a><img class="outlink" src="images/out.png" alt="" />
</li>
<li> <a class="external" href="https://appfuse.dev.java.net/servlets/ProjectMailingListList">Mailing Lists</a><img class="outlink" src="images/out.png" alt="" /> &middot; <a class="external" href="http://news.gmane.org/group/gmane.comp.java.appfuse.user">Archives</a><img class="outlink" src="images/out.png" alt="" />
</li>
</ul>
<h3 id='section-AppFuse-November92004AppFuse1.6.1'><b>November 9, 2004</b> - AppFuse 1.6.1</h3>
This release is primarily a bug fix release, but it also contains a slick "AppGen" tool for generating full CRUD (with sample data and tests) from a POJO.  AppGen essentially automates everything you do in the <a class="wikipage" href="Wiki.jsp?page=Articles">tutorials</a>.  I still encourage users to read through and do the tutorials in order to learn the code that is being generated.   <a href="http://raibledesigns.com/wiki/Wiki.jsp?page=CreateDAO#appgen">Learn more about AppGen</a>.
<ul>
<li> <a class="external" href="https://appfuse.dev.java.net/servlets/ProjectDocumentList?folderID=2265">Download</a><img class="outlink" src="images/out.png" alt="" /> 
</li>
<li> <a class="external" href="https://appfuse.dev.java.net/servlets/ProjectDocumentView?documentID=8694">Release Notes</a><img class="outlink" src="images/out.png" alt="" />
</li>
<li> <a class="external" href="https://appfuse.dev.java.net/servlets/ProjectMailingListList">Mailing Lists</a><img class="outlink" src="images/out.png" alt="" /> &middot; <a class="external" href="http://news.gmane.org/group/gmane.comp.java.appfuse.user">Archives</a><img class="outlink" src="images/out.png" alt="" />
</li>
</ul>
<h3 id='section-AppFuse-October92004AppFuse1.6Released'><b>October 9, 2004</b> - AppFuse 1.6 Released</h3>
This release's main features are swapping out Tiles for SiteMesh and adding WebWork as a web framework option.  I also refactored the Struts Action tests to use MockStrutsTestCase and eliminated the need to use Cactus for running web tests.  This reduced test execution time by over 50%.  The relationship between users and roles was re-worked to take advantage of Hibernate's features as well.  
<ul>
<li> <a class="external" href="https://appfuse.dev.java.net/servlets/ProjectDocumentList?folderID=1982">Download</a><img class="outlink" src="images/out.png" alt="" /> 
</li>
<li> <a class="external" href="https://appfuse.dev.java.net/servlets/ProjectDocumentView?documentID=7712">Release Notes</a><img class="outlink" src="images/out.png" alt="" />
</li>
<li> <a class="external" href="https://appfuse.dev.java.net/servlets/ProjectMailingListList">Mailing Lists</a><img class="outlink" src="images/out.png" alt="" /> &middot; <a class="external" href="http://news.gmane.org/group/gmane.comp.java.appfuse.user">Archives</a><img class="outlink" src="images/out.png" alt="" />
</li>
</ul>
<h3 id='section-AppFuse-May272004AppFuse1.5Released'><b>May 27, 2004</b> - AppFuse 1.5 Released</h3>
This release has lots of modifications that I've been meaning to make for quite some time.  Specifically (1) removing the dependency on j2ee.jar and (2) <a class="external" href="http://raibledesigns.com/page/rd?anchor=no_more_struts_in_services">removing Struts from the services layer</a><img class="outlink" src="images/out.png" alt="" />.  I also made improvements to Spring and its context file loading so you should be able to <a href="http://raibledesigns.com/page/rd?anchor=mysql_conference_day_1">run unit tests from your IDE</a>.
<p></p>
<p>Other notables include full i18n support (with translations in Dutch, Portuguese and Chinese), improved setup-tomcat target (no additional JARs needed now), and an option to use Spring's MVC framework instead of Struts - <i>with full tutorials!</i>  If you'd like, you can <a class="external" href="http://jroller.com/page/raible?anchor=migrating_from_struts_to_spring">read more about my conversion from Struts to Spring</a><img class="outlink" src="images/out.png" alt="" />. <em>Enjoy!</em>
</p>
<hr />
<ul>
<li> <a class="external" href="https://appfuse.dev.java.net/servlets/ProjectDocumentList?folderID=1328&amp;amp;expandFolder=1328&amp;amp;folderID=1328">Download</a><img class="outlink" src="images/out.png" alt="" /> (~12.2 MB for src, ~5.6 MB for bin)
</li>
<li> <a class="external" href="https://appfuse.dev.java.net/servlets/ProjectDocumentView?documentID=4697&amp;amp;noNav=true">Release Notes</a><img class="outlink" src="images/out.png" alt="" />
</li>
<li> <a class="external" href="https://appfuse.dev.java.net/servlets/ProjectMailingListList">Mailing Lists</a><img class="outlink" src="images/out.png" alt="" />
</li>
</ul>
<p></p>
<h3 id='section-AppFuse-2004.03.01AppFuse1.4Released'><b>2004.03.01</b> - AppFuse 1.4 Released</h3>
<p>This release involves many changes: <a class="external" href="http://raibledesigns.com/page/rd?anchor=appfuse_refactorings_part_i_changing">re-arranging packages/directories</a><img class="outlink" src="images/out.png" alt="" />, <a class="external" href="http://raibledesigns.com/page/rd?anchor=appfuse_refactorings_part_ii_spring">Spring integration</a><img class="outlink" src="images/out.png" alt="" />, <a class="external" href="http://raibledesigns.com/page/rd?anchor=appfuse_refactorings_part_iii_remember">Remember Me refactorings</a><img class="outlink" src="images/out.png" alt="" /> and I also <a class="external" href="http://raibledesigns.com/page/rd?anchor=appfuse_refactorings_part_iv_replacing">added iBATIS as a persistence option</a><img class="outlink" src="images/out.png" alt="" />.  I also spent a lot of time going through the <a class="wikipage" href="Wiki.jsp?page=Articles">tutorials</a> to make sure they are up to date.  I've been using AppFuse 1.4 for a few weeks on my current project, and I really do like the way <a class="external" href="http://springframework.org">Spring</a><img class="outlink" src="images/out.png" alt="" /> makes it easy to configure Hibernate, Transactions and Interface-&gt;Implementation relationships.  If you're interested in upgrading your AppFuse 1.x app to use Spring, you can <a class="wikipage" href="Wiki.jsp?page=AppFuseSpringUpgrade">checkout this howto</a>.
</p>
<p>I also <a class="external" href="http://raibledesigns.com/page/rd?anchor=java_net_vs_sourceforge">made the leap</a><img class="outlink" src="images/out.png" alt="" /> and moved the AppFuse project from <a class="external" href="http://struts.sf.net">SourceForge</a><img class="outlink" src="images/out.png" alt="" /> to <a class="external" href="http://appfuse.dev.java.net">java.net</a><img class="outlink" src="images/out.png" alt="" />.  This is mainly so I have more control over mailing lists and adding other developers.  As of today, CVS files in SourceForge and Java.net are the same - but I'll only be updating Java.net from here on out.  I also have released files in both projects, but will only use java.net in the future.
</p>
<p>Here's a specific rundown of all the changes from the changelog. 
</p>
<ul>
<li> Added "cactus" task for running Cactus tests in Tomcat 4.x and Resin 3.0.5.
</li>
<li> Added Tomcat Ant tasks for managing tomcat with the Manager app and Ant.
<ul>
<li> Currently supports: install, remove, start, stop, reload and list.
</li>
<li> I recommend using "ant setup-tomcat deploy" and then using "ant reload" after running "ant deploy" when you change .java or config files.
</li>
</ul>
</li>
<li> Removed "upload" module and integrated file-upload into the core. Removed unnecessary scriplets from uploadForm.jsp.
</li>
<li> UI Enhancements: 
<ul>
<li> Changed CSS for error messages to have a red border around them - making it easier to distinguish errors from messages.
</li>
<li> Added onclick and onfocus event handler to form inputs to select the text when an input type="text" is clicked or focuses on.
</li>
</ul>
</li>
<li> Changed directory structure from common/ejb/web to dao/service/web. <a class="external" href="http://raibledesigns.com/page/rd?anchor=appfuse_refactorings_part_i_changing">Read more...</a><img class="outlink" src="images/out.png" alt="" />
</li>
<li> Added Spring to configure Hibernate, DAOs and Managers.  Configured declarative transactions at the service and dao layers.  Configured OpenSessionInViewFilter for guaranteeing one transaction per request. <a class="external" href="http://raibledesigns.com/page/rd?anchor=appfuse_refactorings_part_ii_spring">Read more...</a><img class="outlink" src="images/out.png" alt="" />
</li>
<li> Changed UserCounterListener to only record users that have logged in successfully.  Also added a screen to show currently logged in users.
</li>
<li> Changed default session timeout to 10 minutes instead of 60.
</li>
<li> Implemented persistent login cookie strategy (for Remember Me) as <a class="external" href="http://tinyurl.com/2wyqr">recommended by Charles</a><img class="outlink" src="images/out.png" alt="" />. <a class="external" href="http://raibledesigns.com/page/rd?anchor=appfuse_refactorings_part_iii_remember">Read more...</a><img class="outlink" src="images/out.png" alt="" />
</li>
<li> Added iBATIS as a persistence framework option. <a class="external" href="http://raibledesigns.com/page/rd?anchor=appfuse_refactorings_part_iv_replacing">Read more...</a><img class="outlink" src="images/out.png" alt="" />
</li>
<li> Added custom web.xml XDoclet template for ordering filters and listeners.
</li>
<li> Added support for generating indexed property setters in ActionForms when generating Forms with XDoclet.  This support includes adding Velocity JARs to the the list of 3rd party JARs.  Currently, Velocity is only used by XDoclet.
</li>
<li> Added "Account Information" e-mail as part of registration process.  This e-mail gets sent the e-mail address the user entered on signup.
</li>
<li> Dependent packages upgraded:
<ul>
<li> Cactus 1.6 Nightly (20030119) to support the "cactus" task and Resin 3.0.5
</li>
<li> JSTL 1.0.5
</li>
<li> Patched Canoo's WebTest to work with Ant 1.6
</li>
<li> Hibernate 2.1.2
</li>
<li> MySQL JDBC Driver 3.0.11
</li>
</ul>
</li>
</ul>
<hr />
<ul>
<li> <a class="external" href="https://appfuse.dev.java.net/servlets/ProjectDocumentList?folderID=770">Download</a><img class="outlink" src="images/out.png" alt="" /> (~11.5 MB for src, ~5.1 MB for bin)
</li>
<li> <a class="external" href="https://appfuse.dev.java.net/servlets/ProjectDocumentView?documentID=3182&amp;noNav=true">Release Notes</a><img class="outlink" src="images/out.png" alt="" />
</li>
<li> <a class="external" href="http://raibledesigns.com/downloads/appfuse/api/">API Documentation and Source</a><img class="outlink" src="images/out.png" alt="" />
</li>
<li> <a class="external" href="https://appfuse.dev.java.net/servlets/ProjectMailingListList">Mailing Lists</a><img class="outlink" src="images/out.png" alt="" />
</li>
</ul>
<p></p>
<h3 id='section-AppFuse-2004.01.16AppFuse1.3Released'><b>2004.01.16</b> - AppFuse 1.3 Released</h3>
<p>This release fixes a few compatibility issues with Resin and other databases - specifically PostgreSQL and DB2.  The major new functionality in this release is <b>Easy Database Switching</b>.  Basically, you can very easily switch from using MySQL to PostgreSQL by only changing a few properties in your build.properties.  I implemented this on my current project last week because I do most of my development (at the client) on a PowerBook.  The client wants to deploy onto a DB2 database - and there is not DB2 install for the Mac.  Since <a class="external" href="http://hibernate.org">Hibernate</a><img class="outlink" src="images/out.png" alt="" /> allows you to easily switch between databases, I figured I could develop using MySQL on the Mac, but have the default (CVS version) use DB2.  One of the things I didn't want to do was to have a build.properties.sample, because I love projects that "just work" when you type "ant".  So I changed the the build process so that database.properties is generated from default settings (MySQL) or the settings in build.properties (if specified).  As part of the build process, Ant looks for the following build.properties files:
</p>
<ul>
<li> ${user.home}/.${ant.project.name}-build.properties
</li>
<li> ${user.home}/.build.properties
</li>
<li> build.properties
</li>
</ul>
<p>What this allows you to do is to take your customized database settings and put them in ~/.build.properties and they'll be applied to any AppFuse-derived project.  This makes it easy to keep the CVS version of your project tied to one database and a developer's local version tied to a different database.  
</p>
<p>While it's true that you'll most likely only talk to one database during the duration of your project, this exercise proves that it's easy to migrate from MySQL to another database.  It also proves that AppFuse can easily integrate with other database (at least as of this release). Slick stuff IMO.  Here's a specific rundown of all the changes from the changelog.
</p>
<ul>
<li> Many changes to database settings so that database.properties is generated at run-time from properties in build.properties (defaults to MySQL).  This makes it easy for users to run a MySQL database in development and have a DB2 database (or any other) in production.  Just customize your database settings and put them in ~/.build.properties or ~/.appname- build.properties and these settings will be used instead of the default.
<ul>
<li> As part of this process, I tested AppFuse on DB2 8.1 (on Windows) and PostgreSQL 7.4 (on OS X).  
</li>
<li> Testing on other servers caused me to change from generator-class="native" to generator-class="increment" - which still works fine on MySQL.
</li>
</ul>
</li>
</ul>
<ul>
<li><ul>
<li> I also changed tomcat-context.xml to dynamically substitute database properties and defaultAutoCommit is now "true" by default.
</li>
</ul>
</li>
<li> Added error pages for 404 (page not found) and 403 (access denied), both with pretty pictures. ;0) Protected /editUser.do for admin role only.
</li>
<li> Moved filter-mappings from Filter's JavaDocs (XDoclet) to metadata/web/filter-mappings.xml in order to control the order of execution.
</li>
<li> Made RememberMe feature configurable via a "rememberMe.enabled" property in app-settings.xml. <i>This won't kick on Resin until the filter is invoked at least once.  Tomcat initializes filters on startup.</i>
</li>
<li> Upgraded oscache.jar in Hibernate 2.1.1 to OSCache 2.0.1 and configured OSCache to cache JSP changes.  Also modified the oscache-2.0.1.jar to have a URI for the tag library.  Turned off caching of JSP pages - to enable, uncomment filter-mapping in metadata/web/filter-mappings.xml.
</li>
<li> Made changes to be Resin 3.0.4 friendly.  <a class="wikipage" href="Wiki.jsp?page=AppFuseOnResin">Read More...</a>
</li>
<li> Refactored BaseDaoHibernate to consolidate retrieveObject and removeObject methods.  Also changed saveObject to do ses.saveOrUpdate and removed storeObject method. 
</li>
<li> Replaced CompressionFilter with <a class="external" href="http://www.onjava.com/pub/a/onjava/2003/11/19/filters.html">GZipFilter that works on Resin</a><img class="outlink" src="images/out.png" alt="" />. 
</li>
<li> Added print stylesheet support. <i>Thanks to Bear Giles for the suggestion.</i>
</li>
<li> Added <a class="external" href="http://www.opensymphony.com/clickstream">Clickstream</a><img class="outlink" src="images/out.png" alt="" /> and menu/JSPs to view user paths.
</li>
<li> Dependent packages upgraded:
<ul>
<li> XDoclet 1.2.0
</li>
<li> Cactus 1.6 Nightly (20030116) to support "cactus" task for supporting a "contextxml" attribute for testing in Tomcat.
</li>
</ul>
</li>
</ul>
<hr />
<ul>
<li> <a class="external" href="http://sourceforge.net/project/showfiles.php?group_id=49385&amp;amp;package_id=78758&amp;amp;release_id=210456">Download</a><img class="outlink" src="images/out.png" alt="" /> (~12.1 MB for src, ~4.3 MB for bin)
</li>
<li> <a class="external" href="http://sourceforge.net/project/shownotes.php?release_id=210456v">Release Notes</a><img class="outlink" src="images/out.png" alt="" />
</li>
<li> <a class="external" href="http://raibledesigns.com/downloads/appfuse/api/">API Documentation and Source</a><img class="outlink" src="images/out.png" alt="" />
</li>
<li> <a class="external" href="http://sourceforge.net/mailarchive/forum.php?forum_id=18761">Mailing List</a><img class="outlink" src="images/out.png" alt="" />
</li>
</ul>
<p><i>BTW, I hid all the older releases of AppFuse to avoid download confusion - if you need to download an older version, please let me know.</i>
</p>
<h3 id='section-AppFuse-2004.01.08AppFuseAndAnt1.6.0'><b>2004.01.08</b> - AppFuse and ant 1.6.0</h3>
<p>Upgrading from ant 1.5.4 to 1.6.0 necessitates the following change in build.xml (just FYI):
</p>
<pre>===================================================================
RCS file: /cvsroot/struts/appfuse/build.xml,v
retrieving revision 1.37
diff -r1.37 build.xml
5,6c5,6
&lt;     &lt;!ENTITY properties SYSTEM "file:properties.xml"&gt;
&lt;     &lt;!ENTITY app-settings SYSTEM "file:app-settings.xml"&gt;
---
&gt;     &lt;!ENTITY properties SYSTEM "file:./properties.xml"&gt;
&gt;     &lt;!ENTITY app-settings SYSTEM "file:./app-settings.xml"&gt;</pre>

otherwise ant complains about <tt>file:properties.xml could not be found</tt>.
<dl>
<dt></dt><dd><i>Friday, January 10th: Fixed in CVS.  However, there's still <a class="external" href="http://lists.canoo.com/pipermail/webtest/2004q1/001350.html">issues with running Canoo's WebTest with 1.6.0</a><img class="outlink" src="images/out.png" alt="" /></i></dd>
</dl>
<p></p>
<h3 id='section-AppFuse-2003.12.20AppFuse1.2Released'><b>2003.12.20</b> - AppFuse 1.2 Released</h3>
<p>This is primarily a bug fix release.  Here are the details from the release notes:
</p>
<ul>
<li>  Backed out Http Post for Remember Me.  It was not redirecting user to the page they originally requested.  Using reponse.sendRedirect does send the user to the proper location.  Turned on password encryption (SHA) to protect any passwords that end up in log files.  Turned off encryption in Tomcat.
</li>
<li> Changed configuration parameters in servlet context to be in a hashmap.
</li>
<li> Improvements to StrutsGen tool to generate list screen as well and to fill in more missing elements.
</li>
<li> Changed to close Hibernate session when object not found in BaseDaoHibernate.
</li>
<li> Fixed bug in UserAction.save: when creating a new user, role defaults to "tomcat" regardless of what the user chooses.
</li>
<li> Dependent packages upgraded:
<ul>
<li> Hibernate 2.1.1
</li>
<li> Struts Menu 2.1
</li>
<li> WebTest Build 379
</li>
</ul>
</li>
</ul>
<hr />
<ul>
<li> <a class="external" href="http://tinyurl.com/2ymhm">Download</a><img class="outlink" src="images/out.png" alt="" /> (~11.9 MB for src, ~4.3 MB for bin)
</li>
<li> <a class="external" href="http://sourceforge.net/project/shownotes.php?release_id=205161">Release Notes</a><img class="outlink" src="images/out.png" alt="" />
</li>
<li> <a class="external" href="http://raibledesigns.com/downloads/appfuse/api/">API Documentation and Source</a><img class="outlink" src="images/out.png" alt="" />
</li>
<li> <a class="external" href="http://sourceforge.net/mailarchive/forum.php?forum_id=18761">Mailing List</a><img class="outlink" src="images/out.png" alt="" />
</li>
</ul>
<h3 id='section-AppFuse-2003.12.12AppFuse1.1Released'><b>2003.12.12</b> - AppFuse 1.1 Released</h3>
<p>This biggest feature in this release is <b>Documentation</b>.  I finally found the time to write up some <a class="wikipage" href="Wiki.jsp?page=Articles">Tutorials</a> on developing with AppFuse.  They're on this wiki and also in the "docs" folder of the binary and source downloads.  In writing this documentation, I went through almost all aspects of the code with a fine-tooth comb made sure it's doing what I want it to do.  
</p>
<p>I was finally able to get things working with J2EE 1.4, which basically involved removing j2ee.jar from my MailUtil's classpath and just including activation.jar and mail.jar. If you're not there yet, simply change the paths for activation.jar and mail.jar in properties.xml (look for common.compile.classpath). You can use j2ee.jar instead of mail.jar and activation.jar with J2EE 1.3 and 1.4 B2.
</p>
<p>I was also able to get all unit tests to pass on Tomcat 5, and the "setup-tomcat" target now supports Tomcat 5.  I wasn't able to get "Remember Me" to work - see <a class="external" href="http://tinyurl.com/ywv4">the tomcat-user mailing list</a><img class="outlink" src="images/out.png" alt="" /> for more details.
</p>
<p>Included in this release are upgrades to <a class="external" href="http://hibernate.org">Hibernate</a><img class="outlink" src="images/out.png" alt="" /> 2.1 Final and <a class="external" href="http://displaytag.sf.net">Display Tag</a><img class="outlink" src="images/out.png" alt="" /> 1.0 B2.  For a complete changelog, <a class="external" href="http://tinyurl.com/yzx6">view the README.txt in CVS</a><img class="outlink" src="images/out.png" alt="" />.
</p>
<ul>
<li> <a class="external" href="http://sourceforge.net/project/showfiles.php?group_id=49385&amp;amp;release_id=203060">Download</a><img class="outlink" src="images/out.png" alt="" /> (~13.4 MB for src, ~4.3 MB for bin)
</li>
<li> <a class="external" href="http://sourceforge.net/project/shownotes.php?release_id=203060">Release Notes</a><img class="outlink" src="images/out.png" alt="" />
</li>
<li> <a class="external" href="http://raibledesigns.com/downloads/appfuse/api/">API Documentation and Source</a><img class="outlink" src="images/out.png" alt="" />
</li>
<li> <a class="external" href="http://sourceforge.net/mailarchive/forum.php?forum_id=18761">Mailing List</a><img class="outlink" src="images/out.png" alt="" />
</li>
</ul>
<h3 id='section-AppFuse-2003.11.30AppFuse1.0Released'><b>2003.11.30</b> - AppFuse 1.0 Released</h3>
<p>I feel this release deserves the big <b>1.0</b> designation because it is an up-to-date representation of my learnings and my perceived
best practices in building web applications.  Of course, as I learn more, I will continue to push out new releases.
</p>
<p>In this release, I did a lot of refactoring and enhancements to existing features.  The DAO and Manager interfaces are no longer tied
to Struts or Hibernate.  Hibernate's Session object is now passed as an argument into Manager and DAO constructors, rather than
method signatures.  The DAOFactory was refactored by <a href="http://www.coyotesong.com/">Bear Giles</a> to use reflection to
instantiate Hibernate DAO's.  Now, if you add a new DAO, you don't have to edit DAOFactory and DAOFactoryHibernate.  To insantiate a
new DAO, the code is now:
</p>
<pre>
LookupDAO dao = (LookupDAO) DAOFactory.getInstance(conn, LookupDAO.class);
</pre>

<p>...where <b>conn</b> is a connection object retrieved from ServiceLocator or ActionFilter.  When you add new POJOs, you still have to add them to ServiceLocator (for JUnit tests) and hibernate.cfg.xml, which is kindof a pain.  I'd like to figure out a way to tell Hibernate to just look in appfuse-ejb.jar.
</p>
<p>The Remember Me feature has been refactored so the username and password cookies are only available under
the /appfuse/security url-pattern.  I also changed the posting to "j_security_check" in LoginServlet from response.sendRedirect to
an HTTP POST, using Jakarta Common's HttpClient.  The reason I have a LoginServlet vs. just using action="j_security_check" in my &lt;form&gt; is to encrypt passwords.  
</p>
<p>I've developed 3 different applications using AppFuse (<a class="wikipage" href="Wiki.jsp?page=StrutsResume">struts-resume</a> is one of them), and I have found that it's a pain to 
upgrade to new versions of AppFuse.  Because of this, I don't recommend upgrading unless you really need to.  I will be upgrading 
struts-resume to AppFuse 1.0, but I doubt I'll upgrade it to any future AppFuse releases - it's just too much work for not much reward.
</p>
<ul>
<li> <a class="external" href="http://sourceforge.net/project/showfiles.php?group_id=49385&amp;amp;release_id=200891">Download</a><img class="outlink" src="images/out.png" alt="" /> (~11.5 MB for src, ~3.9 MB for bin) 
</li>
<li> <a class="external" href="http://sourceforge.net/project/shownotes.php?release_id=200891">Release Notes</a><img class="outlink" src="images/out.png" alt="" />
</li>
<li> <a class="external" href="http://raibledesigns.com/downloads/appfuse/api/">API Documentation and Source</a><img class="outlink" src="images/out.png" alt="" />
</li>
<li> <a class="external" href="http://sourceforge.net/mailarchive/forum.php?forum_id=18761">Mailing List</a><img class="outlink" src="images/out.png" alt="" />
</li>
</ul>
<p>Older releases can be found at <a class="external" href="http://raibledesigns.com/downloads">http://raibledesigns.com/downloads</a><img class="outlink" src="images/out.png" alt="" />.
</p>
<p>If you'd like to encourage me to improve AppFuse, <a class="external" href="https://www.paypal.com/xclick/business=matt%40raibledesigns.com&amp;item_name=AppFuse+Development&amp;return=http%3A//raibledesigns.com/wiki/Wiki.jsp%3Fpage%3DAppFuse&amp;cancel_return=http%3A//raibledesigns.com/wiki/Wiki.jsp%3Fpage%3DAppFuse&amp;no_note=1&amp;tax=0&amp;currency_code=USD">you can make a donation</a><img class="outlink" src="images/out.png" alt="" />.
</p>
<A NAME="Link_AppFuseAntTasks">
<h1>AppFuseAntTasks</h1>
</A>
This page contains a listing of the most common Ant targets in <a class="wikipage" href="Wiki.jsp?page=AppFuse">AppFuse</a> that I use in my daily development.  For a complete list of tasks, type "ant -projecthelp" at the command line.
<p><style type="text/css">
table.wikitable {border: 1px solid black; margin: 10px; border-collapse: collapse}
table.wikitable td {border: 1px solid black; padding: 3px}
table.wikitable th {background: #eee}
table.wikitable span {color: red}
</style>
</p>
<table class="wikitable" border="1">
<tr><th>Task</th><th>Description</th></tr>
<tr><td>setup</td><td>Sets up database, tomcat and deploys expanded war</td></tr>
<tr><td>clean</td><td>Removes build artifacts</td></tr>
<tr><td>compile</td><td>Compiles everything</td></tr>
<tr><td><b>deploy</b></td><td>Compiles and deploys everything to Tomcat</td></tr>
<tr><td><b>deploy-web</b></td><td>Deploys JSPs and static web content to Tomcat</td></tr>
<tr><td>install</td><td>Install application in Tomcat using Tomcat's Manager app.  Great for deploying to remote servers.</td></tr>
<tr><td>list</td><td>List Tomcat's installed applications</td></tr>
<tr><td>refresh</td><td>Undeploys, cleans, then re-deploys. Nice for when you <em>swear</em> it should be working, but your change doesn't show up</td></tr>
<tr><td><b>reload</b></td><td>Reload application in Tomcat</td></tr>
<tr><td>remove</td><td>Remove application in Tomcat</td></tr>
<tr><td>setup-db</td><td>creates database and populates it with sample data</td></tr>
<tr><td>setup-tomcat</td><td>copies jdbc driver and context.xml to Tomcat</td></tr>
<tr><td><b>test-all</b></td><td>runs all tests for dao, service and web</td></tr>
<tr><td>test-dao</td><td>Test dao module</td></tr>
<tr><td>test-service</td><td>Test service module</td></tr>
<tr><td>test-web</td><td>Runs Action/Controller tests using Mocks (no container required)</td></tr>
<tr><td>test-jsp</td><td>Runs Canoo WebTests in tomcat (starts/stops server, Tomcat should be stopped)</td></tr>
<tr><td>test-canoo</td><td>Runs Canoo WebTests in Tomcat when it's already running</td></tr>
<tr><td>test-reports</td><td>Generate test reports</td></tr>
<tr><td>undeploy</td><td>delete war file and directory from $CATALINA_HOME/webapps</td></tr>
</table>
<A NAME="Link_AppFuseCruiseControl">
<h1>AppFuseCruiseControl</h1>
</A>
It's pretty easy to setup your <a class="wikipage" href="Wiki.jsp?page=AppFuse">AppFuse</a> application to work with <a class="external" href="http://cruisecontrol.sourceforge.net">CruiseControl</a><img class="outlink" src="images/out.png" alt="" />.  You can either download the files from this page or if you're using 1.6.1+ - they're located in the <i>extras/cruisecontrol</i> directory.  Thanks to <a class="external" href="http://www.clarkware.com/cgi/blosxom">Mike Clark</a><img class="outlink" src="images/out.png" alt="" /> and <a class="external" href="http://www.pragmaticprogrammer.com/titles/prj/index.html"> Jared Richardson</a><img class="outlink" src="images/out.png" alt="" /> for their help getting this work. 
<p><div class="note" style="margin: 5px"><b>NOTE:</b> I recommend setting up CruiseControl on a Linux machine if you <a class="external" href="http://www.clarkware.com/cgi/blosxom/2004/10/19#TheyNeedABuildMachine">have one available</a><img class="outlink" src="images/out.png" alt="" />
</div>
</p>
<p>To run CruiseControl on your AppFuse project, perform the following steps:
</p>
<p>1. <a class="external" href="http://cruisecontrol.sourceforge.net/download.html">Download</a><img class="outlink" src="images/out.png" alt="" /> and install CruiseControl 2.4.1. Extract it to your $TOOLS_HOME directory, wherever that may be.
</p>
<p>2. After you've installed CruiseControl, download the following files and put them in the cruisecontrol-2.4.1 ($CC_HOME) directory.
</p>
<ul>
<li> <a class="attachment" href="attach/AppFuseCruiseControl/build.xml">build.xml</a><a href="PageInfo.jsp?page=AppFuseCruiseControl/build.xml"><img src="images/attachment_small.png" border="0" alt="(info)"/></a>
</li>
<li> <a class="attachment" href="attach/AppFuseCruiseControl/config.xml">config.xml</a><a href="PageInfo.jsp?page=AppFuseCruiseControl/config.xml"><img src="images/attachment_small.png" border="0" alt="(info)"/></a>
</li>
</ul>
<p>The latest version of these files can be found <a class="external" href="https://appfuse.dev.java.net/source/browse/appfuse/extras/cruisecontrol">in CVS</a><img class="outlink" src="images/out.png" alt="" /> or in your project's <i>extras/cruisecontrol</i> directory.
</p>
<p>3. Modify config.xml for your e-mail address and project name.
</p>
<p>4. Modify build.xml so it points to your CVS server and project.
</p>
<p>5. Run "ant" in the current directory or checkout your project into the "projects". 
</p>
<p>6. Run cruisecontrol.bat (Windows) or cruisecontrol.sh (Unix).
</p>
<span class="note"><b>NOTE:</b> If you're using Subversion instead of CVS, <a class="external" href="http://subclipse.tigris.org/servlets/ProjectDocumentList?folderID=1731">download svnant</a><img class="outlink" src="images/out.png" alt="" />. Extract the download into your <i>work</i> directory, delete everything but it's "lib" directory and adjust the path in build.xml accordingly.</span>
<p>I was puzzled why my HTML E-Mails didn't contain all the pretty formatting like Spring's does.  Then I looked at their <a class="external" href="http://article.gmane.org/gmane.comp.java.springframework.devel/6300">latest archived one</a><img class="outlink" src="images/out.png" alt="" /> and noticed it looks the same on Gmane as it does in GMail.  I'd recommend sending your build notifications to an e-mail account that can be read with a good HTML e-mail reader.
</p>
<p>If you want to use CruiseControl to build your <a class="external" href="https://equinox.dev.java.net">Equinox</a><img class="outlink" src="images/out.png" alt="" /> project, that's in <a class="external" href="https://equinox.dev.java.net/source/browse/equinox/extras/cruisecontrol">Equinox's CVS</a><img class="outlink" src="images/out.png" alt="" />.
</p>
<h3 id='section-AppFuseCruiseControl-SetupCruiseControlDaemon'>Setup CruiseControl Daemon</h3>
After getting all the above working, I setup CruiseControl to run as a daemon. I has some issues with getting <a class="external" href="http://confluence.public.thoughtworks.org/display/CC/RunningCruiseControlFromUnixInit">these instructions</a><img class="outlink" src="images/out.png" alt="" /> working, so I <a class="external" href="http://www.nabble.com/forum/ViewPost.jtp?post=3195390&amp;amp;framed=y">pinged the mailing list</a><img class="outlink" src="images/out.png" alt="" />. After a few back-and-forth e-mails, the following solution worked for me on Suse 10.
<ul>
<li> Create an /etc/init.d/cruisecontrol script with the following script.  Make sure and chmod +x /etc/init.d/cruisecontrol.
</li>
</ul>
<div style="margin-left: 40px">
<pre>
#!/bin/sh 
#content of /opt/cruisecontrol/init script
# chkconfig: 345 99 05 
# description: CruiseControl build loop (see /home/tools)

# based on http://confluence.public.thoughtworks.org/display/CC/RunningCruiseControlFromUnixInit
# adapted for multiple projects

#
# Cruise Control startup: Startup and kill script for Cruise Control
#

PATH=/sbin:/usr/sbin:/usr/bin:/bin
export PATH

NAME=cruisecontrol
DESC="CruiseControl 2.2 continuous integration build loop"

CC_USER=mraible
CC_WORK_DIR=/opt/tools/cruisecontrol
CC_INSTALL_DIR=/opt/tools/cruisecontrol

CC_DAEMON=$CC_INSTALL_DIR/cruise.sh
CC_CONFIG_FILE=$CC_WORK_DIR/config.xml
CC_LOG_FILE=$CC_WORK_DIR/cruisecontrol.log
CC_PORT=8082
CC_RMIPORT=
CC_COMMAND="$CC_DAEMON -configfile $CC_CONFIG_FILE -port $CC_PORT -rmiport $CC_RMIPORT"

# overwrite settings from default file
if [ -f /etc/default/cruisecontrol ]; then
  . /etc/default/cruisecontrol
fi

test -f $CC_DAEMON || exit 0

if [ `id -u` -ne 0 ]; then
        echo "Not starting/stopping $DESC, you are not root."
        exit 4
fi

# PPID is read-only in my shell - GNU bash, version 2.05b.0(1)-release (i586-mandrake-linux-gnu)
PARPID=`ps -ea -o "pid ppid args" | grep -v grep | grep "${CC_DAEMON}" | sed -e 's/^  *//' -e 's/ .*//'`

if [ "${PARPID}" != "" ]
then
  PID=`ps -ea -o "pid ppid args" | grep -v grep | grep java | grep "${PARPID}" | \
      sed -e 's/^  *//' -e 's/ .*//'`
fi

case "$1" in
 
  'start')
  # going into the work dir allows for use of relative PATHs in the config file
    cd $CC_WORK_DIR
    su $CC_USER -c "$CC_COMMAND &gt;&gt; $CC_LOG_FILE 2&gt;&amp;1" &amp; RETVAL=$? 
    echo "$NAME started with jmx on port ${CC_PORT}"
    ;;

  'stop')
    if [ "${PID}" != "" ]
    then
     kill -9 ${PID} ${PARPID}
      $0 status
      RETVAL=$?
    else
      echo "$NAME is not running"
      RETVAL=1
    fi
    ;;

  'status')
    # echo PARPIDs $PARPID
    # echo PIDs $PID
    kill -0 $PID &gt;/dev/null 2&gt;&amp;1
    if [ "$?" = "0" ]
    then
      echo $NAME \(pids $PARPID $PID\) is running
      RETVAL=0
    else
      echo "$NAME is stopped"
      RETVAL=1
    fi
    ;;

  'restart')
    $0 stop &amp;&amp; $0 start
    RETVAL=$?
    ;;

  *)
    echo "Usage: $0 { start | stop | status | restart }"
    exit 1
    ;;
esac
#echo ending $0 $$....
exit 0;
</pre>

</div>
<p>That's it - you should be able to run /etc/init.d/cruisecontrol as root and CC will check for new updates every hour.
</p>
<A NAME="Link_AppFuseEclipse">
<h1>AppFuseEclipse</h1>
</A>
<a class="wikipage" href="Wiki.jsp?page=AppFuse">AppFuse</a>, by default, is configured to be an <a class="external" href="http://www.eclipse.org">Eclipse</a><img class="outlink" src="images/out.png" alt="" /> project.  When you run <b>ant new</b> to create a new project, you will get the .project and .classpath files to start your project with.  However, you will need to make a few easy setting changes in Eclipse (particularly to run <a class="external" href="http://jakarta.apache.org/ant">Ant</a><img class="outlink" src="images/out.png" alt="" />).  This tutorial shows you how to setup Eclipse to develop your AppFuse project.
<dl>
<dt></dt><dd><i>In general, I don't use Eclipse for much more than a fancy text editor.  I do most of my compiling, testing and deployment from the command line.  This howto will hopefully make it easier for you to use Eclipse for building and testing, but if it doesn't work for you - the best fallback is to use the command line for running the Ant tasks.  Of course, if you figure out ways to make the Eclipse integration better - please <a class="external" href="mailto:users@appfuse.dev.java.net">let me know</a><img class="outlink" src="images/out.png" alt="" />.</i></dd>
</dl>
<p>This tutorial is based on Windows XP and Eclipse 3.0.1 and should work on any platform.  You can <a class="external" href="http://cudlug.cudenver.edu/eclipse/eclipse/downloads/drops/R-3.0.1-200409161125/">download Eclipse 3.0.1</a><img class="outlink" src="images/out.png" alt="" /> if you don't already have it installed.  I also recommend downloading <a class="external" href="http://www.raibledesigns.com/page/rd/?anchor=eclipse_plugins_updated_for_31">my Eclipse plugins bundle</a><img class="outlink" src="images/out.png" alt="" /> or purchasing <a class="external" href="http://www.myeclipseide.com">MyEclipse</a><img class="outlink" src="images/out.png" alt="" />.  A pipe dream of mine is to be able to use create a MyEclipse/AppFuse project - but that would likely require an entire rewrite of AppFuse's directory structure and build file and I just don't have the time or energy.  Besides, the current system works pretty well if you don't mind using Ant.  
</p>
<h4 id='section-AppFuseEclipse-TableOfContents'>Table of Contents</h4>
<ul>
<li> <a class="footnoteref" href="#ref-AppFuseEclipse-1">[1]</a> Create New Java Project in Eclipse
</li>
<li> <a class="footnoteref" href="#ref-AppFuseEclipse-2">[2]</a> Configuring Ant in Eclipse
</li>
<li> <a class="footnoteref" href="#ref-AppFuseEclipse-3">[3]</a> Add build.xml to Ant View
</li>
<li> <a class="footnoteref" href="#ref-AppFuseEclipse-4">[4]</a> Run Ant
</li>
<li> <a class="footnoteref" href="#ref-AppFuseEclipse-5">[5]</a> Run JUnit Tests in Eclipse
</li>
<li> <a class="footnoteref" href="#ref-AppFuseEclipse-6">[6]</a> Tips for Debugging and UI Editing
</li>
</ul>
<h3 id='section-AppFuseEclipse-CreateNewJavaProjectInEclipse1'>Create New Java Project in Eclipse <a class="footnote" name="ref-AppFuseEclipse-1">[#1]</a></h3>
Open Eclipse (either with an existing or a new workspace) and to go File &#8594; New &#8594; Project. Then select "Java Project" and hit the Next button. In the Project Name field, enter the name of your project (i.e. appfuse) and the directory that your project lives (i.e. c:\source\appfuse) in the box below.  If you're prompted to switch the Java Perspective, choose Yes.
<p>If you try to build the project at this point, you'll likely get numerous errors.  Most of them involve the fact that the <tt>UserForm</tt> class can not be found.  This is because all of the ActionForms in AppFuse (if you're using the Struts version) are generated from POJOs with XDoclet.
</p>
<p>All of the tasks for XDoclet are configured in the Ant build.xml file so the easiest thing to do is to run "ant gen-forms" to generate the ActionForms.  If you have Ant 1.6.2+ installed and in your path, you can do this from the command line.  The next step shows you how configure Eclipse to run your AppFuse build.xml.
</p>
<span class="note"><b>TIP:</b> Here's a way to <a href="http://raibledesigns.com/page/rd?anchor=eclipse_tips">hide the JARs</a> you see in Eclipse's Package Explorer.</span>
<h3 id='section-AppFuseEclipse-ConfiguringAntInEclipse2'>Configuring Ant in Eclipse <a class="footnote" name="ref-AppFuseEclipse-2">[#2]</a></h3>
<p>The easiest way to configure Eclipse for AppFuse is to install Ant on your hard drive (i.e. c:\Tools\apache-ant-1.6.2) and then point Eclipse's ANT_HOME to this directory.  To do this, go to Window &#8594; Preferences &#8594; Ant &#8594; Runtime.  Then click the "Ant Home" button and select the installation folder on your hard drive.
</p>
<p>If you'd rather use Eclipse's built-in Ant, you'll need to add junit.jar to its classpath.  To do this, go to Window &#8594; Preferences &#8594; Ant &#8594; Runtime.  Then click the "Add JARs" button and select junit.jar from appfuse/lib/junit3.8.1/lib/junit.jar.  Click OK until you arrive back at the workbench view. 
</p>
<p>Next, add the <b>catalina-ant.jar</b> (from $CATALINA_HOME/server/lib) to the ant classpath. Then in the property tab, add <b>tomcatTasks.properties</b> (in lib/ant-contrib) file as a global properties file.
</p>
<p>Lastly, still in Ant - Runtime - Properties tab, add the global property "tomcat.home" with a value of your CATALINA_HOME environment variable.
</p>
<p>Below is a screenshot of what your Ant Runtime classpath should look like after the above modifications:
</p>
<p><img class="inline" src="attach/AppFuseEclipse/ant-runtime.png" alt="ant-runtime.png" />
</p>
<h3 id='section-AppFuseEclipse-AddBuild.xmlToAntView3'>Add build.xml to Ant View <a class="footnote" name="ref-AppFuseEclipse-3">[#3]</a> </h3>
Now we need to add the build.xml to Eclipse's Ant View. To do this, go to Window &#8594; Show View &#8594; Ant. Then click on the first icon in this view (screenshot below) to add AppFuse's build file. 
<p><img class="inline" src="attach/AppFuseEclipse/ant-view.png" alt="ant-view.png" /> 
</p>
<h3 id='section-AppFuseEclipse-RunAnt4'>Run Ant <a class="footnote" name="ref-AppFuseEclipse-4">[#4]</a> </h3>
After adding the build.xml, you should be able to expand it in the Ant View and execute any of the targets. I usually do "test-all" to verify all the tests pass in my initial project.  For a list of targets I use most often, see <a class="wikipage" href="Wiki.jsp?page=AppFuseAntTasks">AppFuse Ant Targets</a>.
<p>Now if you run the "compile" target and then refresh the project (right-click on project &#8594; Refresh) you shouldn't see any errors in the "Problems" pane.  You should now be able to compile and create classes as you normally would.  Sometimes when my imports aren't resolving correctly in Eclipse, I do have to run Project &#8594; Clean in Eclipse.
</p>
<span class="note"><b>NOTE:</b> If you're using the internal version of Ant, you may get an error message like the one below:
<pre>
BUILD FAILED: C:\source\appfuse\build.xml:802: The following error occurred while executing this line:
C:\source\appfuse\build.xml:780: The following error occurred while executing this line:
java.lang.NoClassDefFoundError: org/apache/xml/serialize/OutputFormat
</pre>
</span>
<p>This is because there are tasks that require Xerces to be in your Ant classpath [<a href="http://wiki.apache.org/jakarta-cactus/FrequentlyAskedQuestions">reference</a>].  I added xercesImpl.jar and xml-apis.jar (from my self-installed version of Ant) to Eclipse's Ant classpath to solve this.
</p>
<p>At this point, you should see something similar to the screenshot below. 
</p>
<p><img class="inline" src="attach/AppFuseEclipse/ant-targets.png" alt="ant-targets.png" /> 
</p>
<h3 id='section-AppFuseEclipse-RunJUnitTestsInEclipse5'>Run JUnit Tests in Eclipse <a class="footnote" name="ref-AppFuseEclipse-5">[#5]</a> </h3>
It's also possible to run your JUnit tests in Eclipse. But before running them, you need to run the "war" target.  After this target completes, refresh your project.
<p>After you have successfully done so, in Eclipse open a test you'd like to run (i.e. UserDaoTest) and go to Run &rarr; Debug As &rarr; JUnit Test. Note that you may have to run the "db-load" target before you run your tests every so often.  I did have the following method in the Base*TestCase class for each layer, but this caused DBUnit to reload the database before every test in a Test class.  Removing it reduces the execution time of "test-all" by more than 30 seconds.
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>protected&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">setUp</font><font color="#000000">()&nbsp;</font><font color="#7f0055"><b>throws&nbsp;</b></font><font color="#000000">Exception&nbsp;</font><font color="#000000">{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">DataSource&nbsp;ds&nbsp;=&nbsp;</font><font color="#000000">(</font><font color="#000000">DataSource</font><font color="#000000">)&nbsp;</font><font color="#000000">ctx.getBean</font><font color="#000000">(</font><font color="#2a00ff">&#34;dataSource&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">IDatabaseConnection&nbsp;conn&nbsp;=&nbsp;</font><font color="#7f0055"><b>new&nbsp;</b></font><font color="#000000">DatabaseConnection</font><font color="#000000">(</font><font color="#000000">ds.getConnection</font><font color="#000000">())</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">IDataSet&nbsp;dataSet&nbsp;=&nbsp;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>new&nbsp;</b></font><font color="#000000">XmlDataSet</font><font color="#000000">(</font><font color="#7f0055"><b>new&nbsp;</b></font><font color="#000000">FileInputStream</font><font color="#000000">(</font><font color="#2a00ff">&#34;metadata/sql/sample-data.xml&#34;</font><font color="#000000">))</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f7f5f">//&nbsp;clear&nbsp;table&nbsp;and&nbsp;insert&nbsp;only&nbsp;sample&nbsp;data</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">DatabaseOperation.CLEAN_INSERT.execute</font><font color="#000000">(</font><font color="#000000">conn,&nbsp;dataSet</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">conn.close</font><font color="#000000">()</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>If the instructions above don't work for running JUnit tests in Eclipse, I suggest just using the command line - i.e. <b>ant test-dao -Dtestcase=UserDAO</b>.  Running tests from the command line <i>always</i> works. ;-)
</p>
<h3 id='section-AppFuseEclipse-TipsForDebuggingAndUIEditing6'>Tips for Debugging and UI Editing <a class="footnote" name="ref-AppFuseEclipse-6">[#6]</a></h3>
For debugging, I use the <a class="external" href="http://www.sysdeo.com/eclipse/tomcatplugin">Tomcat Plugin</a><img class="outlink" src="images/out.png" alt="" /> in Eclipse and set breakpoints.  To make the breakpoints work you will need to indicate your source-path using the Eclipse menu <tt>Window->Preferences</tt>, select <tt>Tomcat</tt>, then <tt>Source Path</tt>.
<p>For little changes, I use "ant deploy-web" which only takes a couple of seconds. For truly minor tweaks, it's sometimes easier to edit the file in Tomcat's webapps folder. For major design changes, I usually run the app, view source on a page and save it to a "sandbox" folder in the same directory as my project. Then I do a find/replace and change all "/appfuse/" references to "../web/". This allows me to change CSS and JS files and just refresh the file in the sandbox.
</p>
<p></p>
<p></p>
<A NAME="Link_AppFuseOnPostgreSQL">
<h1>AppFuseOnPostgreSQL</h1>
</A>
This page describes my the steps required and issues associated with running <a class="wikipage" href="Wiki.jsp?page=AppFuse">AppFuse</a> on <a class="external" href="http://postgresql.org">PostgreSQL</a><img class="outlink" src="images/out.png" alt="" />.  If you're developing on Windows or OS X, click <a class="external" href="http://raibledesigns.com/page/rd?anchor=postgresql_8_with_appfuse">here</a><img class="outlink" src="images/out.png" alt="" /> for install packages.
<dl>
<dt></dt><dd><i>This howto assumes you've already installed PostgreSQL and your DBA username/password combination is postgres/postgres.</i></dd>
</dl>
<h4 id='section-AppFuseOnPostgreSQL-TableOfContents'>Table of Contents</h4>
<ul>
<li> <a class="footnoteref" href="#ref-AppFuseOnPostgreSQL-1">[1]</a> Setup JDBC Driver
</li>
<li> <a class="footnoteref" href="#ref-AppFuseOnPostgreSQL-2">[2]</a> Basic Configuration Tweaks
</li>
<li> <a class="footnoteref" href="#ref-AppFuseOnPostgreSQL-3">[3]</a> Run JUnit Tests
</li>
<li> <a class="footnoteref" href="#ref-AppFuseOnPostgreSQL-4">[4]</a> Configure Tomcat to talk to PostgreSQL
</li>
<li> <a class="footnoteref" href="#ref-AppFuseOnPostgreSQL-5">[5]</a> Other issues
</li>
<li> <a class="footnoteref" href="#ref-AppFuseOnPostgreSQL-6">[6]</a> Sample CREATE DATABASE script
</li>
</ul>
<h3 id='section-AppFuseOnPostgreSQL-SetupJDBCDriver1'>Setup JDBC Driver <a class="footnote" name="ref-AppFuseOnPostgreSQL-1">[#1]</a></h3>
The PostgreSQL JDBC version 3 driver is included in AppFuse, so we just need to tell AppFuse to use it, and what the database connection parameters are.
<p>Edit your build.properties file to reflect your new database of choice.  MySQL settings are the defaults specified in properties.xml.  Here is a sample for PostgreSQL:
</p>
<p><b>PostgreSQL:</b>
</p>
<pre>
database.jar=${postgresql.jar}
database.type=postgresql
database.name=appfuse
database.host=localhost

hibernate.dialect=org.hibernate.dialect.PostgreSQLDialect
database.driver_class=org.postgresql.Driver
database.url=jdbc:${database.type}://${database.host}/${database.name}
database.username=test
database.password=test
</pre>

You can use the database.properties.reference file for other database's settings.
<span class="note"><b>NOTE:</b> AppFuse cannot create your database for you in PostgreSQL like it can with MySQL.  So those configuration settings are not needed.  Therefore, the "db-create" target does not create a database when running PostgreSQL.  See the PostgreSQL Sample Script<a class="footnoteref" href="#ref-AppFuseOnPostgreSQL-6">[6]</a> for creating a new database in the <i>Command Line Processor</i>.</span>
<h3 id='section-AppFuseOnPostgreSQL-CodeConfigurationTweaks2'>Code/Configuration Tweaks <a class="footnote" name="ref-AppFuseOnPostgreSQL-2">[#2]</a></h3>
<p>Using Hibernate's <i>generator-class="native"</i> for id's in PostgreSQL fails.  This is likely due to the fact that data is being inserted using DBUnit and the sequences get out of wack.  Changing all id's to "increment" (example below) and seems to fix the problem.  This worked on all the databases tested (MySQL, PostgreSQL and DB2).
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">/**</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*&nbsp;Returns&nbsp;the&nbsp;id.</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*&nbsp;</font><font color="#7f9fbf">@return&nbsp;</font><font color="#3f5fbf">String</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*&nbsp;@hibernate.id&nbsp;column=&#34;id&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*&nbsp;&nbsp;generator-class=&#34;increment&#34;&nbsp;unsaved-value=&#34;null&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*/</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#000000">Long&nbsp;getId</font><font color="#000000">()&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>return&nbsp;</b></font><font color="#000000">id;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<h3 id='section-AppFuseOnPostgreSQL-RunJUnitTests3'>Run JUnit Tests <a class="footnote" name="ref-AppFuseOnPostgreSQL-3">[#3]</a></h3>
<p>No changes are needed to make AppFuse properly run the supplied dao tests.
</p>
<h3 id='section-AppFuseOnPostgreSQL-ConfigureTomcatToTalkToPostgreSQL4'>Configure Tomcat to talk to PostgreSQL <a class="footnote" name="ref-AppFuseOnPostgreSQL-4">[#4]</a></h3>
<p>Since AppFuse 1.3 the database-specific attributes in <i>tomcat-context.xml</i> and <i>hibernate.cfg.xml</i> are replaced at build-time.  This means that nothing special is needed to get Tomcat to talk to PostgreSQL.  For users with older versions of AppFuse see the note on the <a class="wikipage" href="Wiki.jsp?page=AppFuseOnDB2">DB2 version of this page</a> for more information.
</p>
<h3 id='section-AppFuseOnPostgreSQL-OtherIssues5'>Other issues <a class="footnote" name="ref-AppFuseOnPostgreSQL-5">[#5]</a></h3>
<p><b>Turn off Hibernate Batch Processing for PostgreSQL</b><br />
When an exception is thrown while performing batch processing in Hibernate on PostgreSQL the cause of the exception is never displayed in the stack trace.  By turning off the batch processing exceptions get reported immediately and completely.  This can be done by adding an entry into <tt>applicationContext-hibernate.xml</tt>.  Within the element <tt>sessionFactory</tt>, locate the property <tt>hibernateProperties</tt> and make it look like this:
</p>
<pre>
        &lt;property name="hibernateProperties"&gt;
        &lt;props&gt;
            &lt;prop key="hibernate.dialect"&gt;@HIBERNATE-DIALECT@&lt;/prop&gt;

            &lt;!-- turn off batch updated for PostgreSQL to get nicer exception messages --&gt;
	    &lt;prop key="hibernate.jdbc.batch_size"&gt;0&lt;/prop&gt;
        &lt;/props&gt;
        &lt;/property&gt;
</pre>

<p>This will have an effect on the performance of the database, so consider the tradeoff of having better error messages.
</p>
<h3 id='section-AppFuseOnPostgreSQL-SampleCREATEDATABASEScript6'>Sample CREATE DATABASE script <a class="footnote" name="ref-AppFuseOnPostgreSQL-6">[#6]</a></h3>
This is a sample PostgreSQL script to create a user and a database for an AppFuse application.
<pre>
-- create the test user
create user test password 'test';

-- create the database
create database appfuse owner test;
</pre>

<p>You can find it on the sub-directory metadata/sql, with the name postgresql-create.sql. One example, suppose your project's name is <tt>felini</tt>:
</p>
<pre>
	$gilberto@dev/filine: psql -d template1 -U postgres
Password:
Welcome to psql 8.1.2, the PostgreSQL interactive terminal.

Type:  \copyright for distribution terms
       \h for help with SQL commands
       \? for help with psql commands
       \g or terminate with semicolon to execute query
       \q to quit

template1=# \imetadata/sql/postgresql-create.sql
DROP DATABASE
CREATE USER
CREATE DATABASE
template1=#
</pre>

<A NAME="Link_AppFuseQuickStart">
<h1>AppFuseQuickStart</h1>
</A>
<a class="wikipage" href="Wiki.jsp?page=AppFuse">AppFuse</a>'s main purpose is to help you quickly accelerate the start of your webapp.  Here are the basic steps to creating a new project with it.
<ol>
<li> Install J2SE 1.4.2+ and set a JAVA_HOME environment variable pointing to your installation directory.
</li>
<li> <a class="external" href="https://appfuse.dev.java.net/servlets/ProjectDocumentList">Download</a><img class="outlink" src="images/out.png" alt="" /> the source version or checkout the 1.9.x branch from Subversion (svn co https://appfuse.dev.java.net/svn/appfuse/branches/BRANCH_1-9-x appfuse). <!--div class="note" style="margin: 10px"> <b>NOTE:</b> You can download AppFuse 1.8, Ant 1.6.5, Tomcat 5.0.28 and MySQL 4.1.11 (for Windows) using <a class="external" href="https://appfuse.dev.java.net/files/documents/1397/13863/appfuse-installer-1.8.zip">the all-in-one installer</a><img class="outlink" src="images/out.png" alt="" />. View this package's <a class="external" href="https://appfuse.dev.java.net/source/browse/*checkout*/appfuse/extras/myjavapack/README-dist.txt">README.txt</a><img class="outlink" src="images/out.png" alt="" />  for more information.</div-->
</li>
<li> Install Ant 1.6.5+ and set an ANT_HOME environment variable. Install Tomcat 4.1.x+ (recommend 5.0.28) and set a CATALINA_HOME environment variable to point to your Tomcat installation.  Checkout my <a class="wikipage" href="Wiki.jsp?page=DevelopmentEnvironment">development environment setup</a> to get links for these packages and to see where I usually install them. 
</li>
<li> Install MySQL 3.23.x+ (recommend 5.0+). <div class="note" style="margin: 10px"> <b>NOTE:</b> If you're using MySQL 4.1.7, make sure to use a UTF-8 character set and an InnoDB table type. <a class="external" href="#Link_AppFuseSupport#ref-AppFuseSupport-5">Here's how</a><img class="outlink" src="images/out.png" alt="" />.</div>
</li>
<li> <a class="wikipage" href="Wiki.jsp?page=AppFuseSMTP">Setup a local SMTP server</a> or change mail.properties (in the web/WEB-INF/classes directory) and build.properties (in the root -- for log4j messages) to point to an existing one - they default to <i>localhost</i>.
</li>
<li> Copy lib/junit3.8.1/junit.jar to $ANT_HOME/lib.<div class="note" style="margin: 10px"><b>NOTE:</b> You may see an ant-junit.jar file already in $ANT_HOME/lib.  This jar is not the JUnit library, rather it is for the Ant junit task which will use the junit.jar that you place here.</div>
</li>
<li> If you're planning on using iBATIS (instead of Hibernate) or a web framework other than Struts, install that now using the instructions below.
</li>
<li> Run <b>ant new</b> from the appfuse directory. You will be prompted for an application name, database name and package name.  After entering these, a directory containing your new application will be created in the same directory as appfuse. <div class="note" style="margin: 10px; background-color: #fcc"> <b>WARNING:</b> Some application values will not work - don't use "test", anything with "appfuse" in it or anything that starts with numbers.  Also, two dashes (-) in a name will mess things up.</div>
</li>
<li> Navigate to your new project's directory and run <b>ant setup</b> (or <b>ant setup-db setup-tomcat deploy</b>) to create the database, configure Tomcat and deploy your application. The database setup will only work if your root user has no password.  You can change this in build.properties if necessary. Need <a class="wikipage" href="Wiki.jsp?page=AssistanceWithAntSetup">assistance with mysql setup</a>?
</li>
<li> If you want to test and make sure everything works, run <b>ant test-all</b> - make sure Tomcat is stopped when you do this.  Next, run <b>ant test-reports</b> - there will be a message after it runs telling you how you can view the generated reports.
</li>
</ol>
<p>After you've confirmed your installation using the above steps - take a look at the <a class="wikipage" href="Wiki.jsp?page=Articles">Tutorials</a> to see how to develop with AppFuse.
</p>
<p><b>Optional Installations</b>
</p>
<p><div class="note" style="margin-left: 40px"> <b>NOTE:</b> If you're developing with AppFuse on Unix, run "ant fixcrlf" before running the installers. You can also download a pre-built version that already has the web framework option you're looking for.</div>
</p>
<ul>
<li> If you'd like to use <a class="external" href="http://ibatis.com">iBATIS</a><img class="outlink" src="images/out.png" alt="" /> as a persistence framework option, view the README.txt in <tt>extras/ibatis</tt>. 
</li>
<li> If you'd like to use <a class="external" href="http://www.springframework.org/docs/reference/mvc.html">Spring</a><img class="outlink" src="images/out.png" alt="" /> as the web framework, view the README.txt in <tt>extras/spring</tt>.
</li>
<li> If you'd like to use <a class="external" href="http://www.opensymphony.com/webwork">WebWork</a><img class="outlink" src="images/out.png" alt="" /> as the web framework, view the README.txt in <tt>extras/webwork</tt>.
</li>
<li> If you'd like to use <a class="external" href="http://myfaces.apache.org/">JSF</a><img class="outlink" src="images/out.png" alt="" /> as the web framework, view the README.txt in <tt>extras/jsf</tt>.
</li>
<li> If you'd like to use <a class="external" href="http://jakarta.apache.org/tapestry">Tapestry</a><img class="outlink" src="images/out.png" alt="" /> as the web framework, view the README.txt in <tt>extras/tapestry</tt>.
</li>
</ul>
<ul>
<li> If you'd like you can write a script to automate the creation and testing of your project from AppFuse. There are a couple in CVS that I use for testing: <a class="external" href="https://appfuse.dev.java.net/source/browse/*checkout*/appfuse/Attic/test-spring.sh?content-type=text/plain">spring+ibatis</a><img class="outlink" src="images/out.png" alt="" /> and <a class="external" href="https://appfuse.dev.java.net/nonav/source/browse/*checkout*/appfuse/Attic/test-webwork.sh?content-type=text/plain">webwork</a><img class="outlink" src="images/out.png" alt="" />.  Note that using "appfuse" in a real-world project name is a bad idea as it'll find/replace things it shouldn't.
</li>
<li> If you don't want to install iBATIS, Spring MVC, WebWork, JSF or Tapestry - you should delete their installers in the <tt>extras</tt> folder before checking your project into source control.
</li>
</ul>
<p><div class="note" style="margin-left: 40px"> <b>NOTE:</b> These installers will modify the Eclipse classpath, but not the IDEA one.  You'll need to modify that manually.</div>
</p>
<A NAME="Link_AppFuseSupport">
<h1>AppFuseSupport</h1>
</A>
This is a list of questions that relate to AppFuse.  You might also checkout the <a class="wikipage" href="Wiki.jsp?page=Articles">AppFuse Tutorials</a> and <a class="wikipage" href="Wiki.jsp?page=StrutsResumeSupport">StrutsResume Support</a> pages.  The <a class="external" href="http://news.gmane.org/group/gmane.comp.java.appfuse.user">Mailing List Archives</a><img class="outlink" src="images/out.png" alt="" /> or the <a class="wikipage" href="Wiki.jsp?page=AppFuseIRC">AppFuse IRC channel</a> might also be helpful.
<h4 id='section-AppFuseSupport-TableOfContents'>Table of Contents</h4>
<ul>
<li><a class="footnoteref" href="#ref-AppFuseSupport-1">[1]</a> Common Questions
</li>
<li><a class="footnoteref" href="#ref-AppFuseSupport-2">[2]</a> Development with AppFuse
</li>
<li><a class="footnoteref" href="#ref-AppFuseSupport-3">[3]</a> Security Questions
</li>
<li><a class="footnoteref" href="#ref-AppFuseSupport-4">[4]</a> Struts Specific HowTos
</li>
<li><a class="footnoteref" href="#ref-AppFuseSupport-5">[5]</a> JSF Specific HowTos
</li>
<li><a class="footnoteref" href="#ref-AppFuseSupport-6">[6]</a> Database Questions and HowTos
</li>
<li><a class="footnoteref" href="#ref-AppFuseSupport-7">[7]</a> Application Server Questions and HowTos
</li>
<li><a class="footnoteref" href="#ref-AppFuseSupport-8">[8]</a> Using Anthill and CruiseControl
</li>
<li><a class="footnoteref" href="#ref-AppFuseSupport-9">[9]</a> Hibernate Specific Questions
</li>
<li><a class="footnoteref" href="#ref-AppFuseSupport-10">[10]</a> Archived Questions
</li>
</ul>
<h3 id='section-AppFuseSupport-CommonQuestions1'>Common Questions <a class="footnote" name="ref-AppFuseSupport-1">[#1]</a></h3>
<ul>
<li> Where is UserForm.java?  
</li>
</ul>
<dl>
<dt></dt><dd><i>The UserForm.java file is generated by XDoclet using Ant. If you run "ant compile" it gets generated into build/web/gen/org/appfuse/webapp/form.</i></dd>
</dl>
<ul>
<li> What is <a class="wikipage" href="Wiki.jsp?page=AppFuse">AppFuse</a>? 
</li>
</ul>
<dl>
<dt></dt><dd><i><a class="external" href="http://today.java.net/pub/a/today/2004/07/15/thefuse.html">This article</a><img class="outlink" src="images/out.png" alt="" /> explains it best.</i></dd>
</dl>
<ul>
<li> Is this the right place to ask AppFuse questions?  
</li>
</ul>
<dl>
<dt></dt><dd><i>Sure, but you'll probably get more visibility and input from the <a class="external" href="https://appfuse.dev.java.net/servlets/ForumMessageList?forumID=566">help forum</a><img class="outlink" src="images/out.png" alt="" /> or <a class="external" href="https://appfuse.dev.java.net/servlets/SummarizeList?listName=users">mailing list</a><img class="outlink" src="images/out.png" alt="" />.  Also, this wiki has recently been locked down b/c of spammers so you'll need to get a username/password from me to post anything.  Don't forget that the <a class="external" href="http://news.gmane.org/group/gmane.comp.java.appfuse.user">mailing list archives</a><img class="outlink" src="images/out.png" alt="" /> are a great resources.</i></dd>
</dl>
<ul>
<li> Why am I getting this error "Cannot create JDBC driver of class ' ' for connect URL 'null'"? 
</li>
</ul>
<dl>
<dt></dt><dd><i>Chances are you forgot to run "<tt>ant setup-tomcat</tt>" (or "<tt>ant setup</tt>" if you need to set up the database as well).  Also, if you're using Tomcat make sure you are using the latest <a class="wikipage" href="Wiki.jsp?page=DevelopmentEnvironment">recommended release</a>. </i></dd>
</dl>
<ul>
<li> Why do I get this error "build.xml:1037: taskdef class org.apache.catalina.ant.ReloadTask cannot be found"?
</li>
</ul>
<dl>
<dt></dt><dd><i>Ant cannot find the ReloadTask which is in $CATALINA_HOME\server\lib\catalina-ant.jar.  You need to ensure env var CATALINA_HOME (Windows dir %CATALINA_HOME% or Unix ls $CATALINA_HOME) points to the tomcat install base directory.  This error can also occur when you wrap the path in double quotes, (ie. if you have set CATALINA_HOME="c:\Tomcat 5.5" then remove the double quotes!). </i></dd>
</dl>
<ul>
<li> How does build.properties and properties.xml fit together?
</li>
</ul>
<dl>
<dt></dt><dd><i>Ant has immutable properties.  The first time a property is set, it cannot be changed.  Here's the order of how properties are set in AppFuse.</i></dd>
</dl>
<div style="margin-left: 40px">
<pre>
command-line using -Dproperty=value
~/.appname-build.properties
~/.build.properties
build.properties
properties.xml (or build.xml) - wherever it's used''
</pre>

</div>
<ul>
<li> When working on a team, how to run test of a specific POJO using db-load task only in that specific table as well?  
</li>
</ul>
<dl>
<dt></dt><dd><i>First, instead of using all the sample-data.xml file, create another file say sample-person.xml and there put the data that you want insert. After that you can do this:</dd>
</dl>
ant test-dao -Dtestcase=PersonDao -Dfile=metadata/sql/sample-person.xml</i>
<h3 id='section-AppFuseSupport-DevelopmentWithAppFuse2'>Development with AppFuse <a class="footnote" name="ref-AppFuseSupport-2">[#2]</a></h3>
<ul>
<li> <a class="wikipage" href="Wiki.jsp?page=DevelopmentEnvironment">HowTo setup your Development Environment</a>.  This is what I typically use when building a new machine.  It includes environment variables, downloads, where to install applications, etc.
</li>
<li> What are the major ant tasks? What do they do?  
</li>
</ul>
<dl>
<dt></dt><dd><i>See <a class="wikipage" href="Wiki.jsp?page=AppFuseAntTasks">AppFuseAntTasks</a>.</i></dd>
</dl>
<ul>
<li> <a class="wikipage" href="Wiki.jsp?page=AppFuseEclipse">Developing your AppFuse application in Eclipse</a>.
</li>
<li> <a class="wikipage" href="Wiki.jsp?page=AppFuseEnvironmentIssues">Known Environment issues</a> to be aware of.
</li>
</ul>
<h3 id='section-AppFuseSupport-SecurityQuestions3'>Security Questions <a class="footnote" name="ref-AppFuseSupport-3">[#3]</a></h3>
<ul>
<li> HowTo use NTLM authentication with appfuse? Using the jCIFS, one can use the jcifs.http.NtlmHttpFilter to use the <a class="external" href="http://jcifs.samba.org/src/docs/ntlmhttpauth.html">NTLM authentication in Tomcat</a><img class="outlink" src="images/out.png" alt="" />. Matt can you give some pointers if this can be integrated with <a class="wikipage" href="Wiki.jsp?page=AppFuse">AppFuse</a>?
</li>
</ul>
<dl>
<dt></dt><dd><i><a class="external" href="http://raibledesigns.com/comments/rd?anchor=easy_windows_authentication_with_tomcat">Here</a><img class="outlink" src="images/out.png" alt="" /> is how I used Andy Armstrong's <a class="external" href="http://free.tagish.net/jaas/doc.html">JAAS Login Modules</a><img class="outlink" src="images/out.png" alt="" /> to get Tomcat to talk to an NT Domain.  It's been over a year since I tried it - but it worked quite well at the time.  I have no experience with jCIFS - but if you get it working - please let me know.  I'd be happy to help you write a howto on this wiki for it. ~ <a class="wikipage" href="Wiki.jsp?page=MattRaible">Matt</a></i></dd>
</dl>
<h3 id='section-AppFuseSupport-StrutsSpecific4'>Struts Specific <a class="footnote" name="ref-AppFuseSupport-4">[#4]</a></h3>
<ul>
<li> <a class="external" href="http://raibledesigns.com/page/rd?anchor=changing_struts_lt_bean_message">How to convert &amp;lt;bean:message&amp;gt; tags to JSTL's &amp;lt;fmt:message&amp;gt; tags</a><img class="outlink" src="images/out.png" alt="" />
</li>
<li> How to <a class="wikipage" href="Wiki.jsp?page=AppFuseVelocity">use Velocity templates instead of JSPs</a>.
</li>
<li> How to <a class="wikipage" href="Wiki.jsp?page=AppFuseStrutsDates">deal with Dates using Struts</a>.
</li>
<li> Do you have any Struts validator <a class="external" href="http://phd.netcomp.monash.edu.au/RobertMarkBram/blog/detailPage.asp?id=46">examples?</a><img class="outlink" src="images/out.png" alt="" />
</li>
</ul>
<ul>
<li> Why is the JSTL keyword 'empty' not working all the time?
</li>
</ul>
<dl>
<dt></dt><dd><i>The empty keyword (pre JSP 2.0), only worked on java.util.List, java.util.Map, on Strings and arrays.  Collections like java.util.Set were not supported.  If you are using pre JSP 2.0 and want to test whether a Set is empty or not use: <span style="font-family:monospace; whitespace:pre;">

&lt;c:if test="${mycollection['empty']}"&gt;.

</span></dd>
</dl>
The most reliable workaround to this problem I have found, is to use this notation:
<pre>
  &lt;c:forEach items="${mycollection}" var="element" varStatus="rowNum"&gt;

    &lt;c:if test="${rowNum.count==1}"&gt;
      &lt;table&gt;
        &lt;tr&gt; &lt;th&gt; Value Header &lt;/th&gt; &lt;/tr&gt;
    &lt;/c:if&gt;

      &lt;tr&gt;
        &lt;th&gt;
          &lt;c:out value="${element.value}"/&gt;
        &lt;/th&gt;
      &lt;/tr&gt;
      &lt;c:if test="${rowNum.last}"&gt;
      &lt;/table&gt;
    &lt;/c:if&gt;
  &lt;/c:forEach&gt;
</pre>

This <a class="external" href="http://weblogs.java.net/blog/mister__m/archive/2003/11/crazy_jstl_when.html">article</a><img class="outlink" src="images/out.png" alt="" /> explains this in more detail.  If you are using tomcat 5, this supports JSP 2.0 so you will not experience
this problem.</i>
<h3 id='section-AppFuseSupport-JSFSpecific5'>JSF Specific <a class="footnote" name="ref-AppFuseSupport-5">[#5]</a></h3>
<ul>
<li> I get an "Couldn't find template: /home/mats/myapp/metadata/templates/struts_form.xdt" when I run "ant setup test-all" after specifying "jsf" as web framework when running "ant new".
</li>
</ul>
<dl>
<dt></dt><dd><i>This is caused by the failure of JSF to install.  Start with a version that has <a class="external" href="https://appfuse.dev.java.net/files/documents/1397/37690/appfuse-jsf-1.9.3-src.zip">JSF pre-installed</a><img class="outlink" src="images/out.png" alt="" />.</i></dd>
</dl>
<h3 id='section-AppFuseSupport-DatabaseSpecific6'>Database Specific <a class="footnote" name="ref-AppFuseSupport-6">[#6]</a></h3>
<ul>
<li> I get an "access denied" error when trying to create the MySQL Database.
</li>
</ul>
<dl>
<dt></dt><dd><i>The issue is likely because you're on Unix or you've changed the root password.  See <a class="wikipage" href="Wiki.jsp?page=AssistanceWithAntSetup">this page</a> for assistance.</i></dd>
</dl>
<ul>
<li> I get an "Illegal mix of collations" when I try to run tests against a MySQL database.  
</li>
</ul>
<dl>
<dt></dt><dd><i>MySQL 4.1.7+ requires you to add set the default character set to UTF-8 to get unicode support with AppFuse.  To do this, add the following to  your c:\Windows\my.ini or /etc/my.cnf file:</i></dd>
</dl>
<div style="margin-left: 40px">
<pre>
[mysqld]
default-character-set=utf8
</pre>

</div>
<ul>
<li> I'm have methods that throw exceptions in a Transaction and nothing is being rolled back.  What gives?
</li>
</ul>
<dl>
<dt></dt><dd><i>MySQL's default tables (MyISAM) do not support transactions by default.  Add or replace the following line in your c:\Windows\my.ini or /etc/my.cnf file.  You could also use <a class="wikipage" href="Wiki.jsp?page=AppFuseOnPostgreSQL">PostgreSQL</a>.</i></dd>
</dl>
<div style="margin-left: 40px">
<pre>
[mysqld]
default-storage-engine=innodb
</pre>

<span class="note"><b>NOTE:</b> You may see default-storage-engine's synonym "default-table-type" in the 
configuration file.  If so, set the value of that parameter to "innodb" instead.</span>
</div>
<dl>
<dt></dt><dd><i>BTW, <a class="external" href="http://www.mysql.com/products/administrator/">MySQL Administrator</a><img class="outlink" src="images/out.png" alt="" /> is a nice tool for administering/monitoring MySQL.</i></dd>
</dl>
<ul>
<li> I'm having trouble with MySQL on Suse 9.2.
</li>
</ul>
<dl>
<dt></dt><dd><i>Upgrading to the <a class="external" href="http://jroller.com/page/mmatthews/20041202#connector_j_3_1_5">MySQL 3.1.5 JDBC Driver</a><img class="outlink" src="images/out.png" alt="" /> (or above) should fix this.</i></dd>
</dl>
<ul>
<li> Can AppFuse talk to multiple <a class="wikipage" href="Wiki.jsp?page=MultipleDatabases">databases?</a>
</li>
</ul>
<ul>
<li> Can I audit any changes to the <a class="wikipage" href="Wiki.jsp?page=DatabaseAudit">Database?</a>
</li>
</ul>
<ul>
<li> I get an "Could not synchronize database state with session" exception when I try to run test-dao.
</li>
</ul>
<dl>
<dt></dt><dd><i>If a class with a natural key does not declare a version or timestamp property, it's more dificult to get saveOrUpdate() and cascades to work correctly. You might use a custom Hibernate Interceptor as discussed in this chapter. (On the other hand, if you're happy to use explicit save() and explicit update() instead of saveOrUpdate() and cascades, Hibernate doesn't need to be able to distinguish between transient and detached instances; so you can safely ignore this advice.) Composite natural keys extend the same ideas. {Hibernate in Action: pag.:333}</i></dd>
</dl>
<ul>
<li> What <a class="wikipage" href="Wiki.jsp?page=DBTools">DB admin/clients</a> can I use to administer my database?
</li>
<li> How do I <a class="wikipage" href="Wiki.jsp?page=AppFuseWithSQLServer">use AppFuse with SQL Server</a>.
</li>
<li> How do I <a class="wikipage" href="Wiki.jsp?page=AppFuseWithMckoi">use AppFuse and Mckoi database</a>.
</li>
<li> How to <a class="wikipage" href="Wiki.jsp?page=AppFuseOnDB2">run AppFuse on DB2</a>.
</li>
<li> How to <a class="wikipage" href="Wiki.jsp?page=RunningOnOracle">run AppFuse on Oracle</a>.
</li>
<li> How to <a class="wikipage" href="Wiki.jsp?page=AppFuseWithHSQLDB">configure AppFuse for HSQLDB</a>.
</li>
<li> How to <a class="wikipage" href="Wiki.jsp?page=AppFuseOnPostgreSQL">run AppFuse on PostgreSQL</a>.
</li>
</ul>
<ul>
<li> How do I use a JNDI DataSource instead of a Spring-managed one (1.9+):
</li>
</ul>
<dl>
<dt></dt><dd>In metadata/conf/tomcat-context*.xml, uncomment the JNDI DataSource settings.  Then in web/WEB-INF/applicationContext-resources.xml, uncomment the JNDI "dataSource" bean - and delete the active "dataSource" bean. If you decide to make this a permanent change in your project, you can delete <tt>commons-dbcp.jar</tt> and <tt>commons-pool.jar</tt> from <i>lib/jakarta-commons</i>.</dd>
</dl>
<h3 id='section-AppFuseSupport-ApplicationServerSpecific7'>Application Server Specific <a class="footnote" name="ref-AppFuseSupport-7">[#7]</a></h3>
<ul>
<li> To support multiple developers with the same instance of Tomcat, simply change "${webapp.name}" to "${user.name}" in the various deployment methods.
</li>
<li> How to <a class="wikipage" href="Wiki.jsp?page=AppFuseOnResin">run AppFuse on Resin</a>.
</li>
<li> How to <a class="wikipage" href="Wiki.jsp?page=AppFuseOnOrion">run AppFuse on Orion</a>.
</li>
<li> How to <a class="wikipage" href="Wiki.jsp?page=AppFuseOnJBoss">run AppFuse on JBoss</a>.
</li>
<li> How to use AppFuse with Oracle?  
</li>
<li> How to setup/suppress <a class="wikipage" href="Wiki.jsp?page=Tomcat5Logging">Tomcat 5.x Logging</a>
</li>
</ul>
<dl>
<dt></dt><dd><i>See <a class="wikipage" href="Wiki.jsp?page=AppFuseOnOrion">AppFuseOnOrion</a> - Orion is the embedded server in Oracle AS.</i></dd>
</dl>
<h3 id='section-AppFuseSupport-ContinuousIntegration8'>Continuous Integration <a class="footnote" name="ref-AppFuseSupport-8">[#8]</a></h3>
<ul>
<li> <a class="wikipage" href="Wiki.jsp?page=AppFuseAnthill">Using Anthill to automate AppFuse testing</a>.
</li>
<li> <a class="wikipage" href="Wiki.jsp?page=AppFuseCruiseControl">Using CruiseControl to automate AppFuse testing</a>.
</li>
</ul>
<h3 id='section-AppFuseSupport-HibernateSpecificQuestions9'>Hibernate Specific Questions <a class="footnote" name="ref-AppFuseSupport-9">[#9]</a></h3>
<ul>
<li> The <a class="external" href="http://hibernate.org/5.html">Hibernate Documentation</a><img class="outlink" src="images/out.png" alt="" /> is a good source of information.
</li>
<li> Learn more about <a class="external" href="http://www.xylax.net/hibernate/">Hibernate's Relationships</a><img class="outlink" src="images/out.png" alt="" /> (read the intro first).
</li>
<li> A couple of good Hibernate-XDoclet tutorials: <a class="external" href="http://www.downside.ch/hibernate/">http://www.downside.ch/hibernate/</a><img class="outlink" src="images/out.png" alt="" /> and <a class="external" href="http://www.meagle.com:8080/hibernate.jsp">http://www.meagle.com:8080/hibernate.jsp</a><img class="outlink" src="images/out.png" alt="" />.
</li>
<li> <a class="external" href="http://www.hibernate.org/78.html">Many articles</a><img class="outlink" src="images/out.png" alt="" /> listed on hibernate.org.
</li>
<li> How do I get hold of the <a class="wikipage" href="Wiki.jsp?page=GettingHibernateSession">Hibernate Session</a>?
</li>
<li> How do I <a class="wikipage" href="Wiki.jsp?page=HibernateJMX">Setup Hibernate JMX?</a>
</li>
<li> Does Hibernate support <a class="wikipage" href="Wiki.jsp?page=HibernatePagination">Pagination?</a>
</li>
<li> How do I fix a LazyInitializationException in my unit tests?
</li>
</ul>
<dl>
<dt></dt><dd><i>See <a class="external" href="http://www.jroller.com/page/kbaum/20040708">Karl Baum's writeup on Lazy Initialization</a><img class="outlink" src="images/out.png" alt="" />.  In particular, the <b>Being Lazy in your Unit Tests</b> section.</i></dd>
</dl>
<ul>
<li> <b>Do I have to use XDoclet to generate my *.hbm.xml files?  Is it possible to override a single hbm.xml file and create it by hand?</b>
</li>
</ul>
<p><div style="margin-left: 30px">
If you have an @hibernate.class tag on a POJO - hibernatedoclet will generate the mapping file into build/dao/gen. If you have a mapping file (*.hbm.xml) file for your POJO in the src/dao/**/model/*
directory, it will <b>overwrite</b> the generated version. If you don't want to worry about the two conflicting - just remove the @ sign from @hibernate.class in your POJO and put your hbm.xml file in the <tt>model</tt>
directory.
</p>
<p>No build.xml modification are need for this to work. The "package-dao" target will include these mapping files:
</p>
<pre>       &lt;copy todir="${build.dir}/dao/gen"&gt;
           &lt;fileset dir="src/dao" includes="**/*.xml" excludes="**/*-${dao.type}.xml"/&gt;
           &lt;filterset refid="variables.to.replace"/&gt;
       &lt;/copy&gt;</pre>

<p>If you want to get rid of the hibernatedoclet process, you can do that- but make sure and run it first - and then copy all of the generated hbm.xml files into your <tt>model</tt> directory.
</div>
</p>
<h3 id='section-AppFuseSupport-ArchivedQuestionsnoLongerRelevant10'>Archived Questions (no longer relevant) <a class="footnote" name="ref-AppFuseSupport-10">[#10]</a></h3>
<ul>
<li> How to <a class="wikipage" href="Wiki.jsp?page=AppFuseSpringUpgrade">upgrade an AppFuse 1.x app to use Spring</a>.
</li>
<li> If you want to setup build.xml graphics, like the <a class="external" href="http://static.raibledesigns.com/downloads/appfuse-architecture.ppt">PowerPoint Preso</a><img class="outlink" src="images/out.png" alt="" /> has, read <a class="wikipage" href="Wiki.jsp?page=SetupVizant">setting up vizant</a>.
</li>
</ul>
<A NAME="Link_AppGen">
<h1>AppGen</h1>
</A>
<a class="wikipage" href="Wiki.jsp?page=AppFuse">AppFuse</a> versions 1.6.1+ include an AppGen Tool that can be used to generate all the classes needed to persist a POJO.  This tool was based on contributions from <a class="external" href="https://appfuse.dev.java.net/issues/show_bug.cgi?id=60">Lance Lavandowska</a><img class="outlink" src="images/out.png" alt="" /> and <a class="external" href="https://appfuse.dev.java.net/issues/show_bug.cgi?id=78">Ben Gill</a><img class="outlink" src="images/out.png" alt="" />.  At first, I didn't want to add a code-generation feature like this b/c you'd end up with a 1-to-1 relationship between tables/pojos, DAOs and Managers.  On most of my projects, I have far fewer DAOs and Managers than POJOs.
<p>By default, AppGen will generate only Actions/Controllers, Action/Controller Tests, test data, i18n keys and JSPs.  It will also configure Actions/Controllers for you.  It uses the generic BaseManager and BaseDaoHibernate classes (configured as "manager" and "dao") to reduce the number of files that are generated.  However, I realize that sometimes you will want to generate all the DAO and Manager classes (as well as their tests), so I've added that option too.
</p>
<p>To see what AppGen does and how it works, <a href="http://demo.appfuse.org/appgen.html">see the AppGen Screencast</a>.
</p>
<p>To use the AppGen tool (after installing your web framework), perform the following steps:
</p>
<ol>
<li> If you're using Hibernate, <a href="http://raibledesigns.com/wiki/Wiki.jsp?page=CreateDAO#ref-CreateDAO-5">configure the mapping file</a> for your POJO in <tt>applicationContext-hibernate.xml</tt>. If you're using iBATIS, you can skip this step. 
</li>
<li> cd into the <i><tt>extras/appgen</tt></i> directory and run <b>ant</b>. You will be prompted to generate from a POJO or a Table.  If you choose <b>pojo</b>, the .java file should already exist in your <tt>model</tt> package. If you choose <b>table</b>, Middlegen will be used to create a POJO from an existing database table. This generates all the files you create in the tutorials on this site (for your chosen web framework).
</li>
<li> Finally, you will be asked to enter an application module or sub-package name. This is an optional feature that will allow you to organize your classes into sub-packages. For example, for a POJO "model" package of "org.appfuse.foo.model", just enter <b>foo</b> when prompted.
</li>
<li> To install the generated files, run <b>ant install</b>.  You can run <b>ant install -Dappgen.type=pojo -Dobject.name=person</b> if you want to do everything in one fell swoop. <b>WARNING:</b> You might want to backup your project before you do this - or at least make sure it's checked into a source code repository.  I've tested this code, and I think it works well - but it <i>is</i> modifying your source tree for you.
</li>
</ol>
<p>After generating the view layer, it's up to you to modify the <tt>*Form.jsp</tt> (<tt>*Form.html</tt> for Tapestry) and make it look pretty.  This is covered in Step 5 of each respective web framework's "Create Action/Controller" tutorial: <a href="http://raibledesigns.com/wiki/Wiki.jsp?page=CreateActions#ref-CreateAction-5">Struts</a>, <a href="http://raibledesigns.com/wiki/Wiki.jsp?page=SpringControllers#ref-SpringControllers-5">Spring</a>, <a href="http://raibledesigns.com/wiki/Wiki.jsp?page=WebWorkActions#ref-WebWorkActions-5">WebWork</a>, <a href="http://raibledesigns.com/wiki/Wiki.jsp?page=JSFBeans#ref-JSFBeans-5">JSF</a> and <a href="http://raibledesigns.com/wiki/Wiki.jsp?page=TapestryPages#ref-TapestryPages-5">Tapestry</a>.
</p>
<span class="note"><b>NOTE:</b> If you'd like to generate all the DAOs/Managers/Tests, run <b>ant install-detailed</b> instead of <b>ant install</b>.  Before you install anything, the files will be created in the <tt>extras/appgen/build/gen</tt> directory (in case you want to look at them before installing).  If you just want to test the tool, you can cd to this directory and run <b>ant test</b> to see generate all of the code from <a class="wikipage" href="Wiki.jsp?page=Articles">the tutorials</a> created.</span>
<p>I encourage you to read <a class="wikipage" href="Wiki.jsp?page=Articles">the tutorials</a> before using AppGen.  That way you'll understand what's being generated for you and you'll only need to mailing list for <a class="external" href="http://www.catb.org/~esr/faqs/smart-questions.html">asking smart questions</a><img class="outlink" src="images/out.png" alt="" />. ;-)  Hopefully this tool will remove the pain of writing simple CRUD code and let you concentrate on developing your business logic and fancy UIs!
</p>
<h3 id='section-AppGen-RelatedTools'>Related Tools</h3>
<p><a class="external" href="http://appfusegenerator.dev.java.net">AppFuse Generator</a><img class="outlink" src="images/out.png" alt="" />
</p>
<A NAME="Link_Articles">
<h1>Articles</h1>
</A>
<div style="float: right; margin-left: 10px; margin-bottom: 10px">
<script type="text/javascript"><!--
google_ad_client = "pub-7968247362757416";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "990000";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "CC0000";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</div>
Here are some articles I've written, refined or just linking to that folks seem to find useful. The latest and greatest one is <a class="external" href="http://www-128.ibm.com/developerworks/java/library/j-appfuse">Seven simple reasons to use AppFuse</a><img class="outlink" src="images/out.png" alt="" />.
<h3 id='section-Articles-AppFuseTutorials'>AppFuse Tutorials </h3>
If you've just downloaded AppFuse and want to setup it up on your machine, your best bet is the <a class="wikipage" href="Wiki.jsp?page=AppFuseQuickStart">QuickStart Guide</a>.  Once you've got everything setup, the tutorials below are a great resource for learning how to develop with <a class="wikipage" href="Wiki.jsp?page=AppFuse">AppFuse</a>.  
<p></p>
<span class="note"><b>NOTE:</b> These tutorials are included in AppFuse's distribution.  If you want to update your project's copy (in the <i>docs</i> directory), run "ant wiki".</span>
<p>As of 1.6.1, you can generate most of the code covered in these tutorials.  If you're using Struts+Hibernate, you can generate <i><b>all</b></i> of it.  For Spring and WebWork, it was too much trouble to write the installers so you will need to manually configure the Controllers and Actions.  This was mainly due to the fact that I'm not using XDoclet for these web frameworks and the limitations of using Ant as an installer.  The <b>AppGen</b> tool which generates the code is covered in <a class="wikipage" href="Wiki.jsp?page=CreateDAO">Part I</a>.
</p>
<p>There's also an <a class="external" href="http://raibledesigns.com/page/rd?anchor=the_appfuse_generator">AppFuse Generator</a><img class="outlink" src="images/out.png" alt="" /> project that has similar functionality to AppGen.
</p>
<p><b>Part I:</b> <a class="wikipage" href="Wiki.jsp?page=CreateDAO">Creating new DAOs and Objects in AppFuse</a> - A HowTo for creating Java Objects (that represent tables) and creating Java classes to persist those objects in the database.
</p>
<dl>
<dt></dt><dd><i>Translations: <a class="wikipage" href="Wiki.jsp?page=CreateDAO_zh">Chinese</a>, <a class="wikipage" href="Wiki.jsp?page=CreateDAO_de">German</a>, <a class="wikipage" href="Wiki.jsp?page=CreateDAO_it">Italian</a>, <a class="wikipage" href="Wiki.jsp?page=CreateDAO_ko">Korean</a>, <a class="wikipage" href="Wiki.jsp?page=CreateDAO_pt">Portuguese</a>, <a class="wikipage" href="Wiki.jsp?page=CreateDAO_es">Spanish</a></i></dd>
</dl>
<p><b>Part II:</b> <a class="wikipage" href="Wiki.jsp?page=CreateManager">Creating new Managers</a> - A HowTo for creating Business Facades that talk between the database tier (DAOs) and the web tier (Actions or Controllers).
</p>
<dl>
<dt></dt><dd><i>Translations: <a class="wikipage" href="Wiki.jsp?page=CreateManager_zh">Chinese</a>, <a class="wikipage" href="Wiki.jsp?page=CreateManager_pt">Portuguese</a>, <a class="wikipage" href="Wiki.jsp?page=CreateManager_es">Spanish</a>, <a class="wikipage" href="Wiki.jsp?page=CreateManager_ko">Korean</a></i></dd>
</dl>
<p><b>Part III:</b> <b>(Struts)</b> <a class="wikipage" href="Wiki.jsp?page=CreateActions">Creating Struts Actions and JSPs</a> - A HowTo for creating Actions and JSPs in your AppFuse project. Includes generating JSPs and customizing them to look good.  Also, you will write a WebTest to test the JSPs functionality. Other web framework options are as follows:
</p>
<dl>
<dt></dt><dd><i>Translations: <a class="wikipage" href="Wiki.jsp?page=CreateActions_zh">Chinese</a>, <a class="wikipage" href="Wiki.jsp?page=CreateActions_pt">Portuguese</a>, <a class="wikipage" href="Wiki.jsp?page=CreateActions_ko">Korean</a></i></dd>
</dl>
<ul>
<li> <b><span style="color: green">Spring:</span></b> <a class="wikipage" href="Wiki.jsp?page=SpringControllers">Creating Spring Controllers and JSPs</a>
</li>
</ul>
<dl>
<dt></dt><dd><i>Translations: <a class="wikipage" href="Wiki.jsp?page=SpringControllers_pt">Portuguese</a>, <a class="wikipage" href="Wiki.jsp?page=SpringControllers_ko">Korean</a></i></dd>
</dl>
<ul>
<li> <b><span style="color: blue">WebWork:</span></b> <a class="wikipage" href="Wiki.jsp?page=WebWorkActions">Creating WebWork Actions and JSPs</a>
</li>
<li> <b><span style="color: purple">JSF:</span></b> <a class="wikipage" href="Wiki.jsp?page=JSFBeans">Creating JSF Beans and JSPs</a>
</li>
<li> <b><span style="color: orange">Tapestry:</span></b> <a class="wikipage" href="Wiki.jsp?page=TapestryPages">Creating Tapestry Pages and Templates</a>
</li>
</ul>
<p><b>Part IV:</b> <b>(Struts)</b> <a class="wikipage" href="Wiki.jsp?page=ValidationAndList">Adding Validation and List Screen</a> - Adding validation logic to the personForm so that firstName and lastName are required fields and adding a list screen to display all person records in the database.
</p>
<dl>
<dt></dt><dd><i>Translations: <a class="wikipage" href="Wiki.jsp?page=ValidationAndList_zh">Chinese</a>, <a class="wikipage" href="Wiki.jsp?page=ValidationAndList_pt">Portuguese</a>, <a class="wikipage" href="Wiki.jsp?page=ValidationAndList_ko">Korean</a></i></dd>
</dl>
<ul>
<li> <b><span style="color: green">Spring:</span></b> <a class="wikipage" href="Wiki.jsp?page=ValidationAndListSpring">Adding Validation and List Screen</a>
</li>
</ul>
<dl>
<dt></dt><dd><i>Translations: <a class="wikipage" href="Wiki.jsp?page=ValidationAndListSpring_pt">Portuguese</a>, <a class="wikipage" href="Wiki.jsp?page=ValidationAndListSpring_ko">Korean</a></i></dd>
</dl>
<ul>
<li> <b><span style="color: blue">WebWork:</span></b> <a class="wikipage" href="Wiki.jsp?page=ValidationAndListWebWork">Adding Validation and List Screen</a>
</li>
<li> <b><span style="color: purple">JSF:</span></b> <a class="wikipage" href="Wiki.jsp?page=ValidationAndListJSF">Adding Validation and List Screen</a>
</li>
<li> <b><span style="color: orange">Tapestry:</span></b> <a class="wikipage" href="Wiki.jsp?page=ValidationAndListTapestry">Adding Validation and List Screen</a>
</li>
</ul>
<span class="note"><b>NOTE:</b> You can generate the files created in these tutorials by using <a class="wikipage" href="Wiki.jsp?page=AppGen">AppGen</a>. If you experience problems - you should be able to compare your results to what AppGen does.  To do this, cd into extras/appgen, and run "ant test-detailed". This will create an "appfuse-appgen" project, generate the code in these tutorials, and test everything.</span>
<p><a name="thogau"></a>
<h3 id='section-Articles-ThomasGaudinsExcellentAppFuseTutorials'>Thomas Gaudin's Excellent AppFuse Tutorials</h3>
</p>
<p>Thomas Gaudin has put together a couple of detailed and easy-to-follow tutorials on his site.
</p>
<ul>
<li> <a class="external" href="http://www.thogau.net/tutorials/date/">Handling Dates with AppFuse and Struts</a><img class="outlink" src="images/out.png" alt="" />
</li>
<li> <a class="external" href="http://www.thogau.net/tutorials/tree/">Building a persisted dynamic web tree</a><img class="outlink" src="images/out.png" alt="" />
</li>
<li> <a class="external" href="http://www.thogau.net/howto/flexi-float/">Flexi-Float Sitemesh decorator for AppFuse</a><img class="outlink" src="images/out.png" alt="" />
</li>
<li> <a class="external" href="http://www.thogau.net/howto/lucene/">Lucene Integration with Spring and Hibernate</a><img class="outlink" src="images/out.png" alt="" />
</li>
<li> <a class="external" href="http://www.thogau.net/tutorials/pojo.html">Handling complex objects with XDoclet, Hibernate and Struts</a><img class="outlink" src="images/out.png" alt="" />
</li>
</ul>
<h4 id='section-Articles-RelatedAppFuseHowTos'>Related AppFuse HowTos</h4>
<ul>
<li> How I setup my <a class="wikipage" href="Wiki.jsp?page=DevelopmentEnvironment">Development Environment</a>.
</li>
</ul>
<dl>
<dt></dt><dd><i>Translations: <a class="wikipage" href="Wiki.jsp?page=DevelopmentEnvironment_pt">Portuguese</a>, <a class="wikipage" href="Wiki.jsp?page=DevelopmentEnvironment_ko">Korean</a></i></dd>
</dl>
<ul>
<li> <a class="wikipage" href="Wiki.jsp?page=AppFuseEclipse">Developing your AppFuse application in Eclipse</a>.
</li>
</ul>
<dl>
<dt></dt><dd><i>Translations: <a class="wikipage" href="Wiki.jsp?page=AppFuseEclipse_pt">Portuguese</a></i></dd>
</dl>
<ul>
<li> <a class="external" href="http://blogs.sun.com/roller/page/vkraemer?entry=integrating_appfuse_and_netbeans_5">Integrating AppFuse and NetBeans 5.0</a><img class="outlink" src="images/out.png" alt="" />
</li>
<li> Using AppFuse with <a class="external" href="http://www.myeclipseide.com/">MyEclipse</a><img class="outlink" src="images/out.png" alt="" />: <a class="external" href="http://www.jroller.com/page/RickHigh/20040119#integrating_appfuse_with_eclipse_2">Part I</a><img class="outlink" src="images/out.png" alt="" /> and <a class="external" href="http://www.jroller.com/page/RickHigh/20040120#getting_myeclipse_to_work_with">Part II</a><img class="outlink" src="images/out.png" alt="" />.
<ul>
<li> <i>AppFuse also supports <a class="external" href="http://www.intellij.com/idea/index.html">IDEA 4.0</a><img class="outlink" src="images/out.png" alt="" /> out-of-the-box, or at least the project files are included.</i>
</li>
</ul>
</li>
<li> How to <a class="wikipage" href="Wiki.jsp?page=AppFuseDebug">run your AppFuse web application and testcases in a debugger</a>.
</li>
<li> <a class="wikipage" href="Wiki.jsp?page=AppFuseAnthill">Using Anthill</a> or <a class="wikipage" href="Wiki.jsp?page=AppFuseCruiseControl">CruiseControl</a> to automate AppFuse testing.
</li>
</ul>
<ul>
<li> How do I <a class="wikipage" href="Wiki.jsp?page=HibernateRelationships">create object relationships with Hibernate</a>.
</li>
</ul>
<ul>
<li> How to <a class="wikipage" href="Wiki.jsp?page=AppFuseOnResin">run AppFuse on Resin</a>.
</li>
<li> How to <a class="wikipage" href="Wiki.jsp?page=AppFuseOnWinstone">run AppFuse on Winstone</a>.
</li>
<li> How to run AppFuse on Oracle Application Server <a class="wikipage" href="Wiki.jsp?page=AppFuseOnOracleAS">version 9.0.4</a> and <a class="wikipage" href="Wiki.jsp?page=AppFuseOnOracleAS10g">10g Release 2</a>.
</li>
<li> How to <a class="wikipage" href="Wiki.jsp?page=RunningOnOracle">run AppFuse on Oracle</a>.
</li>
<li> How to <a class="wikipage" href="Wiki.jsp?page=AppFuseOnDB2">run AppFuse on DB2</a>.
</li>
<li> How to <a class="wikipage" href="Wiki.jsp?page=AppFuseOnPostgreSQL">run AppFuse on PostgreSQL</a>.
</li>
<li> How to <a class="wikipage" href="Wiki.jsp?page=AppFuseWithSQLServer">run AppFuse on MS SQL</a>.
</li>
<li> How to <a class="external" href="#Link_AppFuseWSAD">run AppFuse on IBM WSAD and Websphere 5.1 local test environment</a><img class="outlink" src="images/out.png" alt="" />.
</li>
</ul>
<ul>
<li> How to integrate <a class="external" href="http://www.nabble.com/search---integrate-compass-%28lucene%29-and-appfuse-p5022176s2369.html">Compass with Spring MVC</a><img class="outlink" src="images/out.png" alt="" /> and <a class="external" href="http://raibledesigns.com/page/rd?entry=integrating_compass_with_appfuse_and">Struts and the Display Tag</a><img class="outlink" src="images/out.png" alt="" />.
</li>
<li> How to integrate <a class="external" href="http://www.lucianofiandesio.com/javatales/qtzfuse.html">Quartz with AppFuse</a><img class="outlink" src="images/out.png" alt="" /> by Luciano Fiandesio.
</li>
<li> How to integrate <a class="wikipage" href="Wiki.jsp?page=IntegratingJBPMIntoAppFuse">jBPM into AppFuse</a> by Ameer Ahmed.
</li>
</ul>
<ul>
<li> How to <a class="wikipage" href="Wiki.jsp?page=AppFuseVelocity">use Velocity Templates instead of JSPs</a>.
</li>
<li> <a class="wikipage" href="Wiki.jsp?page=XDocletEclipse">XDoclet Template for Hibernate in Eclipse</a>.
</li>
</ul>
<ul>
<li> How to <a class="wikipage" href="Wiki.jsp?page=AppFuseAddLibrary">add a library dependancy into AppFuse</a>.
</li>
<li> How to <a class="wikipage" href="Wiki.jsp?page=AppFuseAddServlet">add a servlet into AppFuse</a>.
</li>
<li> How to <a class="wikipage" href="Wiki.jsp?page=POJOToPDF">autogenerate PDF documents from DAO layer</a>.
</li>
<li> How to <a class="wikipage" href="Wiki.jsp?page=TestData">automatically generate random data</a>.
</li>
<li> How to <a class="wikipage" href="Wiki.jsp?page=CodeCoverage">integrate code coverage tool with AppFuse</a>
</li>
</ul>
<ul>
<li> How to <a class="wikipage" href="Wiki.jsp?page=AppFuseAxis">provide Axis Webservices with AppFuse</a>.
</li>
<li> How to <a class="wikipage" href="Wiki.jsp?page=AppFuseXFire">provide XFire Webservices with AppFuse</a>.
</li>
<li> How to <a class="external" href="http://lifeasastruct.blogspot.com/2005/10/ajax-on-appfuse.html">integrate DWR into AppFuse</a><img class="outlink" src="images/out.png" alt="" />.
</li>
</ul>
<ul>
<li> How to <a class="wikipage" href="Wiki.jsp?page=AppFuseCobertura">integrate the code coverage tool Cobertura</a>
</li>
<li> How to <a class="wikipage" href="Wiki.jsp?page=AppFuseEasyMock">integrate EasyMock for mock testing</a>
</li>
<li> How to <a class="wikipage" href="Wiki.jsp?page=AppFuseXFireOpenLaszlo">use AppFuse + XFire with OpenLaszlo</a>
</li>
<li> How to <a class="wikipage" href="Wiki.jsp?page=AppFuseAcegiACL">integrate ACEGIs ACLs in AppFuse</a>
</li>
</ul>
<ul>
<li> How to <a class="wikipage" href="Wiki.jsp?page=AppFuseAjaxWithDWR">make use of AJAX using DWR in AppFuse</a>
</li>
<li> How to <a class="external" href="http://www.lucianofiandesio.com/javatales/ajxfuse.html">integrate AppFuse and AjaxTags autocomplete</a><img class="outlink" src="images/out.png" alt="" />
</li>
</ul>
<ul>
<li> How to <a class="wikipage" href="Wiki.jsp?page=AppFuseXSnapshot">use xsnapshot for DTO instead of BeanUtils</a>
</li>
<li> How to <a class="external" href="http://lifeasastruct.blogspot.com/2006/03/drools-on-appfuse.html">use Drools with AppFuse</a><img class="outlink" src="images/out.png" alt="" />
</li>
<li> How to <a class="wikipage" href="Wiki.jsp?page=CreateAnAJAXBasedFileuploadProgressbarDialog">Create an AJAX based fileupload progressbar dialog</a>
</li>
</ul>
<h3 id='section-Articles-ServerConfiguration'>Server Configuration</h3>
<ul>
<li> <a class="wikipage" href="Wiki.jsp?page=ApacheSSL">Apache 2.x and SSL</a>
</li>
<li> <a class="external" href="http://raibledesigns.com/tomcat/index.html">Apache 2.x and Tomcat 4.x</a><img class="outlink" src="images/out.png" alt="" />
<ul>
<li> <a class="external" href="http://www.raibledesigns.com/page/rd/20030107#tomcat_4_1_18_apache">Apache/Tomcat/SSL in Real-Time</a><img class="outlink" src="images/out.png" alt="" />
</li>
</ul>
</li>
<li> <a class="external" href="http://www.galatea.com/flashguides/apache-tomcat-4-win32.xml">Apache 1.3.x and Tomcat 4.x</a><img class="outlink" src="images/out.png" alt="" />
</li>
<li> <a class="external" href="http://www.raibledesigns.com/tomcat/boot-howto.html">Starting Apache and Tomcat</a><img class="outlink" src="images/out.png" alt="" />
</li>
</ul>
<hr />
<ul>
<li> <a class="external" href="http://www.raibledesigns.com/jabber">Jabber Server Setup (1.4.2)</a><img class="outlink" src="images/out.png" alt="" />
</li>
<li> <a class="wikipage" href="Wiki.jsp?page=SecureDirectoriesIIS">Securing Directories in IIS</a>
</li>
<li> Tips for <a class="wikipage" href="Wiki.jsp?page=AppFuseOnTomcat">configuring Tomcat</a>
</li>
</ul>
<h3 id='section-Articles-Other'>Other</h3>
<ul>
<li> <a class="wikipage" href="Wiki.jsp?page=DeveloperTips">AppFuse Developer Tips</a>
</li>
<li> <a class="wikipage" href="Wiki.jsp?page=RichClient">AppFuse Rich Client Integration</a>
</li>
<li> <a class="wikipage" href="Wiki.jsp?page=VisualBeans">AppFuse Visualised Beans </a>
</li>
</ul>
<p>Outdated Articles that still get some traffic:
</p>
<ul>
<li> <a class="external" href="http://www.icsynergy.com/downloads/struts/strutsHowTo.html">Struts Example for iPlanet</a><img class="outlink" src="images/out.png" alt="" />
</li>
<li> <a class="external" href="http://www.raibledesigns.com/page/rd/20021023#wiki_evaluation">Wiki Evaluation (Java-based)</a><img class="outlink" src="images/out.png" alt="" />
</li>
</ul>
<A NAME="Link_CreateActions">
<h1>CreateActions</h1>
</A>
<b>Part III:</b> <a class="wikipage" href="Wiki.jsp?page=CreateActions">Creating Actions and JSPs</a> - A HowTo for creating <a class="external" href="http://jakarta.apache.org/struts">Struts</a><img class="outlink" src="images/out.png" alt="" /> Actions and JSPs in the <a class="wikipage" href="Wiki.jsp?page=AppFuse">AppFuse</a> architecture.
<dl>
<dt></dt><dd><i>This tutorial depends on <b>Part II:</b> <a class="wikipage" href="Wiki.jsp?page=CreateManager">Creating new Managers</a>.</i></dd>
</dl>
<h3 id='section-CreateActions-AboutThisTutorial'>About this Tutorial</h3>
This tutorial will show you how to create a Struts Action, a JUnit Test (using <a class="external" href="http://strutstestcase.sourceforge.net/">StrutsTestCase</a><img class="outlink" src="images/out.png" alt="" />), and a JSP for the form.  The Action we create will talk to the PersonManager we created in the <a class="wikipage" href="Wiki.jsp?page=CreateManager">Creating Managers</a> tutorial.  
<p>By default, AppFuse ships with <a class="external" href="http://struts.apache.org">Struts</a><img class="outlink" src="images/out.png" alt="" /> as its web framework.  As of 1.6+, you can use <a class="external" href="http://www.springframework.org">Spring</a><img class="outlink" src="images/out.png" alt="" /> or <a class="external" href="http://opensymphony.org/webwork">WebWork</a><img class="outlink" src="images/out.png" alt="" /> as your web framework.  In 1.7, support was added for using <a class="external" href="http://myfaces.apache.org">JSF</a><img class="outlink" src="images/out.png" alt="" /> or <a class="external" href="http://jakarta.apache.org/tapestry">Tapestry</a><img class="outlink" src="images/out.png" alt="" />.
</p>
<p>To install any of these web frameworks instead of Struts, simply navigate to the <i>extras</i> directory and into the directory of the framework you want to install.  The README.txt file in this directory has further instructions. The tutorials for these other frameworks are listed below.
</p>
<ul>
<li> <b><span style="color: green">Spring:</span></b> <a class="wikipage" href="Wiki.jsp?page=SpringControllers">Creating Spring Controllers and JSPs</a>
</li>
<li> <b><span style="color: blue">WebWork:</span></b> <a class="wikipage" href="Wiki.jsp?page=WebWorkActions">Creating WebWork Actions and JSPs</a>
</li>
<li> <b><span style="color: purple">JSF:</span></b> <a class="wikipage" href="Wiki.jsp?page=JSFBeans">Creating JSF Beans and JSPs</a>
</li>
<li> <b><span style="color: orange">Tapestry:</span></b> <a class="wikipage" href="Wiki.jsp?page=TapestryPages">Creating Tapestry Pages and Templates</a>
</li>
</ul>
<p>Let's get started by creating a new Struts Action and JSP your AppFuse project.
</p>
<dl>
<dt></dt><dd><span style="color: blue"><i>I will tell you how I do stuff in the <b>Real World</b> in text like this.</i></span></dd>
</dl>
<h4 id='section-CreateActions-TableOfContents'>Table of Contents</h4>
<ul>
<li> <a class="footnoteref" href="#ref-CreateActions-1">[1]</a> Add XDoclet Tags to Person to generate PersonForm
</li>
<li> <a class="footnoteref" href="#ref-CreateActions-2">[2]</a> Create skeleton JSPs using XDoclet
</li>
<li> <a class="footnoteref" href="#ref-CreateActions-3">[3]</a> Create PersonActionTest to test PersonAction
</li>
<li> <a class="footnoteref" href="#ref-CreateActions-4">[4]</a> Create PersonAction 
</li>
<li> <a class="footnoteref" href="#ref-CreateActions-5">[5]</a> Run PersonActionTest
</li>
<li> <a class="footnoteref" href="#ref-CreateActions-6">[6]</a> Clean up the JSP to make it presentable 
</li>
<li> <a class="footnoteref" href="#ref-CreateActions-7">[7]</a> Create Canoo WebTests to test browser-like actions
</li>
</ul>
<h3 id='section-CreateActions-AddXDocletTagsToPersonToGeneratePersonForm1'>Add XDoclet Tags to Person to generate PersonForm <a class="footnote" name="ref-CreateActions-1">[#1]</a></h3>
Now let's generate our PersonForm object for Struts and our web tier. To do this, we need to add XDoclet tags to the Person.java Object to create our Struts ActionForm.  In the JavaDoc for the Person.java file, add the following @struts.form tag (use User.java if you need an example):
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#000000">*&nbsp;@struts.form&nbsp;include-all=</font><font color="#2a00ff">&#34;true&#34;&nbsp;</font><font color="#7f0055"><b>extends</b></font><font color="#000000">=</font><font color="#2a00ff">&#34;BaseForm&#34;</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<dl>
<dt></dt><dd><i>We extend org.appfuse.webapp.form.BaseForm because it has a toString() method that allows us to call log.debug(formName) to print out a reader-friendly view of the Form object.</i></dd>
</dl>
<dl>
<dt></dt><dd><i>If you haven't renamed the "org.appfuse" packages to "com.company" or otherwise don't have your model class in the default package, you may need to fully-qualify the reference to org.appfuse.webapp.form.BaseForm in the @struts.form tag.</i></dd>
</dl>
<p>Now if you run <b>ant gen-forms</b>, Ant (and XDoclet) will generate a PersonForm.java for you in build/web/gen/**/form.
</p>
<h3 id='section-CreateActions-CreateSkeletonJSPsUsingXDoclet2'>Create skeleton JSPs using XDoclet <a class="footnote" name="ref-CreateActions-2">[#2]</a></h3>
In this step, you'll generate a JSP page to display information from the Person object.  It will contain Struts' JSP tags that render table rows for each property in Person.java.  The <a class="wikipage" href="Wiki.jsp?page=AppGen">AppGen</a> tool that's used to do this is based off a StrutsGen tool - which was originally written by <a class="external" href="http://www.blogscene.org/erik/">Erik Hatcher</a><img class="outlink" src="images/out.png" alt="" />.  It's basically just a couple of classes and a bunch of XDoclet templates.  All these files are located in extras/appgen.
<p>Here are the simple steps to generating the JSP and a properties file containing the labels for the form elements:
</p>
<ul>
<li> From the command-line, navigate to "extras/appgen"
</li>
<li> Execute <b>ant -Dobject.name=Person -Dappgen.type=pojo</b> to generate a bunch of files in extras/appgen/build/gen.  In fact, it'll generate all the files you need to complete this tutorial.  However, let's just grab the ones you need.
<ul>
<li> web/WEB-INF/classes/Person.properties (labels for your form elements) 
</li>
<li> web/pages/personForm.jsp (JSP file for viewing a single Person)
</li>
<li> web/pages/personList.jsp (JSP file for viewing a list of People)
</li>
</ul>
</li>
<li> Copy the contents of Person.properties into web/WEB-INF/classes/ApplicationResources.properties.  These are all the keys you will need for titles/headings and form properties.  Here is an example of what you should add to ApplicationResources.properties:
</li>
</ul>
<div style="margin-left: 40px">
<pre>
# -- person form --
personForm.id=Id
personForm.firstName=First Name
personForm.lastName=Last Name

person.added=Person has been added successfully.
person.updated=Person has been updated successfully.
person.deleted=Person has been deleted successfully.

# -- person list page --
personList.title=Person List
personList.heading=Persons

# -- person detail page --
personDetail.title=Person Detail
personDetail.heading=Person Information
</pre>

</div>
<ul>
<li> Copy personForm.jsp to web/pages/personForm.jsp.  Copy personList.jsp to web/pages/personList.jsp.
</li>
</ul>
<dl>
<dt></dt><dd> <i>The files in the "pages" directory will end up in "WEB-INF/pages" at deployment time. The container provides security for all files below WEB-INF.  This applies to client requests, but not to forwards from Struts' ActionServlet. Placing all JSPs below WEB-INF ensures they are only accessed through Actions, and not directly by the client or each other. This allows security to be moved up into the Action, where it can be handled more efficiently, and out of the base presentation layer.</i></dd>
</dl>
<p>The web application security for AppFuse specifies that all *.html url-patterns should be protected (except for /signup.html and /passwordHint.html).  This guarantees that clients must go through an Action to get to a JSP (or at least the ones in <i>pages</i>).  
</p>
<span class="note"><b>NOTE:</b> If you want to customize the CSS for a particular page, you can add &lt;body id="pageName"/> to the top of the file.  This will be slurped up by SiteMesh and put into the final page.  You can then customize your CSS on a page-by-page basis using something like the following: 
<pre>body#pageName element.class { background-color: blue } </pre>
</span>
<ul>
<li> Add keys in ApplicationResources.properties the titles and headings in the JSPs
</li>
</ul>
In the generated JSPs, there are two keys for the title (top of the browser window) and the header (heading in the page).  These fields are provided above with key names of personDetail.title and personDetail.heading.
<p><i>Just above, we added "personForm.*" keys to this file, so why do I use personDetail instead of personForm for the titles and headings?  The best reason is because it gives a nice separation between form labels and text on the page.  Another reason is because all the *Form.* give you a nice representation of all the fields in your database.  
</p>
<p>I recently had a client who wanted all fields in the database searchable.  This was fairly easy to do.  I just looked up all the keys in ApplicationResources.properties which contained "Form." and then put them into a drop-down.  On the UI, the user was able to enter a search term and select the column they wanted to search.  I was glad I followed this Form vs. Detail distinction on that project!</i>
</p>
<p></p>
<h3 id='section-CreateActions-CreatePersonActionTestToTestPersonAction3'>Create PersonActionTest to test PersonAction <a class="footnote" name="ref-CreateActions-3">[#3]</a></h3>
To create a StrutsTestCase Test for PersonAction, start by creating a PersonActionTest.java file in the test/web/**/action directory:
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#7f0055"><b>package&nbsp;</b></font><font color="#000000">org.appfuse.webapp.action;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">org.appfuse.Constants;</font><br/>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">org.appfuse.webapp.form.PersonForm;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#7f0055"><b>public&nbsp;class&nbsp;</b></font><font color="#000000">PersonActionTest&nbsp;</font><font color="#7f0055"><b>extends&nbsp;</b></font><font color="#000000">BaseStrutsTestCase&nbsp;</font><font color="#000000">{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#000000">PersonActionTest</font><font color="#000000">(</font><font color="#000000">String&nbsp;name</font><font color="#000000">)&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>super</b></font><font color="#000000">(</font><font color="#000000">name</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">testEdit</font><font color="#000000">()&nbsp;</font><font color="#7f0055"><b>throws&nbsp;</b></font><font color="#000000">Exception&nbsp;</font><font color="#000000">{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">setRequestPathInfo</font><font color="#000000">(</font><font color="#2a00ff">&#34;/editPerson&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">addRequestParameter</font><font color="#000000">(</font><font color="#2a00ff">&#34;method&#34;</font><font color="#000000">,&nbsp;</font><font color="#2a00ff">&#34;Edit&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">addRequestParameter</font><font color="#000000">(</font><font color="#2a00ff">&#34;id&#34;</font><font color="#000000">,&nbsp;</font><font color="#2a00ff">&#34;1&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">actionPerform</font><font color="#000000">()</font><font color="#000000">;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">verifyForward</font><font color="#000000">(</font><font color="#2a00ff">&#34;edit&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">assertTrue</font><font color="#000000">(</font><font color="#000000">request.getAttribute</font><font color="#000000">(</font><font color="#000000">Constants.PERSON_KEY</font><font color="#000000">)&nbsp;</font><font color="#000000">!=&nbsp;</font><font color="#7f0055"><b>null</b></font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">verifyNoActionErrors</font><font color="#000000">()</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">testSave</font><font color="#000000">()&nbsp;</font><font color="#7f0055"><b>throws&nbsp;</b></font><font color="#000000">Exception&nbsp;</font><font color="#000000">{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">setRequestPathInfo</font><font color="#000000">(</font><font color="#2a00ff">&#34;/editPerson&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">addRequestParameter</font><font color="#000000">(</font><font color="#2a00ff">&#34;method&#34;</font><font color="#000000">,&nbsp;</font><font color="#2a00ff">&#34;Edit&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">addRequestParameter</font><font color="#000000">(</font><font color="#2a00ff">&#34;id&#34;</font><font color="#000000">,&nbsp;</font><font color="#2a00ff">&#34;1&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">actionPerform</font><font color="#000000">()</font><font color="#000000">;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">PersonForm&nbsp;personForm&nbsp;=</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">(</font><font color="#000000">PersonForm</font><font color="#000000">)&nbsp;</font><font color="#000000">request.getAttribute</font><font color="#000000">(</font><font color="#000000">Constants.PERSON_KEY</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">assertTrue</font><font color="#000000">(</font><font color="#000000">personForm&nbsp;!=&nbsp;</font><font color="#7f0055"><b>null</b></font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">setRequestPathInfo</font><font color="#000000">(</font><font color="#2a00ff">&#34;/savePerson&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">addRequestParameter</font><font color="#000000">(</font><font color="#2a00ff">&#34;method&#34;</font><font color="#000000">,&nbsp;</font><font color="#2a00ff">&#34;Save&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f7f5f">//&nbsp;update&nbsp;the&nbsp;form&nbsp;from&nbsp;the&nbsp;edit&nbsp;and&nbsp;add&nbsp;it&nbsp;back&nbsp;to&nbsp;the&nbsp;request</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">personForm.setLastName</font><font color="#000000">(</font><font color="#2a00ff">&#34;Feltz&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">request.setAttribute</font><font color="#000000">(</font><font color="#000000">Constants.PERSON_KEY,&nbsp;personForm</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">actionPerform</font><font color="#000000">()</font><font color="#000000">;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">verifyForward</font><font color="#000000">(</font><font color="#2a00ff">&#34;edit&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">verifyNoActionErrors</font><font color="#000000">()</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">testRemove</font><font color="#000000">()&nbsp;</font><font color="#7f0055"><b>throws&nbsp;</b></font><font color="#000000">Exception&nbsp;</font><font color="#000000">{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">setRequestPathInfo</font><font color="#000000">(</font><font color="#2a00ff">&#34;/editPerson&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">addRequestParameter</font><font color="#000000">(</font><font color="#2a00ff">&#34;method&#34;</font><font color="#000000">,&nbsp;</font><font color="#2a00ff">&#34;Delete&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">addRequestParameter</font><font color="#000000">(</font><font color="#2a00ff">&#34;id&#34;</font><font color="#000000">,&nbsp;</font><font color="#2a00ff">&#34;2&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">actionPerform</font><font color="#000000">()</font><font color="#000000">;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">verifyForward</font><font color="#000000">(</font><font color="#2a00ff">&#34;mainMenu&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">verifyNoActionErrors</font><font color="#000000">()</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#000000">}</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>You will need to add <b>PERSON_KEY</b> as a variable to the src/dao/**/Constants.java class. The name, "personForm", matches the name given to the form in the struts-config.xml file.
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">/**</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*&nbsp;The&nbsp;request&nbsp;scope&nbsp;attribute&nbsp;that&nbsp;holds&nbsp;the&nbsp;person&nbsp;form.</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*/</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;static&nbsp;final&nbsp;</b></font><font color="#000000">String&nbsp;PERSON_KEY&nbsp;=&nbsp;</font><font color="#2a00ff">&#34;personForm&#34;</font><font color="#000000">;</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>If you try to run this test, you will get a number of NoSuchMethodErrors - so let's define the edit, save, and delete methods in the PersonAction class.
</p>
<h3 id='section-CreateActions-CreatePersonAction4'>Create PersonAction <a class="footnote" name="ref-CreateActions-4">[#4]</a></h3>
<p>In src/web/**/action, create a PersonAction.java file with the following contents:
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#7f0055"><b>package&nbsp;</b></font><font color="#000000">org.appfuse.webapp.action;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">javax.servlet.http.HttpServletRequest;</font><br/>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">javax.servlet.http.HttpServletResponse;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">org.apache.struts.action.ActionForm;</font><br/>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">org.apache.struts.action.ActionForward;</font><br/>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">org.apache.struts.action.ActionMapping;</font><br/>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">org.apache.struts.action.ActionMessage;</font><br/>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">org.apache.struts.action.ActionMessages;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">org.appfuse.model.Person;</font><br/>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">org.appfuse.service.PersonManager;</font><br/>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">org.appfuse.webapp.form.PersonForm;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#3f5fbf">/**</font><br/>
<font color="#ffffff">&nbsp;</font><font color="#3f5fbf">*&nbsp;@struts.action&nbsp;name=&#34;personForm&#34;&nbsp;path=&#34;/editPerson&#34;&nbsp;scope=&#34;request&#34;</font><br/>
<font color="#ffffff">&nbsp;</font><font color="#3f5fbf">*&nbsp;&nbsp;validate=&#34;false&#34;&nbsp;parameter=&#34;method&#34;&nbsp;input=&#34;mainMenu&#34;</font><br/>
<font color="#ffffff">&nbsp;</font><font color="#3f5fbf">*/</font><br/>
<font color="#7f0055"><b>public&nbsp;final&nbsp;class&nbsp;</b></font><font color="#000000">PersonAction&nbsp;</font><font color="#7f0055"><b>extends&nbsp;</b></font><font color="#000000">BaseAction&nbsp;</font><font color="#000000">{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#000000">ActionForward&nbsp;cancel</font><font color="#000000">(</font><font color="#000000">ActionMapping&nbsp;mapping,&nbsp;ActionForm&nbsp;form,</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">HttpServletRequest&nbsp;request,</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">HttpServletResponse&nbsp;response</font><font color="#000000">)</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>throws&nbsp;</b></font><font color="#000000">Exception&nbsp;</font><font color="#000000">{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>return&nbsp;</b></font><font color="#000000">mapping.findForward</font><font color="#000000">(</font><font color="#2a00ff">&#34;mainMenu&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#000000">ActionForward&nbsp;delete</font><font color="#000000">(</font><font color="#000000">ActionMapping&nbsp;mapping,&nbsp;ActionForm&nbsp;form,</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">HttpServletRequest&nbsp;request,</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">HttpServletResponse&nbsp;response</font><font color="#000000">)</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>throws&nbsp;</b></font><font color="#000000">Exception&nbsp;</font><font color="#000000">{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>if&nbsp;</b></font><font color="#000000">(</font><font color="#000000">log.isDebugEnabled</font><font color="#000000">())&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">log.debug</font><font color="#000000">(</font><font color="#2a00ff">&#34;Entering&nbsp;'delete'&nbsp;method&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">ActionMessages&nbsp;messages&nbsp;=&nbsp;</font><font color="#7f0055"><b>new&nbsp;</b></font><font color="#000000">ActionMessages</font><font color="#000000">()</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">PersonForm&nbsp;personForm&nbsp;=&nbsp;</font><font color="#000000">(</font><font color="#000000">PersonForm</font><font color="#000000">)&nbsp;</font><font color="#000000">form;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f7f5f">//&nbsp;Exceptions&nbsp;are&nbsp;caught&nbsp;by&nbsp;ActionExceptionHandler</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">PersonManager&nbsp;mgr&nbsp;=&nbsp;</font><font color="#000000">(</font><font color="#000000">PersonManager</font><font color="#000000">)&nbsp;</font><font color="#000000">getBean</font><font color="#000000">(</font><font color="#2a00ff">&#34;personManager&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">mgr.removePerson</font><font color="#000000">(</font><font color="#000000">personForm.getId</font><font color="#000000">())</font><font color="#000000">;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">messages.add</font><font color="#000000">(</font><font color="#000000">ActionMessages.GLOBAL_MESSAGE,</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>new&nbsp;</b></font><font color="#000000">ActionMessage</font><font color="#000000">(</font><font color="#2a00ff">&#34;person.deleted&#34;</font><font color="#000000">))</font><font color="#000000">;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f7f5f">//&nbsp;save&nbsp;messages&nbsp;in&nbsp;session,&nbsp;so&nbsp;they'll&nbsp;survive&nbsp;the&nbsp;redirect</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">saveMessages</font><font color="#000000">(</font><font color="#000000">request.getSession</font><font color="#000000">()</font><font color="#000000">,&nbsp;messages</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>return&nbsp;</b></font><font color="#000000">mapping.findForward</font><font color="#000000">(</font><font color="#2a00ff">&#34;mainMenu&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#000000">ActionForward&nbsp;edit</font><font color="#000000">(</font><font color="#000000">ActionMapping&nbsp;mapping,&nbsp;ActionForm&nbsp;form,</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">HttpServletRequest&nbsp;request,</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">HttpServletResponse&nbsp;response</font><font color="#000000">)</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>throws&nbsp;</b></font><font color="#000000">Exception&nbsp;</font><font color="#000000">{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>if&nbsp;</b></font><font color="#000000">(</font><font color="#000000">log.isDebugEnabled</font><font color="#000000">())&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">log.debug</font><font color="#000000">(</font><font color="#2a00ff">&#34;Entering&nbsp;'edit'&nbsp;method&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">PersonForm&nbsp;personForm&nbsp;=&nbsp;</font><font color="#000000">(</font><font color="#000000">PersonForm</font><font color="#000000">)&nbsp;</font><font color="#000000">form;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f7f5f">//&nbsp;if&nbsp;an&nbsp;id&nbsp;is&nbsp;passed&nbsp;in,&nbsp;look&nbsp;up&nbsp;the&nbsp;user&nbsp;-&nbsp;otherwise</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f7f5f">//&nbsp;don't&nbsp;do&nbsp;anything&nbsp;-&nbsp;user&nbsp;is&nbsp;doing&nbsp;an&nbsp;add</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>if&nbsp;</b></font><font color="#000000">(</font><font color="#000000">personForm.getId</font><font color="#000000">()&nbsp;</font><font color="#000000">!=&nbsp;</font><font color="#7f0055"><b>null</b></font><font color="#000000">)&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">PersonManager&nbsp;mgr&nbsp;=&nbsp;</font><font color="#000000">(</font><font color="#000000">PersonManager</font><font color="#000000">)&nbsp;</font><font color="#000000">getBean</font><font color="#000000">(</font><font color="#2a00ff">&#34;personManager&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">Person&nbsp;person&nbsp;=&nbsp;mgr.getPerson</font><font color="#000000">(</font><font color="#000000">personForm.getId</font><font color="#000000">())</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">personForm&nbsp;=&nbsp;</font><font color="#000000">(</font><font color="#000000">PersonForm</font><font color="#000000">)&nbsp;</font><font color="#000000">convert</font><font color="#000000">(</font><font color="#000000">person</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">updateFormBean</font><font color="#000000">(</font><font color="#000000">mapping,&nbsp;request,&nbsp;personForm</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>return&nbsp;</b></font><font color="#000000">mapping.findForward</font><font color="#000000">(</font><font color="#2a00ff">&#34;edit&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#000000">ActionForward&nbsp;save</font><font color="#000000">(</font><font color="#000000">ActionMapping&nbsp;mapping,&nbsp;ActionForm&nbsp;form,</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">HttpServletRequest&nbsp;request,</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">HttpServletResponse&nbsp;response</font><font color="#000000">)</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>throws&nbsp;</b></font><font color="#000000">Exception&nbsp;</font><font color="#000000">{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>if&nbsp;</b></font><font color="#000000">(</font><font color="#000000">log.isDebugEnabled</font><font color="#000000">())&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">log.debug</font><font color="#000000">(</font><font color="#2a00ff">&#34;Entering&nbsp;'save'&nbsp;method&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f7f5f">//&nbsp;Extract&nbsp;attributes&nbsp;and&nbsp;parameters&nbsp;we&nbsp;will&nbsp;need</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">ActionMessages&nbsp;messages&nbsp;=&nbsp;</font><font color="#7f0055"><b>new&nbsp;</b></font><font color="#000000">ActionMessages</font><font color="#000000">()</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">PersonForm&nbsp;personForm&nbsp;=&nbsp;</font><font color="#000000">(</font><font color="#000000">PersonForm</font><font color="#000000">)&nbsp;</font><font color="#000000">form;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>boolean&nbsp;</b></font><font color="#000000">isNew&nbsp;=&nbsp;</font><font color="#000000">(</font><font color="#2a00ff">&#34;&#34;</font><font color="#000000">.equals</font><font color="#000000">(</font><font color="#000000">personForm.getId</font><font color="#000000">()))</font><font color="#000000">;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>if&nbsp;</b></font><font color="#000000">(</font><font color="#000000">log.isDebugEnabled</font><font color="#000000">())&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">log.debug</font><font color="#000000">(</font><font color="#2a00ff">&#34;saving&nbsp;person:&nbsp;&#34;&nbsp;</font><font color="#000000">+&nbsp;personForm</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">PersonManager&nbsp;mgr&nbsp;=&nbsp;</font><font color="#000000">(</font><font color="#000000">PersonManager</font><font color="#000000">)&nbsp;</font><font color="#000000">getBean</font><font color="#000000">(</font><font color="#2a00ff">&#34;personManager&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">Person&nbsp;person&nbsp;=&nbsp;</font><font color="#000000">(</font><font color="#000000">Person</font><font color="#000000">)&nbsp;</font><font color="#000000">convert</font><font color="#000000">(</font><font color="#000000">personForm</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">mgr.savePerson</font><font color="#000000">(</font><font color="#000000">person</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f7f5f">//&nbsp;add&nbsp;success&nbsp;messages</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>if&nbsp;</b></font><font color="#000000">(</font><font color="#000000">isNew</font><font color="#000000">)&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">messages.add</font><font color="#000000">(</font><font color="#000000">ActionMessages.GLOBAL_MESSAGE,</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>new&nbsp;</b></font><font color="#000000">ActionMessage</font><font color="#000000">(</font><font color="#2a00ff">&#34;person.added&#34;</font><font color="#000000">))</font><font color="#000000">;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f7f5f">//&nbsp;save&nbsp;messages&nbsp;in&nbsp;session&nbsp;to&nbsp;survive&nbsp;a&nbsp;redirect</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">saveMessages</font><font color="#000000">(</font><font color="#000000">request.getSession</font><font color="#000000">()</font><font color="#000000">,&nbsp;messages</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>return&nbsp;</b></font><font color="#000000">mapping.findForward</font><font color="#000000">(</font><font color="#2a00ff">&#34;mainMenu&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}&nbsp;</font><font color="#7f0055"><b>else&nbsp;</b></font><font color="#000000">{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">messages.add</font><font color="#000000">(</font><font color="#000000">ActionMessages.GLOBAL_MESSAGE,</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>new&nbsp;</b></font><font color="#000000">ActionMessage</font><font color="#000000">(</font><font color="#2a00ff">&#34;person.updated&#34;</font><font color="#000000">))</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">saveMessages</font><font color="#000000">(</font><font color="#000000">request,&nbsp;messages</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>return&nbsp;</b></font><font color="#000000">mapping.findForward</font><font color="#000000">(</font><font color="#2a00ff">&#34;edit&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#000000">}</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>You'll notice in the code above that there are many calls to to <i>convert</i> a PersonForm or a Person object.  The <i>convert</i> method is in BaseAction.java (which calls ConvertUtil.convert()) and
uses 
<a class="external" href="http://jakarta.apache.org/commons/beanutils/api/org/apache/commons/beanutils/BeanUtils.html#copyProperties(java.lang.Object,%20java.lang.Object)">BeanUtils.copyProperties</a><img class="outlink" src="images/out.png" alt="" /> 
to convert POJOs &rarr; ActionForms and ActionForms &rarr; POJOs.   
</p>
<dl>
<dt></dt><dd><i>If you are running Eclipse, you might have to "refresh" the project in order to see PersonForm.  It lives in build/web/gen, which should be one of your project's source folders.  This is the only way for Eclipse to see and import PersonForm, since it is generated by XDoclet and does not live in your regular source tree.  You can find it at build/web/gen/org/appfuse/webapp/form/PersonForm.java.</i></dd>
</dl>
<dl>
<dt></dt><dd><i>In <a class="external" href="http://raibledesigns.com/downloads/apptracker/api/org/appfuse/webapp/action/BaseAction.java.html">BaseAction</a><img class="outlink" src="images/out.png" alt="" /> you can register additional Converters (i.e. <a class="external" href="http://raibledesigns.com/downloads/apptracker/api/org/apptracker/util/DateConverter.java.html">DateConverter</a><img class="outlink" src="images/out.png" alt="" />) so that BeanUtils.copyProperties knows how to convert Strings &rarr; Objects.  If you have Lists on your POJOs (i.e. for parent-child relationships), you will need to manually convert those using the <tt>convertLists(java.lang.Object)</tt> method.</i></dd>
</dl>
<p>Now you need to add the <i>edit</i> forward and the <i>savePerson</i> action-mapping, both which are specified in in the PersonActionTest. To do this,  add a couple more XDoclet tags to the top of the PersonAction.java file.  Do this right above the class declaration.  You should already have the XDoclet tag for the <i>editPerson</i> action-mapping, but I'm showing it here so you can see all the XDoclet tags at the top of this class.
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#3f5fbf">/**</font><br/>
<font color="#ffffff">&nbsp;</font><font color="#3f5fbf">*&nbsp;@struts.action&nbsp;name=&#34;personForm&#34;&nbsp;path=&#34;/editPerson&#34;&nbsp;scope=&#34;request&#34;</font><br/>
<font color="#ffffff">&nbsp;</font><font color="#3f5fbf">*&nbsp;&nbsp;validate=&#34;false&#34;&nbsp;parameter=&#34;method&#34;&nbsp;input=&#34;mainMenu&#34;</font><br/>
<font color="#ffffff">&nbsp;</font><font color="#3f5fbf">*&nbsp;</font><br/>
<font color="#ffffff">&nbsp;</font><font color="#3f5fbf">*&nbsp;@struts.action&nbsp;name=&#34;personForm&#34;&nbsp;path=&#34;/savePerson&#34;&nbsp;scope=&#34;request&#34;</font><br/>
<font color="#ffffff">&nbsp;</font><font color="#3f5fbf">*&nbsp;&nbsp;validate=&#34;true&#34;&nbsp;parameter=&#34;method&#34;&nbsp;input=&#34;edit&#34;</font><br/>
<font color="#ffffff">&nbsp;</font><font color="#3f5fbf">*&nbsp;</font><br/>
<font color="#ffffff">&nbsp;</font><font color="#3f5fbf">*&nbsp;@struts.action-forward&nbsp;name=&#34;edit&#34;&nbsp;path=&#34;/WEB-INF/pages/personForm.jsp&#34;</font><br/>
<font color="#ffffff">&nbsp;</font><font color="#3f5fbf">*/</font><br/>
<font color="#7f0055"><b>public&nbsp;final&nbsp;class&nbsp;</b></font><font color="#000000">PersonAction&nbsp;</font><font color="#7f0055"><b>extends&nbsp;</b></font><font color="#000000">BaseAction&nbsp;</font><font color="#000000">{</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>The main difference between the <i>editPerson</i> and <i>savePerson</i> action-mappings is that <i>savePerson</i> has validation turned on (see validation="true") in the XDoclet tag above.  Note that the "input" attribute must refer to a forward, and cannot be a path (i.e. /editPerson.html).  If you'd prefer to use the save path for both edit and save, that's possible too.  Just make sure validate="false", and then in your "save" method - you'll need to call form.validate() and handle errors appropriately.
</p>
<p>You might notice that the code you're using to call the PersonManager is the same as the code used in the PersonManagerTest.  Both PersonAction and PersonManagerTest are <i>clients</i> of PersonManagerImpl, so this makes perfect sense.
</p>
<p>Everything is almost done for this tutorial, let's get to running the tests!
</p>
<h3 id='section-CreateActions-RunPersonActionTest5'>Run PersonActionTest <a class="footnote" name="ref-CreateActions-5">[#5]</a></h3>
<p>If you look at our PersonActionTest, all the tests depend on having a record with id=1 in the database (and testRemove depends on id=2), so add that to our sample data file (metadata/sql/sample-data.xml). I'd add it at the bottom - order is not important since it (currently) does not relate to any other tables.
</p>
<pre>
  &lt;table name='person'&gt;
    &lt;column&gt;id&lt;/column&gt;
    &lt;column&gt;first_name&lt;/column&gt;
    &lt;column&gt;last_name&lt;/column&gt;
    &lt;row&gt;
      &lt;value&gt;1&lt;/value&gt;
      &lt;value&gt;Matt&lt;/value&gt;
      &lt;value&gt;Raible&lt;/value&gt;
    &lt;/row&gt;
    &lt;row&gt;
      &lt;value&gt;2&lt;/value&gt;
      &lt;value&gt;James&lt;/value&gt;
      &lt;value&gt;Davidson&lt;/value&gt;
    &lt;/row&gt;
  &lt;/table&gt;
</pre>

<p>DBUnit loads this file before we run any of our tests, so this record will be available to the PersonActionTest.
</p>
<p>Now if you run <b>ant test-web -Dtestcase=PersonAction</b> - everything should work as planned.  Make sure Tomcat isn't running before you try this.
</p>
<span style="color:green">BUILD SUCCESSFUL<br />
Total time: 1 minute 21 seconds</span>
<h3 id='section-CreateActions-CleanUpTheJSPToMakeItPresentable6'>Clean up the JSP to make it presentable <a class="footnote" name="ref-CreateActions-6">[#6]</a></h3>
<p>Now let's clean up the generated personForm.jsp.  Change the <i>action</i> of the &lt;html:form&gt; to be "savePerson" so validation will be turned on when saving.  Also, change the <i>focus</i> attribute from focus="" to focus="firstName" so the cursor will be in the firstName field when the page loads (this is done with JavaScript).  
</p>
<p>Another thing you will need to do is comment out the following lines at the bottom of the personForm.jsp.  This is because the Validator will throw an exception if a formName is specified and no validation rules exist for it.  
</p>
<dl>
<dt></dt><dd><i>Personally, I think this is <a class="external" href="http://nagoya.apache.org/bugzilla/show_bug.cgi?id=27316">a bug</a><img class="outlink" src="images/out.png" alt="" />, but the Struts Committers disagreed.</i></dd>
</dl>
<pre>&lt;html:javascript formName="personForm" cdata="false"
    dynamicJavascript="true" staticJavascript="false"/&gt;
&lt;script type="text/javascript" 
    src="&lt;html:rewrite page="/scripts/validator.jsp"/&gt;"&gt;&lt;/script&gt;</pre>

<p>Now if you execute <b>ant db-load deploy</b>, start Tomcat and point your browser to <a class="external" href="http://localhost:8080/appfuse/editPerson.html?id=1">http://localhost:8080/appfuse/editPerson.html?id=1</a><img class="outlink" src="images/out.png" alt="" />, you should see something like this:
</p>
<div style="border: 1px solid black; margin: 0 auto; height: 166px; width: 337px">
<img class="inline" src="attach/CreateActions/personForm-final.png" alt="personForm-final.png" />
</div>
<p></p>
<span class="note"><b>NOTE:</b> Use the <b>deploy-web</b> target if you've changed any files under the <i>web</i> directory.  Otherwise, use <b>deploy</b> which compiles and deploys.</span>
<p>Finally, to make this page more user friendly, you may want to add a message for your users at the top of the form, which can easily be done by adding text (using &lt;fmt:message&gt;) at the top of the personForm.jsp page.
</p>
<h3 id='section-CreateActions-OptionalCreateACanooWebTestToTestBrowserLikeActions7'>[Optional] Create a Canoo WebTest to test browser-like actions <a class="footnote" name="ref-CreateActions-7">[#7]</a></h3>
The final (optional) step in this tutorial is to create a <a class="external" href="http://webtest.canoo.com">Canoo WebTest</a><img class="outlink" src="images/out.png" alt="" /> to test the JSPs.  
<dl>
<dt></dt><dd><i>I say this step is optional, because you can run the same tests through your browser.</i></dd>
</dl>
<p>You can use the following URLs to test the different actions for adding, editing and saving a user.
</p>
<ul>
<li> Add - <a class="external" href="http://localhost:8080/appfuse/editPerson.html">http://localhost:8080/appfuse/editPerson.html</a><img class="outlink" src="images/out.png" alt="" />.
</li>
<li> Edit - <a class="external" href="http://localhost:8080/appfuse/editPerson.html?id=1">http://localhost:8080/appfuse/editPerson.html?id=1</a><img class="outlink" src="images/out.png" alt="" /> (make sure and run <b>ant db-load</b> first).
</li>
<li> Delete - <a class="external" href="http://localhost:8080/appfuse/editPerson.html?method=Delete&amp;amp;id=1">http://localhost:8080/appfuse/editPerson.html?method=Delete&amp;amp;id=1</a><img class="outlink" src="images/out.png" alt="" /> (or edit and click on the Delete button).
</li>
<li> Save - Click <a class="external" href="http://localhost:8080/appfuse/editPerson.html?id=1">edit</a><img class="outlink" src="images/out.png" alt="" /> and then click the Save button.
</li>
</ul>
<p>Canoo tests are pretty slick in that they're simply configured in an XML file.  To add tests for add, edit, save and delete, open test/web/web-tests.xml and add the following XML.  You'll notice that this fragment has a target named <i>PersonTests</i> that runs all the related tests.  
</p>
<dl>
<dt></dt><dd><i>I use CamelCase target names (vs. the traditional lowercase, dash-separated) because when you're typing </i>-Dtestcase=Name<i>, I've found that I'm used to doing CamelCase for my JUnit Tests.</i></dd>
</dl>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#000000">&lt;!--&nbsp;runs&nbsp;person-related&nbsp;tests&nbsp;--&gt;</font><br/>
<font color="#000000">&lt;target&nbsp;name=</font><font color="#2a00ff">&#34;PersonTests&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">depends=</font><font color="#2a00ff">&#34;EditPerson,SavePerson,AddPerson,DeletePerson&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">description=</font><font color="#2a00ff">&#34;Call&nbsp;and&nbsp;executes&nbsp;all&nbsp;person&nbsp;test&nbsp;cases&nbsp;(targets)&#34;</font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;echo&gt;Successfully&nbsp;ran&nbsp;all&nbsp;Person&nbsp;JSP&nbsp;tests!&lt;/echo&gt;</font><br/>
<font color="#000000">&lt;/target&gt;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#000000">&lt;!--&nbsp;Verify&nbsp;the&nbsp;edit&nbsp;person&nbsp;screen&nbsp;displays&nbsp;without&nbsp;errors&nbsp;--&gt;</font><br/>
<font color="#000000">&lt;target&nbsp;name=</font><font color="#2a00ff">&#34;EditPerson&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">description=</font><font color="#2a00ff">&#34;Tests&nbsp;editing&nbsp;an&nbsp;existing&nbsp;Person's&nbsp;information&#34;</font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;webtest&nbsp;name=</font><font color="#2a00ff">&#34;editPerson&#34;</font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&amp;config;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;steps&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&amp;login;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;invoke&nbsp;description=</font><font color="#2a00ff">&#34;click&nbsp;Edit&nbsp;Person&nbsp;link&#34;&nbsp;</font><font color="#000000">url=</font><font color="#2a00ff">&#34;/editPerson.html?id=1&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;verifytitle&nbsp;description=</font><font color="#2a00ff">&#34;we&nbsp;should&nbsp;see&nbsp;the&nbsp;personDetail&nbsp;title&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">text=</font><font color="#2a00ff">&#34;.*${personDetail.title}.*&#34;&nbsp;</font><font color="#000000">regex=</font><font color="#2a00ff">&#34;true&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/steps&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/webtest&gt;</font><br/>
<font color="#000000">&lt;/target&gt;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#000000">&lt;!--&nbsp;Edit&nbsp;a&nbsp;person&nbsp;and&nbsp;then&nbsp;save&nbsp;--&gt;</font><br/>
<font color="#000000">&lt;target&nbsp;name=</font><font color="#2a00ff">&#34;SavePerson&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">description=</font><font color="#2a00ff">&#34;Tests&nbsp;editing&nbsp;and&nbsp;saving&nbsp;a&nbsp;user&#34;</font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;webtest&nbsp;name=</font><font color="#2a00ff">&#34;savePerson&#34;</font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&amp;config;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;steps&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&amp;login;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;invoke&nbsp;description=</font><font color="#2a00ff">&#34;click&nbsp;Edit&nbsp;Person&nbsp;link&#34;&nbsp;</font><font color="#000000">url=</font><font color="#2a00ff">&#34;/editPerson.html?id=1&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;verifytitle&nbsp;description=</font><font color="#2a00ff">&#34;we&nbsp;should&nbsp;see&nbsp;the&nbsp;personDetail&nbsp;title&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">text=</font><font color="#2a00ff">&#34;.*${personDetail.title}.*&#34;&nbsp;</font><font color="#000000">regex=</font><font color="#2a00ff">&#34;true&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;setinputfield&nbsp;description=</font><font color="#2a00ff">&#34;set&nbsp;lastName&#34;&nbsp;</font><font color="#000000">name=</font><font color="#2a00ff">&#34;lastName&#34;&nbsp;</font><font color="#000000">value=</font><font color="#2a00ff">&#34;Canoo&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;clickbutton&nbsp;label=</font><font color="#2a00ff">&#34;Save&#34;&nbsp;</font><font color="#000000">description=</font><font color="#2a00ff">&#34;Click&nbsp;Save&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;verifytitle&nbsp;description=</font><font color="#2a00ff">&#34;Page&nbsp;re-appears&nbsp;if&nbsp;save&nbsp;successful&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">text=</font><font color="#2a00ff">&#34;.*${personDetail.title}.*&#34;&nbsp;</font><font color="#000000">regex=</font><font color="#2a00ff">&#34;true&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;verifytext&nbsp;description=</font><font color="#2a00ff">&#34;verify&nbsp;success&nbsp;message&#34;&nbsp;</font><font color="#000000">text=</font><font color="#2a00ff">&#34;${person.updated}&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/steps&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/webtest&gt;</font><br/>
<font color="#000000">&lt;/target&gt;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#000000">&lt;!--&nbsp;Add&nbsp;a&nbsp;</font><font color="#7f0055"><b>new&nbsp;</b></font><font color="#000000">Person&nbsp;--&gt;</font><br/>
<font color="#000000">&lt;target&nbsp;name=</font><font color="#2a00ff">&#34;AddPerson&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">description=</font><font color="#2a00ff">&#34;Adds&nbsp;a&nbsp;new&nbsp;Person&#34;</font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;webtest&nbsp;name=</font><font color="#2a00ff">&#34;addPerson&#34;</font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&amp;config;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;steps&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&amp;login;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;invoke&nbsp;description=</font><font color="#2a00ff">&#34;click&nbsp;Add&nbsp;Button&#34;&nbsp;</font><font color="#000000">url=</font><font color="#2a00ff">&#34;/editPerson.html&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;verifytitle&nbsp;description=</font><font color="#2a00ff">&#34;we&nbsp;should&nbsp;see&nbsp;the&nbsp;personDetail&nbsp;title&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">text=</font><font color="#2a00ff">&#34;.*${personDetail.title}.*&#34;&nbsp;</font><font color="#000000">regex=</font><font color="#2a00ff">&#34;true&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;setinputfield&nbsp;description=</font><font color="#2a00ff">&#34;set&nbsp;firstName&#34;&nbsp;</font><font color="#000000">name=</font><font color="#2a00ff">&#34;firstName&#34;&nbsp;</font><font color="#000000">value=</font><font color="#2a00ff">&#34;Abbie&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;setinputfield&nbsp;description=</font><font color="#2a00ff">&#34;set&nbsp;lastName&#34;&nbsp;</font><font color="#000000">name=</font><font color="#2a00ff">&#34;lastName&#34;&nbsp;</font><font color="#000000">value=</font><font color="#2a00ff">&#34;Raible&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;clickbutton&nbsp;label=</font><font color="#2a00ff">&#34;${button.save}&#34;&nbsp;</font><font color="#000000">description=</font><font color="#2a00ff">&#34;Click&nbsp;button&nbsp;'Save'&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;verifytitle&nbsp;description=</font><font color="#2a00ff">&#34;Main&nbsp;Menu&nbsp;appears&nbsp;if&nbsp;save&nbsp;successful&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">text=</font><font color="#2a00ff">&#34;.*${mainMenu.title}.*&#34;&nbsp;</font><font color="#000000">regex=</font><font color="#2a00ff">&#34;true&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;verifytext&nbsp;description=</font><font color="#2a00ff">&#34;verify&nbsp;success&nbsp;message&#34;&nbsp;</font><font color="#000000">text=</font><font color="#2a00ff">&#34;${person.added}&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/steps&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/webtest&gt;</font><br/>
<font color="#000000">&lt;/target&gt;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#000000">&lt;!--&nbsp;Delete&nbsp;existing&nbsp;person&nbsp;--&gt;</font><br/>
<font color="#000000">&lt;target&nbsp;name=</font><font color="#2a00ff">&#34;DeletePerson&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">description=</font><font color="#2a00ff">&#34;Deletes&nbsp;existing&nbsp;Person&#34;</font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;webtest&nbsp;name=</font><font color="#2a00ff">&#34;deletePerson&#34;</font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&amp;config;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;steps&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&amp;login;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;invoke&nbsp;description=</font><font color="#2a00ff">&#34;click&nbsp;Edit&nbsp;Person&nbsp;link&#34;&nbsp;</font><font color="#000000">url=</font><font color="#2a00ff">&#34;/editPerson.html?id=1&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;prepareDialogResponse&nbsp;description=</font><font color="#2a00ff">&#34;Confirm&nbsp;delete&#34;&nbsp;</font><font color="#000000">dialogType=</font><font color="#2a00ff">&#34;confirm&#34;&nbsp;</font><font color="#000000">response=</font><font color="#2a00ff">&#34;true&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;clickbutton&nbsp;label=</font><font color="#2a00ff">&#34;${button.delete}&#34;&nbsp;</font><font color="#000000">description=</font><font color="#2a00ff">&#34;Click&nbsp;button&nbsp;'Delete'&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;verifyNoDialogResponses/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;verifytitle&nbsp;description=</font><font color="#2a00ff">&#34;display&nbsp;Main&nbsp;Menu&#34;&nbsp;</font><font color="#000000">text=</font><font color="#2a00ff">&#34;.*${mainMenu.title}.*&#34;&nbsp;</font><font color="#000000">regex=</font><font color="#2a00ff">&#34;true&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;verifytext&nbsp;description=</font><font color="#2a00ff">&#34;verify&nbsp;success&nbsp;message&#34;&nbsp;</font><font color="#000000">text=</font><font color="#2a00ff">&#34;${person.deleted}&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/steps&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/webtest&gt;</font><br/>
<font color="#000000">&lt;/target&gt;</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>After adding this, you should be able to run <b>ant test-canoo -Dtestcase=PersonTests</b> with Tomcat running or <b>ant test-jsp -Dtestcase=PersonTests</b> if you want Ant to start/stop Tomcat for you.  To include the PersonTests when all Canoo tests are run, add it as a dependency to the "run-all-tests" target.
</p>
<p>You'll notice that there's no logging in the client-side window by Canoo.  If you'd like to see what it's doing, you can add the following between &lt;/webtest&gt; and &lt;/target&gt; at the end of each target.
</p>
<pre>&lt;loadfile property="web-tests.result" 
    srcFile="${test.dir}/data/web-tests-result.xml"/&gt;
&lt;echo&gt;${web-tests.result}&lt;/echo&gt;</pre>

<span style="color:green">BUILD SUCCESSFUL<br />
Total time: 11 seconds</span>
<p></p>
<hr />
<p><i>Next Up:</i> <b>Part IV:</b> <a class="wikipage" href="Wiki.jsp?page=ValidationAndList">Adding Validation and List Screen</a> - Adding validation logic to the personForm so that firstName and lastName are required fields and adding a list screen to display all person records in the database.
</p>
<A NAME="Link_CreateDAO">
<h1>CreateDAO</h1>
</A>
<b>Part I:</b> <a class="wikipage" href="Wiki.jsp?page=CreateDAO">Creating new DAOs and Objects in AppFuse</a> - A HowTo for creating Java Objects (that represent tables) and creating Java classes to persist those objects in the database.
<h3 id='section-CreateDAO-AboutThisTutorial'>About this tutorial</h3>
This tutorial will show you how to create a new table in the database, and how the create Java code to access this table.  
<p>You will create an object and then some more classes to persist (save/retrieve/delete) that object from the database.  In Java speak, this object is called a Plain Old Java Object (a.k.a. a <a class="external" href="http://forum.java.sun.com/thread.jsp?forum=92&amp;thread=425300&amp;tstart=0&amp;trange=15">POJO</a><img class="outlink" src="images/out.png" alt="" />).  This object basically represents a database table.  The <i>other classes</i> will be:
</p>
<ul>
<li> A Data Access Object (a.k.a. a <a class="external" href="http://java.sun.com/blueprints/patterns/DAO.html">DAO</a><img class="outlink" src="images/out.png" alt="" />), an <a class="external" href="http://java.sun.com/docs/books/tutorial/java/concepts/interface.html">Interface</a><img class="outlink" src="images/out.png" alt="" /> and a Hibernate Implementation
</li>
<li> A <a class="external" href="http://www.junit.org">JUnit</a><img class="outlink" src="images/out.png" alt="" /> class to test the DAO is working
</li>
</ul>
<p>AppFuse uses <a class="external" href="http://www.hibernate.org">Hibernate</a><img class="outlink" src="images/out.png" alt="" /> for its default persistence layer.  Hibernate is an Object/Relational (O/R) Framework that allows you to relate your Java Objects to database tables.  It allows you to very easily perform CRUD (Create, Retrieve, Update, Delete) on your objects.  
</p>
<dl>
<dt></dt><dd><i>You can also use <a class="external" href="http://ibatis.com">iBATIS</a><img class="outlink" src="images/out.png" alt="" /> as a persistence framework option. To install iBATIS in AppFuse, view the README.txt in <tt>extras/ibatis</tt>.  Then complete the <a class="wikipage" href="Wiki.jsp?page=CreateDAOiBATIS">iBATIS version of this tutorial</a>.</i></dd>
</dl>
<h4 id='section-CreateDAO-FontConventionsworkInProgress'>Font Conventions (work in progress)</h4>
<dl>
<dt></dt><dd>Literal strings intended to be executed at the command prompt look like this: <b>ant test-all</b>.</dd>
</dl>
<dl>
<dt></dt><dd>References to files, directories and packages which exist in your source tree: <font size="2"><tt>build.xml</tt></font>.</dd>
</dl>
<dl>
<dt></dt><dd><span style="color: blue"><i>And suggestions for how to do stuff in the "Real World" are in blue italics.</i></span></dd>
</dl>
<p>Let's get started on creating a new Object, DAO and Test in AppFuse's project structure.  
</p>
<h4 id='section-CreateDAO-TableOfContents'>Table of Contents</h4>
<ul>
<li> <a class="footnoteref" href="#ref-CreateDAO-1">[1]</a> Create a new Object and add <a class="external" href="http://xdoclet.sf.net">XDoclet</a><img class="outlink" src="images/out.png" alt="" /> tags
</li>
<li> <a class="footnoteref" href="#ref-CreateDAO-2">[2]</a> Create a new database table from the object using Ant
</li>
<li> <a class="footnoteref" href="#ref-CreateDAO-3">[3]</a> Create a new DaoTest to run JUnit tests on the DAO
</li>
<li> <a class="footnoteref" href="#ref-CreateDAO-4">[4]</a> Create a new DAO to perform CRUD on the object
</li>
<li> <a class="footnoteref" href="#ref-CreateDAO-5">[5]</a> Configure Spring for the Person object and PersonDao
</li>
<li> <a class="footnoteref" href="#ref-CreateDAO-6">[6]</a> Run the DaoTest
</li>
</ul>
<h3 id='section-CreateDAO-CreateANewObjectAndAddXDocletTags1'>Create a new Object and add XDoclet tags <a class="footnote" name="ref-CreateDAO-1">[#1]</a></h3>
<p>The first thing you need to do is create an object to persist.  Create a simple "Person" object (in the <tt>src/dao/**/model</tt> directory) that has an id, a firstName and a lastName (as properties). 
</p>
<span class="note"><b>NOTE:</b> Copying the Java code in these tutorials <a class="external" href="http://raibledesigns.com/page/rd?anchor=java2html_plugin_for_jspwiki_causes">doesn't work in Firefox</a><img class="outlink" src="images/out.png" alt="" />. A workaround is to CTRL+Click (Command+Click on OS X) the code block and then copy it.</span>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#7f0055"><b>package&nbsp;</b></font><font color="#000000">org.appfuse.model;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#7f0055"><b>public&nbsp;class&nbsp;</b></font><font color="#000000">Person&nbsp;</font><font color="#7f0055"><b>extends&nbsp;</b></font><font color="#000000">BaseObject&nbsp;</font><font color="#000000">{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>private&nbsp;</b></font><font color="#000000">Long&nbsp;id;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>private&nbsp;</b></font><font color="#000000">String&nbsp;firstName;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>private&nbsp;</b></font><font color="#000000">String&nbsp;lastName;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f7f5f">/*</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f7f5f">Generate&nbsp;your&nbsp;getters&nbsp;and&nbsp;setters&nbsp;using&nbsp;your&nbsp;favorite&nbsp;IDE:&nbsp;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f7f5f">In&nbsp;Eclipse:</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f7f5f">Right-click&nbsp;-&gt;&nbsp;Source&nbsp;-&gt;&nbsp;Generate&nbsp;Getters&nbsp;and&nbsp;Setters</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f7f5f">*/</font><br/>
<font color="#000000">}</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>This class should extend <a class="external" href="http://raibledesigns.com/downloads/appfuse/api/org/appfuse/model/BaseObject.java.html">BaseObject</a><img class="outlink" src="images/out.png" alt="" />, which has 3 abstract methods: (equals(), hashCode() and toString()) that you will need to implement in the Person class.  The first two are required by Hibernate.  The easiest way to do this is using <a class="external" href="http://commonclipse.sf.net">Commonclipse</a><img class="outlink" src="images/out.png" alt="" />.  More information on using this tool can be found on <a class="external" href="http://www.leegrey.com/hmm/2004/09/29/1096491256000.html">Lee Grey's site</a><img class="outlink" src="images/out.png" alt="" />.  Another Eclipse Plugin you can use is <a class="external" href="http://commons4e.berlios.de/">Commons4E</a><img class="outlink" src="images/out.png" alt="" />.  I haven't used it, so I can't comment on its functionality.
</p>
<dl>
<dt></dt><dd><i>If you're using <a class="external" href="http://www.jetbrains.com/idea">IntelliJ IDEA</a><img class="outlink" src="images/out.png" alt="" />, you can generate equals() and hashCode(), but not toString().  There is a <a class="external" href="http://www.intellij.org/twiki/bin/view/Main/ToStringPlugin">ToStringPlugin</a><img class="outlink" src="images/out.png" alt="" /> that works reasonably well.</i></dd>
</dl>
<span class="note"><b>NOTE:</b> If installing these plugins doesn't work for you, you can find all of these methods in the Person.java object that's used to test AppGen.  Just look in <i>extras/appgen/test/dao/org/appfuse/model/Person.java</i> and copy and paste the methods from that class.</span>
<p>Now that you have this POJO created, you need to add XDoclet tags to generate the Hibernate mapping file.  This mapping file is used by Hibernate to map objects &rarr; tables and properties (variables) &rarr; columns.
</p>
<p>First of all, add a <a class="external" href="http://xdoclet.sourceforge.net/tags/hibernate-tags.html#@hibernate.class%20(0..1)">@hibernate.class</a><img class="outlink" src="images/out.png" alt="" /> tag that tells Hibernate what table this object relates to:
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#3f5fbf">/**</font><br/>
<font color="#ffffff">&nbsp;</font><font color="#3f5fbf">*&nbsp;@hibernate.class&nbsp;table=&#34;person&#34;</font><br/>
<font color="#ffffff">&nbsp;</font><font color="#3f5fbf">*/</font><br/>
<font color="#7f0055"><b>public&nbsp;class&nbsp;</b></font><font color="#000000">Person&nbsp;</font><font color="#7f0055"><b>extends&nbsp;</b></font><font color="#000000">BaseObject&nbsp;</font><font color="#000000">{</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>You also have to add a primary key mapping or XDoclet will puke when generating the mapping file.  Note that all @hibernate.* tags should be placed in the <b>getters'</b> Javadocs of your POJOs.
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">/**</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*&nbsp;</font><font color="#7f9fbf">@return&nbsp;</font><font color="#3f5fbf">Returns&nbsp;the&nbsp;id.</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*&nbsp;@hibernate.id&nbsp;column=&#34;id&#34;&nbsp;generator-class=&#34;increment&#34;&nbsp;unsaved-value=&#34;null&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*/</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#000000">Long&nbsp;getId</font><font color="#000000">()&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>return&nbsp;this</b></font><font color="#000000">.id;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<dl>
<dt></dt><dd><span style="color: blue"><i>I'm using <tt>generator-class="increment"</tt> instead of <tt>generator-class="native"</tt> because I <a class="wikipage" href="Wiki.jsp?page=AppFuseOnDB2">found some issues</a> when using "native" on other databases. If you only plan on using MySQL, I <b>recommend you use the "native" value</b>.  This tutorial uses increment.</i></span></dd>
</dl>
<h3 id='section-CreateDAO-CreateANewDatabaseTableFromTheObjectUsingAnt2'>Create a new database table from the object using Ant <a class="footnote" name="ref-CreateDAO-2">[#2]</a></h3>
At this point, you can create the person table by running <b>ant setup-db</b>.  This task creates the <tt>Person.hbm.xml</tt> file and creates a database table called "person".  From the ant console, you can see the table schema the Hibernate creates for you:
<pre>
[schemaexport] create table person (
[schemaexport]    id bigint not null,
[schemaexport]    primary key (id)
[schemaexport] );
</pre>

<p>If you want to look at the <tt>Person.hbm.xml</tt> file that Hibernate generates for you, look in the <tt>build/dao/gen/**/model</tt> directory.  Here's the contents of <tt>Person.hbm.xml</tt> (so far):
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#000000">&lt;?xml&nbsp;version=</font><font color="#2a00ff">&#34;1.0&#34;&nbsp;</font><font color="#000000">encoding=</font><font color="#2a00ff">&#34;UTF-8&#34;</font><font color="#000000">?&gt;</font><br/>
<font color="#000000">&lt;!DOCTYPE&nbsp;hibernate-mapping&nbsp;PUBLIC</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#2a00ff">&#34;-//Hibernate/Hibernate&nbsp;Mapping&nbsp;DTD&nbsp;3.0//EN&#34;&nbsp;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#2a00ff">&#34;http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd&#34;</font><font color="#000000">&gt;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#000000">&lt;hibernate-mapping&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;</font><font color="#7f0055"><b>class</b></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">name=</font><font color="#2a00ff">&#34;org.appfuse.model.Person&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">table=</font><font color="#2a00ff">&#34;person&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">dynamic-update=</font><font color="#2a00ff">&#34;false&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">dynamic-insert=</font><font color="#2a00ff">&#34;false&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&gt;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;id</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">name=</font><font color="#2a00ff">&#34;id&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">column=</font><font color="#2a00ff">&#34;id&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">type=</font><font color="#2a00ff">&#34;java.lang.Long&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">unsaved-value=</font><font color="#2a00ff">&#34;null&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;generator&nbsp;</font><font color="#7f0055"><b>class</b></font><font color="#000000">=</font><font color="#2a00ff">&#34;increment&#34;</font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/generator&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/id&gt;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;!--</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">To&nbsp;add&nbsp;non&nbsp;XDoclet&nbsp;property&nbsp;mappings,&nbsp;create&nbsp;a&nbsp;file&nbsp;named</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">hibernate-properties-Person.xml</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">containing&nbsp;the&nbsp;additional&nbsp;properties&nbsp;and&nbsp;place&nbsp;it&nbsp;in&nbsp;your&nbsp;merge&nbsp;dir.</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">--&gt;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/</font><font color="#7f0055"><b>class</b></font><font color="#000000">&gt;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#000000">&lt;/hibernate-mapping&gt;</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>Now you'll add additional <a class="external" href="http://xdoclet.sourceforge.net/tags/hibernate-tags.html#@hibernate.property%20(0..1)">@hibernate.property</a><img class="outlink" src="images/out.png" alt="" /> tags for the other columns (first_name, last_name):
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">/**</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*&nbsp;@hibernate.property&nbsp;column=&#34;first_name&#34;&nbsp;length=&#34;50&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*/</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#000000">String&nbsp;getFirstName</font><font color="#000000">()&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>return&nbsp;this</b></font><font color="#000000">.firstName;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">/**</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*&nbsp;@hibernate.property&nbsp;column=&#34;last_name&#34;&nbsp;length=&#34;50&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*/</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#000000">String&nbsp;getLastName</font><font color="#000000">()&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>return&nbsp;this</b></font><font color="#000000">.lastName;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>In this example, the only reason for adding the <i>column</i> attribute is because the column name is different from the property name.  If they're the same, you don't need to specify the <i>column</i> attribute. See the <a class="external" href="http://xdoclet.sourceforge.net/tags/hibernate-tags.html#@hibernate.property%20(0..1)">@hibernate.property</a><img class="outlink" src="images/out.png" alt="" /> reference for other attributes you can specify for this tag. 
</p>
<p>Run <b>ant setup-db</b> again to get the additional columns added to your table.
</p>
<pre>[schemaexport] create table person (
[schemaexport]    id bigint not null,
[schemaexport]    first_name varchar(50),
[schemaexport]    last_name varchar(50),
[schemaexport]    primary key (id)
[schemaexport] );</pre>

<p>If you want to change the size of your columns, modify the <i>length</i> attribute in your @hibernate.property tag.  If you want to make it a required field (NOT NULL), add not-null="true".
</p>
<h3 id='section-CreateDAO-CreateANewDaoTestToRunJUnitTestsOnYourDAO3'>Create a new DaoTest to run JUnit tests on your DAO <a class="footnote" name="ref-CreateDAO-3">[#3]</a></h3>
<span class="note"><a name="appgen"></a><b>NOTE:</b> AppFuse versions 1.6.1+ contain include an <a class="wikipage" href="Wiki.jsp?page=AppGen">AppGen</a> tool that can be used to generate all the classes for the rest of these tutorials.  However, it's best that you go through these tutorials before using this tool - then you'll know what code it's generating.</span>
<p>Now you'll create a DaoTest to test that your DAO works.  "Wait a minute," you say, "I haven't created a DAO!"  You are correct.  However, I've found that <a class="external" href="http://www.artima.com/intv/testdriven.html">Test-Driven Development</a><img class="outlink" src="images/out.png" alt="" /> breeds higher quality software.  For years, I thought <b>write your test before your class</b> was hogwash.  It just seemed stupid.  Then I tried it and I found that it works great.  The only reason I do all this test-driven stuff now is because I've found it rapidly speeds up the process of software development.
</p>
<p>To start, create a <tt>PersonDaoTest.java</tt> class in the <tt>test/dao/**/dao</tt> directory.  This class should extend <a class="external" href="http://raibledesigns.com/downloads/appfuse/api/org/appfuse/dao/BaseDaoTestCase.java.html">BaseDaoTestCase</a><img class="outlink" src="images/out.png" alt="" />, a subclass of Spring's <a class="external" href="http://www.springframework.org/docs/api/org/springframework/test/AbstractTransactionalDataSourceSpringContextTests.html">AbstractTransactionalDataSourceSpringContextTests</a><img class="outlink" src="images/out.png" alt="" /> which already exists in this package.  This parent class is used to load <a class="external" href="http://www.springframework.org">Spring's</a><img class="outlink" src="images/out.png" alt="" /> ApplicationContext (since Spring binds the layers together), and for (optionally) loading a .properties file (ResourceBundle) that has the same name as your <tt>*Test.class</tt>.  In this example, if you put a <tt>PersonDaoTest.properties</tt> file in the same directory as <tt>PersonDaoTest.java</tt>, this file's properties will be available via an "rb" variable.
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#7f0055"><b>package&nbsp;</b></font><font color="#000000">org.appfuse.dao;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">org.appfuse.model.Person;</font><br/>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">org.springframework.dao.DataAccessException;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#7f0055"><b>public&nbsp;class&nbsp;</b></font><font color="#000000">PersonDaoTest&nbsp;</font><font color="#7f0055"><b>extends&nbsp;</b></font><font color="#000000">BaseDaoTestCase&nbsp;</font><font color="#000000">{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>private&nbsp;</b></font><font color="#000000">Person&nbsp;person&nbsp;=&nbsp;</font><font color="#7f0055"><b>null</b></font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>private&nbsp;</b></font><font color="#000000">PersonDao&nbsp;dao&nbsp;=&nbsp;</font><font color="#7f0055"><b>null</b></font><font color="#000000">;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">setPersonDao</font><font color="#000000">(</font><font color="#000000">PersonDao&nbsp;dao</font><font color="#000000">)&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>this</b></font><font color="#000000">.dao&nbsp;=&nbsp;dao;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#000000">}</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>The code you see above is what you need for a basic Spring integration test that initializes and configures an implementation of PersonDao. Spring will use autowiring byType to call the <i>setPersonDao()</i> method and set the "personDao" bean as a dependency of this class.
</p>
<p>Now you need test that the CRUD (create, retrieve, update, delete) methods work in your DAO.  To do this, create methods that begin with "test" (all lower case).  As long as these methods are public, have a <tt>void</tt> return type and take no arguments, they will be called by the &lt;junit&gt; task in build.xml. Below are some simple tests for testing CRUD.  An important thing to remember is that each method (also known as a test), should be autonomous. Add the following methods to your <tt>PersonDaoTest.java</tt> file:
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">testGetPerson</font><font color="#000000">()&nbsp;</font><font color="#7f0055"><b>throws&nbsp;</b></font><font color="#000000">Exception&nbsp;</font><font color="#000000">{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">person&nbsp;=&nbsp;</font><font color="#7f0055"><b>new&nbsp;</b></font><font color="#000000">Person</font><font color="#000000">()</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">person.setFirstName</font><font color="#000000">(</font><font color="#2a00ff">&#34;Matt&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">person.setLastName</font><font color="#000000">(</font><font color="#2a00ff">&#34;Raible&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">dao.savePerson</font><font color="#000000">(</font><font color="#000000">person</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">assertNotNull</font><font color="#000000">(</font><font color="#000000">person.getId</font><font color="#000000">())</font><font color="#000000">;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">person&nbsp;=&nbsp;dao.getPerson</font><font color="#000000">(</font><font color="#000000">person.getId</font><font color="#000000">())</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">assertEquals</font><font color="#000000">(</font><font color="#000000">person.getFirstName</font><font color="#000000">()</font><font color="#000000">,&nbsp;</font><font color="#2a00ff">&#34;Matt&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">testSavePerson</font><font color="#000000">()&nbsp;</font><font color="#7f0055"><b>throws&nbsp;</b></font><font color="#000000">Exception&nbsp;</font><font color="#000000">{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">person&nbsp;=&nbsp;dao.getPerson</font><font color="#000000">(</font><font color="#7f0055"><b>new&nbsp;</b></font><font color="#000000">Long</font><font color="#000000">(</font><font color="#990000">1</font><font color="#000000">))</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">person.setFirstName</font><font color="#000000">(</font><font color="#2a00ff">&#34;Matt&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">person.setLastName</font><font color="#000000">(</font><font color="#2a00ff">&#34;Last&nbsp;Name&nbsp;Updated&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">dao.savePerson</font><font color="#000000">(</font><font color="#000000">person</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>if&nbsp;</b></font><font color="#000000">(</font><font color="#000000">log.isDebugEnabled</font><font color="#000000">())&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">log.debug</font><font color="#000000">(</font><font color="#2a00ff">&#34;updated&nbsp;Person:&nbsp;&#34;&nbsp;</font><font color="#000000">+&nbsp;person</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">assertEquals</font><font color="#000000">(</font><font color="#000000">person.getLastName</font><font color="#000000">()</font><font color="#000000">,&nbsp;</font><font color="#2a00ff">&#34;Last&nbsp;Name&nbsp;Updated&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">testAddAndRemovePerson</font><font color="#000000">()&nbsp;</font><font color="#7f0055"><b>throws&nbsp;</b></font><font color="#000000">Exception&nbsp;</font><font color="#000000">{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">person&nbsp;=&nbsp;</font><font color="#7f0055"><b>new&nbsp;</b></font><font color="#000000">Person</font><font color="#000000">()</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">person.setFirstName</font><font color="#000000">(</font><font color="#2a00ff">&#34;Bill&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">person.setLastName</font><font color="#000000">(</font><font color="#2a00ff">&#34;Joy&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">dao.savePerson</font><font color="#000000">(</font><font color="#000000">person</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">assertEquals</font><font color="#000000">(</font><font color="#000000">person.getFirstName</font><font color="#000000">()</font><font color="#000000">,&nbsp;</font><font color="#2a00ff">&#34;Bill&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">assertNotNull</font><font color="#000000">(</font><font color="#000000">person.getId</font><font color="#000000">())</font><font color="#000000">;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>if&nbsp;</b></font><font color="#000000">(</font><font color="#000000">log.isDebugEnabled</font><font color="#000000">())&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">log.debug</font><font color="#000000">(</font><font color="#2a00ff">&#34;removing&nbsp;person...&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">dao.removePerson</font><font color="#000000">(</font><font color="#000000">person.getId</font><font color="#000000">())</font><font color="#000000">;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>try&nbsp;</b></font><font color="#000000">{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">person&nbsp;=&nbsp;dao.getPerson</font><font color="#000000">(</font><font color="#000000">person.getId</font><font color="#000000">())</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">fail</font><font color="#000000">(</font><font color="#2a00ff">&#34;Person&nbsp;found&nbsp;in&nbsp;database&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}&nbsp;</font><font color="#7f0055"><b>catch&nbsp;</b></font><font color="#000000">(</font><font color="#000000">DataAccessException&nbsp;dae</font><font color="#000000">)&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">log.debug</font><font color="#000000">(</font><font color="#2a00ff">&#34;Expected&nbsp;exception:&nbsp;&#34;&nbsp;</font><font color="#000000">+&nbsp;dae.getMessage</font><font color="#000000">())</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">assertNotNull</font><font color="#000000">(</font><font color="#000000">dae</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<dl>
<dt></dt><dd><span style="color: blue"><i>In the testGetPerson method, you're creating a person and then calling a get.  I usually enter a record in the database that I can always rely on. Since <a class="external" href="http://www.dbunit.org">DBUnit</a><img class="outlink" src="images/out.png" alt="" /> is used to populate the database with test data before the tests are run, you can simply add the new table/record to the metadata/sql/sample-data.xml file:</i></span></dd>
</dl>
<p><div style="color: blue !important; margin-left: 50px">
</p>
<pre>
&lt;table name='person'&gt;
    &lt;column&gt;id&lt;/column&gt;
    &lt;column&gt;first_name&lt;/column&gt;
    &lt;column&gt;last_name&lt;/column&gt;
    &lt;row&gt;
      &lt;value&gt;1&lt;/value&gt;
      &lt;value&gt;Matt&lt;/value&gt;
      &lt;value&gt;Raible&lt;/value&gt;
    &lt;/row&gt;
&lt;/table&gt;
</pre>

</div>
<dl>
<dt></dt><dd><span style="color: blue"><i>This way, you can eliminate the "create new" functionality in the testGetPerson method. If you'd rather add this record directly into the database (via SQL or a GUI), you can rebuild your <tt>sample-data.xml</tt> file using <b>ant db-export</b> and then <b>cp <tt>db-export.xml metadata/sql/sample-data.xml</tt></b>.</i></span></dd>
</dl>
<p>In the above example, you can see that person.set*(value) is being called to populate the Person object before saving it.  This is easy in this example, but it could get quite cumbersome if you're persisting an object with 10 required fields (not-null="true").  This is why I created the ResourceBundle in the BaseDaoTestCase.  Simply create a <tt>PersonDaoTest.properties</tt> file in the same directory as <tt>PersonDaoTest.java</tt> and define your property values inside it:
</p>
<dl>
<dt></dt><dd><span style="color: blue"><i>I tend to just hard-code test values into Java code - but the .properties file is an option that works great for large objects.</i></span></dd>
</dl>
<pre>
firstName=Matt
lastName=Raible
</pre>

Then, rather than calling person.set* to populate your objects, you can use the BaseDaoTestCase.populate(java.lang.Object) method:
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#000000">person&nbsp;=&nbsp;</font><font color="#7f0055"><b>new&nbsp;</b></font><font color="#000000">Person</font><font color="#000000">()</font><font color="#000000">;</font><br/>
<font color="#000000">person&nbsp;=&nbsp;</font><font color="#000000">(</font><font color="#000000">Person</font><font color="#000000">)&nbsp;</font><font color="#000000">populate</font><font color="#000000">(</font><font color="#000000">person</font><font color="#000000">)</font><font color="#000000">;</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>At this point, the PersonDaoTest class won't compile yet because there is no PersonDao.class in your classpath, you need to create it.  PersonDao.java is an interface, and PersonDaoHibernate.java is the Hibernate implementation of that interface.
<h3 id='section-CreateDAO-CreateANewDAOToPerformCRUDOnTheObject4'>Create a new DAO to perform CRUD on the object <a class="footnote" name="ref-CreateDAO-4">[#4]</a></h3>
First off, create a PersonDao.java interface in the <tt>src/dao/**/dao</tt> directory and specify the basic CRUD methods for any implementation classes.
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#7f0055"><b>package&nbsp;</b></font><font color="#000000">org.appfuse.dao;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">org.appfuse.model.Person;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#7f0055"><b>public&nbsp;interface&nbsp;</b></font><font color="#000000">PersonDao&nbsp;</font><font color="#7f0055"><b>extends&nbsp;</b></font><font color="#000000">Dao&nbsp;</font><font color="#000000">{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#000000">Person&nbsp;getPerson</font><font color="#000000">(</font><font color="#000000">Long&nbsp;personId</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">savePerson</font><font color="#000000">(</font><font color="#000000">Person&nbsp;person</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">removePerson</font><font color="#000000">(</font><font color="#000000">Long&nbsp;personId</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#000000">}</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>Notice in the class above there are no exceptions on the method signatures.  This is due to the power of <a class="external" href="http://www.springframework.org">Spring</a><img class="outlink" src="images/out.png" alt="" /> and how it wraps Exceptions with RuntimeExceptions. At this point, you should be able to compile all the source in <tt>src/dao</tt> and <tt>test/dao</tt> using <b>ant compile-dao</b>.  However, if you try to run <b>ant test-dao -Dtestcase=PersonDao</b>, you will get an error: <span style="color: red">No bean named 'personDao' is defined</span>.  This is an error message from Spring - indicating that you need to specify a bean named <i>personDao</i> in <tt>applicationContext-hibernate.xml</tt>.  Before you do that, you need to create the PersonDao implementation class.
</p>
<dl>
<dt></dt><dd><i>The ant task for running dao tests is called <b>test-dao</b>.  If you pass in a testcase parameter (using <b>-Dtestcase=name</b>), it will look for <tt>**/*${testcase}*</tt> - allowing us to pass in Person, PersonDao, or PersonDaoTest - all of which will execute the PersonDaoTest class.</i></dd>
</dl>
<p>Let's start by creating a PersonDaoHibernate class that implements the methods in PersonDao and uses Hibernate to get/save/delete the Person object.  To do this, create a new class in <tt>src/dao/**/dao/hibernate</tt> and name it <tt>PersonDaoHibernate.java</tt>.  It should extend <a class="external" href="http://raibledesigns.com/downloads/appfuse/api/org/appfuse/dao/hibernate/BaseDaoHibernate.java.html">BaseDaoHibernate</a><img class="outlink" src="images/out.png" alt="" /> and implement PersonDao.  <i>Javadocs eliminated for brevity.</i>
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#7f0055"><b>package&nbsp;</b></font><font color="#000000">org.appfuse.dao.hibernate;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">org.appfuse.model.Person;</font><br/>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">org.appfuse.dao.PersonDao;</font><br/>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">org.springframework.orm.ObjectRetrievalFailureException;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#7f0055"><b>public&nbsp;class&nbsp;</b></font><font color="#000000">PersonDaoHibernate&nbsp;</font><font color="#7f0055"><b>extends&nbsp;</b></font><font color="#000000">BaseDaoHibernate&nbsp;</font><font color="#7f0055"><b>implements&nbsp;</b></font><font color="#000000">PersonDao&nbsp;</font><font color="#000000">{</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#000000">Person&nbsp;getPerson</font><font color="#000000">(</font><font color="#000000">Long&nbsp;id</font><font color="#000000">)&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">Person&nbsp;person&nbsp;=&nbsp;</font><font color="#000000">(</font><font color="#000000">Person</font><font color="#000000">)&nbsp;</font><font color="#000000">getHibernateTemplate</font><font color="#000000">()</font><font color="#000000">.get</font><font color="#000000">(</font><font color="#000000">Person.class,&nbsp;id</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>if&nbsp;</b></font><font color="#000000">(</font><font color="#000000">person&nbsp;==&nbsp;</font><font color="#7f0055"><b>null</b></font><font color="#000000">)&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>throw&nbsp;new&nbsp;</b></font><font color="#000000">ObjectRetrievalFailureException</font><font color="#000000">(</font><font color="#000000">Person.class,&nbsp;id</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>return&nbsp;</b></font><font color="#000000">person;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">savePerson</font><font color="#000000">(</font><font color="#000000">Person&nbsp;person</font><font color="#000000">)&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">getHibernateTemplate</font><font color="#000000">()</font><font color="#000000">.saveOrUpdate</font><font color="#000000">(</font><font color="#000000">person</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">removePerson</font><font color="#000000">(</font><font color="#000000">Long&nbsp;id</font><font color="#000000">)&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f7f5f">//&nbsp;object&nbsp;must&nbsp;be&nbsp;loaded&nbsp;before&nbsp;it&nbsp;can&nbsp;be&nbsp;deleted</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">getHibernateTemplate</font><font color="#000000">()</font><font color="#000000">.delete</font><font color="#000000">(</font><font color="#000000">getPerson</font><font color="#000000">(</font><font color="#000000">id</font><font color="#000000">))</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#000000">}</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>Now, if you try to run <b>ant test-dao -Dtestcase=PersonDao</b>, you will get the same error.  We need to configure Spring so it knows that PersonDaoHibernate is the implementation of PersonDao, and you also need to tell it about the Person object. 
</p>
<h3 id='section-CreateDAO-ConfigureSpringForThePersonObjectAndPersonDao5'>Configure Spring for the Person object and PersonDao <a class="footnote" name="ref-CreateDAO-5">[#5]</a></h3>
<p>First, you need to tell Spring where the Hibernate mapping file is located.  To do this, open <tt>src/dao/**/dao/hibernate/applicationContext-hibernate.xml</tt> and add <tt>"Person.hbm.xml"</tt> to the following code block.
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#000000">&lt;property&nbsp;name=</font><font color="#2a00ff">&#34;mappingResources&#34;</font><font color="#000000">&gt;&nbsp;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;list&gt;&nbsp;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;value&gt;org/appfuse/model/Person.hbm.xml&lt;/value&gt;&nbsp;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;value&gt;org/appfuse/model/Role.hbm.xml&lt;/value&gt;&nbsp;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;value&gt;org/appfuse/model/User.hbm.xml&lt;/value&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/list&gt;&nbsp;</font><br/>
<font color="#000000">&lt;/property&gt;&nbsp;</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>Now you need to add some XML to this file to bind PersonDaoHibernate to PersonDao.  To do this, add the following at the bottom of the file:
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#000000">&lt;!--&nbsp;PersonDao:&nbsp;Hibernate&nbsp;implementation&nbsp;--&gt;&nbsp;</font><br/>
<font color="#000000">&lt;bean&nbsp;id=</font><font color="#2a00ff">&#34;personDao&#34;&nbsp;</font><font color="#7f0055"><b>class</b></font><font color="#000000">=</font><font color="#2a00ff">&#34;org.appfuse.dao.hibernate.PersonDaoHibernate&#34;</font><font color="#000000">&gt;&nbsp;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;property&nbsp;name=</font><font color="#2a00ff">&#34;sessionFactory&#34;&nbsp;</font><font color="#000000">ref=</font><font color="#2a00ff">&#34;sessionFactory&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#000000">&lt;/bean&gt;&nbsp;</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<span class="note"><b>NOTE:</b> Don't forget to correct the package name in the "class" attribute above if you specified a package other then org.appfuse when you created your project.</span>
<h3 id='section-CreateDAO-RunTheDaoTest6'>Run the DaoTest <a class="footnote" name="ref-CreateDAO-6">[#6]</a></h3>
Save all your edited files and try running <b>ant test-dao -Dtestcase=PersonDao</b> one more time.  
<p><b>Yeah Baby, Yeah:</b>
<span style="color:green">BUILD SUCCESSFUL<br />
Total time: 9 seconds</span>
</p>
<hr />
<p><i>Next Up:</i> <b>Part II:</b> <a class="wikipage" href="Wiki.jsp?page=CreateManager">Creating new Managers</a> - A HowTo for creating Business Facades, which are similar to <a class="external" href="http://java.sun.com/blueprints/patterns/SessionFacade.html">Session Facades</a><img class="outlink" src="images/out.png" alt="" />, but don't use EJBs. These facades are used to provide communication from the front-end to the DAO layer.
</p>
<A NAME="Link_CreateManager">
<h1>CreateManager</h1>
</A>
<b>Part II:</b> <a class="wikipage" href="Wiki.jsp?page=CreateManager">Creating new Managers</a> - A HowTo for creating Business Facades that talk to the database tier (DAOs) and handle transaction management.
<dl>
<dt></dt><dd><i>This tutorial depends on <b>Part I:</b> <a class="wikipage" href="Wiki.jsp?page=CreateDAO">Creating new DAOs and Objects in AppFuse</a>.</i></dd>
</dl>
<h3 id='section-CreateManager-AboutThisTutorial'>About this Tutorial</h3>
This tutorial will show you how to create a Business Facade class (and a JUnit Test) to talk to the <a class="wikipage" href="Wiki.jsp?page=CreateDAO">DAO we created in Part I</a>. 
<p>In the context of <a class="wikipage" href="Wiki.jsp?page=AppFuse">AppFuse</a>, this is called a Manager class.  Its main responsibility is to act as a bridge between the persistence (DAO) layer and the web layer. It's also useful for de-coupling your presentation layer from your database layer (i.e. for Swing apps). Managers should also be where you put any business logic for your application.
</p>
<dl>
<dt></dt><dd><span style="color: blue"><i>I will tell you how I do stuff in the <b>Real World</b> in text like this.</i></span></dd>
</dl>
<p>Let's get started by creating a new ManagerTest and Manager in AppFuse's architecture.
</p>
<h4 id='section-CreateManager-TableOfContents'>Table of Contents</h4>
<ul>
<li> <a class="footnoteref" href="#ref-CreateManager-1">[1]</a> Create a new ManagerTest to run JUnit tests on the Manager
</li>
<li> <a class="footnoteref" href="#ref-CreateManager-2">[2]</a> Create a new Manager to talk to the DAO
</li>
<li> <a class="footnoteref" href="#ref-CreateManager-3">[3]</a> Configure Spring for this Manager and Transactions
</li>
<li> <a class="footnoteref" href="#ref-CreateManager-4">[4]</a> Run the ManagerTest
</li>
</ul>
<h3 id='section-CreateManager-CreateANewManagerTestToRunJUnitTestsOnTheManager1'>Create a new ManagerTest to run JUnit tests on the Manager <a class="footnote" name="ref-CreateManager-1">[#1]</a></h3>
In <a class="wikipage" href="Wiki.jsp?page=CreateDAO">Part I</a>, we created a Person object and PersonDao - so let's continue developing this entity.  First, let's create a JUnit test for the PersonManager.  Create PersonManagerTest in the test/service/**/service directory.  We'll want to test the same basic methods (get, save, remove) that our DAO has.  
<dl>
<dt></dt><dd><i>This may seem redundant (why all the tests!), but these tests are GREAT to have 6 months down the road.</i></dd>
</dl>
<p>This class should extend <a class="external" href="http://raibledesigns.com/downloads/appfuse/api/org/appfuse/service/BaseManagerTestCase.java.html">BaseManagerTestCase</a><img class="outlink" src="images/out.png" alt="" />, which already exists in the <i>service</i> package.  The parent class (BaseManagerTestCase) serves similar functionality as the BaseDaoTestCase.
</p>
<dl>
<dt></dt><dd><span style="color: blue"><i>I usually copy (open &rarr; save as) an existing test (i.e. UserManagerTest.java) and find/replace [Uu]ser with [Pp]erson, or whatever the name of my object is.</i></span></dd>
</dl>
<p>The code below is what you need for a basic JUnit test of your Manager.  Unlike the DaoTest, this test uses <a class="external" href="http://jmock.org">jMock</a><img class="outlink" src="images/out.png" alt="" /> to isolate the Manager from its dependencies and make it a <i>true</i> "unit" test.  This can be very helpful because it allows you to test your business logic w/o worrying about other dependencies.  The code below simply sets up the Manger and its dependencies (as Mocks) for testing. 
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#7f0055"><b>package&nbsp;</b></font><font color="#000000">org.appfuse.service;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">java.util.List;</font><br/>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">java.util.ArrayList;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">org.appfuse.dao.PersonDao;</font><br/>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">org.appfuse.model.Person;</font><br/>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">org.appfuse.service.impl.PersonManagerImpl;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">org.jmock.Mock;</font><br/>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">org.springframework.orm.ObjectRetrievalFailureException;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#7f0055"><b>public&nbsp;class&nbsp;</b></font><font color="#000000">PersonManagerTest&nbsp;</font><font color="#7f0055"><b>extends&nbsp;</b></font><font color="#000000">BaseManagerTestCase&nbsp;</font><font color="#000000">{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>private&nbsp;final&nbsp;</b></font><font color="#000000">String&nbsp;personId&nbsp;=&nbsp;</font><font color="#2a00ff">&#34;1&#34;</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>private&nbsp;</b></font><font color="#000000">PersonManager&nbsp;personManager&nbsp;=&nbsp;</font><font color="#7f0055"><b>new&nbsp;</b></font><font color="#000000">PersonManagerImpl</font><font color="#000000">()</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>private&nbsp;</b></font><font color="#000000">Mock&nbsp;personDao&nbsp;=&nbsp;</font><font color="#7f0055"><b>null</b></font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>private&nbsp;</b></font><font color="#000000">Person&nbsp;person&nbsp;=&nbsp;</font><font color="#7f0055"><b>null</b></font><font color="#000000">;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>protected&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">setUp</font><font color="#000000">()&nbsp;</font><font color="#7f0055"><b>throws&nbsp;</b></font><font color="#000000">Exception&nbsp;</font><font color="#000000">{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>super</b></font><font color="#000000">.setUp</font><font color="#000000">()</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">personDao&nbsp;=&nbsp;</font><font color="#7f0055"><b>new&nbsp;</b></font><font color="#000000">Mock</font><font color="#000000">(</font><font color="#000000">PersonDao.</font><font color="#7f0055"><b>class</b></font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">personManager.setPersonDao</font><font color="#000000">((</font><font color="#000000">PersonDao</font><font color="#000000">)&nbsp;</font><font color="#000000">personDao.proxy</font><font color="#000000">())</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>protected&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">tearDown</font><font color="#000000">()&nbsp;</font><font color="#7f0055"><b>throws&nbsp;</b></font><font color="#000000">Exception&nbsp;</font><font color="#000000">{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>super</b></font><font color="#000000">.tearDown</font><font color="#000000">()</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">personManager&nbsp;=&nbsp;</font><font color="#7f0055"><b>null</b></font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#000000">}</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>Now that you have the skeleton done for this class, you need to add the meat: the test methods to make sure everything works.  Here's a snippet from the <a class="wikipage" href="Wiki.jsp?page=CreateDAO">DAO Tutorial</a> tutorial to help you understand what we're about to do.
</p>
<dl>
<dt></dt><dd><i>...we create methods that begin with "test" (all lower case). As long as these methods are public, have a void return type and take no arguments, they will be called by our &lt;junit&gt; task in our Ant build.xml file. Here's some simple tests for testing CRUD. An important thing to remember is that each method (also known as a test), should be autonomous.</i></dd>
</dl>
<p>Add the following methods to your PersonManagerTest.java file:
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">testGetPerson</font><font color="#000000">()&nbsp;</font><font color="#7f0055"><b>throws&nbsp;</b></font><font color="#000000">Exception&nbsp;</font><font color="#000000">{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f7f5f">//&nbsp;set&nbsp;expected&nbsp;behavior&nbsp;on&nbsp;dao</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">personDao.expects</font><font color="#000000">(</font><font color="#000000">once</font><font color="#000000">())</font><font color="#000000">.method</font><font color="#000000">(</font><font color="#2a00ff">&#34;getPerson&#34;</font><font color="#000000">)</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">.will</font><font color="#000000">(</font><font color="#000000">returnValue</font><font color="#000000">(</font><font color="#7f0055"><b>new&nbsp;</b></font><font color="#000000">Person</font><font color="#000000">()))</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">person&nbsp;=&nbsp;personManager.getPerson</font><font color="#000000">(</font><font color="#000000">personId</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">assertTrue</font><font color="#000000">(</font><font color="#000000">person&nbsp;!=&nbsp;</font><font color="#7f0055"><b>null</b></font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">personDao.verify</font><font color="#000000">()</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">testSavePerson</font><font color="#000000">()&nbsp;</font><font color="#7f0055"><b>throws&nbsp;</b></font><font color="#000000">Exception&nbsp;</font><font color="#000000">{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f7f5f">//&nbsp;set&nbsp;expected&nbsp;behavior&nbsp;on&nbsp;dao</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">personDao.expects</font><font color="#000000">(</font><font color="#000000">once</font><font color="#000000">())</font><font color="#000000">.method</font><font color="#000000">(</font><font color="#2a00ff">&#34;savePerson&#34;</font><font color="#000000">)</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">.with</font><font color="#000000">(</font><font color="#000000">same</font><font color="#000000">(</font><font color="#000000">person</font><font color="#000000">))</font><font color="#000000">.isVoid</font><font color="#000000">()</font><font color="#000000">;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">personManager.savePerson</font><font color="#000000">(</font><font color="#000000">person</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">personDao.verify</font><font color="#000000">()</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}&nbsp;&nbsp;&nbsp;&nbsp;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">testAddAndRemovePerson</font><font color="#000000">()&nbsp;</font><font color="#7f0055"><b>throws&nbsp;</b></font><font color="#000000">Exception&nbsp;</font><font color="#000000">{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">person&nbsp;=&nbsp;</font><font color="#7f0055"><b>new&nbsp;</b></font><font color="#000000">Person</font><font color="#000000">()</font><font color="#000000">;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f7f5f">//&nbsp;set&nbsp;required&nbsp;fields</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">person.setFirstName</font><font color="#000000">(</font><font color="#2a00ff">&#34;firstName&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">person.setLastName</font><font color="#000000">(</font><font color="#2a00ff">&#34;lastName&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f7f5f">//&nbsp;set&nbsp;expected&nbsp;behavior&nbsp;on&nbsp;dao</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">personDao.expects</font><font color="#000000">(</font><font color="#000000">once</font><font color="#000000">())</font><font color="#000000">.method</font><font color="#000000">(</font><font color="#2a00ff">&#34;savePerson&#34;</font><font color="#000000">)</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">.with</font><font color="#000000">(</font><font color="#000000">same</font><font color="#000000">(</font><font color="#000000">person</font><font color="#000000">))</font><font color="#000000">.isVoid</font><font color="#000000">()</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">personManager.savePerson</font><font color="#000000">(</font><font color="#000000">person</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">personDao.verify</font><font color="#000000">()</font><font color="#000000">;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f7f5f">//&nbsp;reset&nbsp;expectations</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">personDao.reset</font><font color="#000000">()</font><font color="#000000">;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">personDao.expects</font><font color="#000000">(</font><font color="#000000">once</font><font color="#000000">())</font><font color="#000000">.method</font><font color="#000000">(</font><font color="#2a00ff">&#34;removePerson&#34;</font><font color="#000000">)</font><font color="#000000">.with</font><font color="#000000">(</font><font color="#000000">eq</font><font color="#000000">(</font><font color="#7f0055"><b>new&nbsp;</b></font><font color="#000000">Long</font><font color="#000000">(</font><font color="#000000">personId</font><font color="#000000">)))</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">personManager.removePerson</font><font color="#000000">(</font><font color="#000000">personId</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">personDao.verify</font><font color="#000000">()</font><font color="#000000">;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f7f5f">//&nbsp;reset&nbsp;expectations</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">personDao.reset</font><font color="#000000">()</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f7f5f">//&nbsp;remove</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">Exception&nbsp;ex&nbsp;=&nbsp;</font><font color="#7f0055"><b>new&nbsp;</b></font><font color="#000000">ObjectRetrievalFailureException</font><font color="#000000">(</font><font color="#000000">Person.class,&nbsp;person.getId</font><font color="#000000">())</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">personDao.expects</font><font color="#000000">(</font><font color="#000000">once</font><font color="#000000">())</font><font color="#000000">.method</font><font color="#000000">(</font><font color="#2a00ff">&#34;removePerson&#34;</font><font color="#000000">)</font><font color="#000000">.isVoid</font><font color="#000000">()</font><font color="#000000">;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">personDao.expects</font><font color="#000000">(</font><font color="#000000">once</font><font color="#000000">())</font><font color="#000000">.method</font><font color="#000000">(</font><font color="#2a00ff">&#34;getPerson&#34;</font><font color="#000000">)</font><font color="#000000">.will</font><font color="#000000">(</font><font color="#000000">throwException</font><font color="#000000">(</font><font color="#000000">ex</font><font color="#000000">))</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">personManager.removePerson</font><font color="#000000">(</font><font color="#000000">personId</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>try&nbsp;</b></font><font color="#000000">{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">personManager.getPerson</font><font color="#000000">(</font><font color="#000000">personId</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">fail</font><font color="#000000">(</font><font color="#2a00ff">&#34;Person&nbsp;with&nbsp;identifier&nbsp;'&#34;&nbsp;</font><font color="#000000">+&nbsp;personId&nbsp;+&nbsp;</font><font color="#2a00ff">&#34;'&nbsp;found&nbsp;in&nbsp;database&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}&nbsp;</font><font color="#7f0055"><b>catch&nbsp;</b></font><font color="#000000">(</font><font color="#000000">ObjectRetrievalFailureException&nbsp;e</font><font color="#000000">)&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">assertNotNull</font><font color="#000000">(</font><font color="#000000">e.getMessage</font><font color="#000000">())</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">personDao.verify</font><font color="#000000">()</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>This class won't compile at this point because we have not created our PersonManager interface.
</p>
<dl>
<dt></dt><dd><span style="color: blue"><i>I think it's funny how I've followed so many patterns to allow <b>extendibility</b> in AppFuse.  In reality, on most projects I've been on - I learn so much in a year that I don't want to extend the architecture - I want to rewrite it.  Hopefully by keeping AppFuse up to date with my perceived best practices, this won't happen as much.  Each year will just be an upgrade to the latest AppFuse, rather than a re-write. ;-)</i></dd>
</dl>
<h3 id='section-CreateManager-CreateANewManagerToTalkToTheDAO2'>Create a new Manager to talk to the DAO <a class="footnote" name="ref-CreateManager-2">[#2]</a></h3>
<p>First off, create a PersonManager.java interface in the src/service/**/service directory and specify the basic CRUD methods for any implementation classes. <i>I've eliminated the JavaDocs in the class below for display purposes.</i>  The <i>setPersonDao()</i> method is not used in most cases - its just exists so the PersonManagerTest can set the DAO on the interface.
</p>
<dl>
<dt></dt><dd><span style="color: blue"><i>As usual, I usually duplicate (open &rarr; save as) an existing file (i.e. UserManager.java).</i></span></dd>
</dl>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#7f0055"><b>package&nbsp;</b></font><font color="#000000">org.appfuse.service;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">org.appfuse.model.Person;</font><br/>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">org.appfuse.dao.PersonDao;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#7f0055"><b>public&nbsp;interface&nbsp;</b></font><font color="#000000">PersonManager&nbsp;</font><font color="#000000">{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">setPersonDao</font><font color="#000000">(</font><font color="#000000">PersonDao&nbsp;dao</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#000000">Person&nbsp;getPerson</font><font color="#000000">(</font><font color="#000000">String&nbsp;id</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">savePerson</font><font color="#000000">(</font><font color="#000000">Person&nbsp;person</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">removePerson</font><font color="#000000">(</font><font color="#000000">String&nbsp;id</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#000000">}</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>Now let's create a PersonManagerImpl class that implements the methods in PersonManager. To do this, create a new class in src/service/**/service/impl and name it PersonManagerImpl.java. It should extend BaseManager and implement PersonManager.
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#7f0055"><b>package&nbsp;</b></font><font color="#000000">org.appfuse.service.impl;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">org.appfuse.model.Person;</font><br/>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">org.appfuse.dao.PersonDao;</font><br/>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">org.appfuse.service.PersonManager;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#7f0055"><b>public&nbsp;class&nbsp;</b></font><font color="#000000">PersonManagerImpl&nbsp;</font><font color="#7f0055"><b>extends&nbsp;</b></font><font color="#000000">BaseManager&nbsp;</font><font color="#7f0055"><b>implements&nbsp;</b></font><font color="#000000">PersonManager&nbsp;</font><font color="#000000">{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>private&nbsp;</b></font><font color="#000000">PersonDao&nbsp;dao;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">setPersonDao</font><font color="#000000">(</font><font color="#000000">PersonDao&nbsp;dao</font><font color="#000000">)&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>this</b></font><font color="#000000">.dao&nbsp;=&nbsp;dao;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#000000">Person&nbsp;getPerson</font><font color="#000000">(</font><font color="#000000">String&nbsp;id</font><font color="#000000">)&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>return&nbsp;</b></font><font color="#000000">dao.getPerson</font><font color="#000000">(</font><font color="#000000">Long.valueOf</font><font color="#000000">(</font><font color="#000000">id</font><font color="#000000">))</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">savePerson</font><font color="#000000">(</font><font color="#000000">Person&nbsp;person</font><font color="#000000">)&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">dao.savePerson</font><font color="#000000">(</font><font color="#000000">person</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">removePerson</font><font color="#000000">(</font><font color="#000000">String&nbsp;id</font><font color="#000000">)&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">dao.removePerson</font><font color="#000000">(</font><font color="#000000">Long.valueOf</font><font color="#000000">(</font><font color="#000000">id</font><font color="#000000">))</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#000000">}</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>One thing to note is the <tt>setPersonDao()</tt> method.  This is used by Spring to bind the PersonDao to this Manager.  This is configured in the applicationContext-service.xml file.  We'll get to configuring that in Step 3<a class="footnoteref" href="#ref-CreateManager-3">[3]</a>. You should be able to compile everything now using "ant compile-service".
</p>
<p>Now you need to edit Spring's config file for our services layer so it will know about this new Manager.
</p>
<h3 id='section-CreateManager-ConfigureSpringForThisManagerAndTransactions3'>Configure Spring for this Manager and Transactions <a class="footnote" name="ref-CreateManager-3">[#3]</a></h3>
<p>To notify Spring of this our PersonManager interface and its implementation, open the src/service/**/service/applicationContext-service.xml file.  Add the following to the bottom of this file.
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;bean&nbsp;id=</font><font color="#2a00ff">&#34;personManager&#34;&nbsp;</font><font color="#7f0055"><b>class</b></font><font color="#000000">=</font><font color="#2a00ff">&#34;org.appfuse.service.impl.PersonManagerImpl&#34;</font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;property&nbsp;name=</font><font color="#2a00ff">&#34;personDao&#34;&nbsp;</font><font color="#000000">ref=</font><font color="#2a00ff">&#34;personDao&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/bean&gt;</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>This bean must have a name that ends in "Manager".  This is because there is AOP advice applied at the top of this file for all *Manager beans.
</p>
<pre>&lt;aop:advisor id="managerTx" advice-ref="txAdvice" pointcut="execution(* *..service.*Manager.*(..))" order="2"/&gt;</pre>
 For more information on transactions with Spring, see <a class="external" href="http://www.springframework.org/docs/reference/transaction.html">Spring's documentation</a><img class="outlink" src="images/out.png" alt="" />.
<h3 id='section-CreateManager-RunTheManagerTest4'>Run the ManagerTest <a class="footnote" name="ref-CreateManager-4">[#4]</a></h3>
<p>Save all your edited files and try running <b>ant test-service -Dtestcase=PersonManager</b>.  
</p>
<p><i>Yeah Baby, Yeah:</i>
<span style="color:green">BUILD SUCCESSFUL<br />
Total time: 9 seconds</span>
</p>
<hr />
<p>The files that were modified and added to this point are <a class="external" href="https://appfuse.dev.java.net/files/documents/1397/7484/appfuse-tutorial-managers-1.6.zip">available for download</a><img class="outlink" src="images/out.png" alt="" />.
</p>
<p><i>Next Up:</i> <b>Part III:</b> <a class="wikipage" href="Wiki.jsp?page=CreateActions">Creating Actions and JSPs</a> - A HowTo for creating Actions and JSPs in the AppFuse architecture.
</p>
<A NAME="Link_DevelopmentEnvironment">
<h1>DevelopmentEnvironment</h1>
</A>
This page describes how to setup your development environment to compile/deploy <a class="wikipage" href="Wiki.jsp?page=AppFuse">AppFuse</a> or <a class="wikipage" href="Wiki.jsp?page=StrutsResume">StrutsResume</a> from the command line.  After setting this up, you might want to checkout <a class="wikipage" href="Wiki.jsp?page=AppFuseEclipse">HowTo Run Ant in Eclipse</a>. This is how I currently have things setup and what I advise clients to use when we use AppFuse as a baseline for webapp development.
<h4 id='section-DevelopmentEnvironment-TableOfContents'>Table of Contents</h4>
<ul>
<li> <a class="footnoteref" href="#ref-DevelopmentEnvironment-1">[1]</a> Download - links to download the JDK, J2EE, Tomcat, Ant and MySQL
</li>
<li> <a class="footnoteref" href="#ref-DevelopmentEnvironment-2">[2]</a> Install - detailed instructions on where to extract/install all of the above packages
</li>
<li> <a class="footnoteref" href="#ref-DevelopmentEnvironment-3">[3]</a> Configure - how to configure your environment variables
</li>
<li> <a class="footnoteref" href="#ref-DevelopmentEnvironment-4">[4]</a> Additional Tips - other tools I recommend using
</li>
</ul>
<h3 id='section-DevelopmentEnvironment-Download1'>Download <a class="footnote" name="ref-DevelopmentEnvironment-1">[#1]</a></h3>
<ol>
<li> Download the latest JDK (J2SE SDK) from <a class="external" href="http://java.sun.com">http://java.sun.com</a><img class="outlink" src="images/out.png" alt="" />.  As of 07/12/2005, this is <a class="external" href="http://javashoplm.sun.com/ECom/docs/Welcome.jsp?StoreId=22&amp;amp;PartDetailId=j2sdk-1.4.2_08-oth-JPR&amp;amp;SiteId=JSC&amp;TransactionId=noreg">1.4.2_08</a><img class="outlink" src="images/out.png" alt="" />.  AppFuse should work with 1.5 if you'd like to use that.  Here's <a class="external" href="http://raibledesigns.com/page/rd?anchor=playing_with_jdk_5_0">my experience</a><img class="outlink" src="images/out.png" alt="" />.  Note that Cactus has been removed from AppFuse in 1.6 and Cargo (used for testing JSPs) doesn't work with Tomcat 5.5.x yet.
</li>
<li> Download the <a class="external" href="http://jakarta.apache.org/site/binindex.cgi">latest Tomcat release</a><img class="outlink" src="images/out.png" alt="" /> from <a class="external" href="http://jakarta.apache.org/tomcat">http://jakarta.apache.org/tomcat</a><img class="outlink" src="images/out.png" alt="" />.  At the time of this writing, it's <a class="external" href="http://www.apache.org/dist/jakarta/tomcat-5/v5.0.28/">5.0.28</a><img class="outlink" src="images/out.png" alt="" />.  <b>DON'T</b> get the LE version or you'll have to add DBCP (database connection pool) and JavaMail (for e-mail) JARs.
</li>
<li> Download the <a class="external" href="http://ant.apache.org/bindownload.cgi">latest Ant release</a><img class="outlink" src="images/out.png" alt="" /> from <a class="external" href="http://ant.apache.org">http://ant.apache.org</a><img class="outlink" src="images/out.png" alt="" />.  AppFuse 1.6+ requires 1.6.2 or greater.
</li>
<li> Download the <a class="external" href="http://dev.mysql.com/downloads/mysql/4.0.html">latest MySQL release</a><img class="outlink" src="images/out.png" alt="" /> from <a class="external" href="http://www.mysql.com">http://www.mysql.com</a><img class="outlink" src="images/out.png" alt="" />.  Currently, this is 4.0.21.
</li>
</ol>
<p>I usually put all these downloads in a "Downloads" folder - in fact, I plan on starting to pack around a CD with all of these libraries on them - nice to have when traveling to new clients and networks are slow.
</p>
<h3 id='section-DevelopmentEnvironment-Install2'>Install <a class="footnote" name="ref-DevelopmentEnvironment-2">[#2]</a></h3>
Make sure you have <a class="external" href="http://winzip.com">WinZip</a><img class="outlink" src="images/out.png" alt="" /> installed (for Windows) or gnutar for OS X before installing these packages.
<ol>
<li> Create a "Tools" and "SDKs" folder on your hard drive.  On Windows, I create these at c:\Tools and c:\SDKs.  On *nix, I usually do /opt/dev/tools and opt/dev/sdks.  
</li>
<li> Create Environment variables for these folders - SDKS_HOME and TOOLS_HOME (optional)
</li>
<li> Install the J2SE SDK (a.k.a. JDK) in the SDKs directory - keeping the directory names intact.
</li>
<li> Install Tomcat in the Tools directory - I usually name the install directory "jakarta-tomcat-x" where x is the current version (i.e. 5.0.28).
</li>
<li> Unzip/Install Ant in the Tools directory - "apache-ant-x" is what I use for the directory name.
</li>
<li> Install MySQL in the Tools directory.  I usually just leave it named "mysql".
</li>
<li> Create a "Source" directory on your hard drive (this is where we'll put all the source code for our projects). On *nix, I usually create a "dev" folder in my home directory.
</li>
</ol>
<p>At this point, you should have a directory structure that looks something like the following:
</p>
<pre>SDKs -
    - j2sdk-1.4.2_05
Tools - 
    - apache-ant-1.6.2
    - jakarta-tomcat-5.0.28
    - mysql
Source</pre>

<p>Now we'll configure all these tools so that your Operating System knows they're installed.
</p>
<h3 id='section-DevelopmentEnvironment-Configure3'>Configure <a class="footnote" name="ref-DevelopmentEnvironment-3">[#3]</a></h3>
<p>I'll only show a Windows example and I'll assume the *nix folks are smart enough to figure it out for their system.
</p>
<ol>
<li> To set Environment Variables in Windows, either go to Control Panel -&gt; System or right-click My Computer -&gt; Properties.
</li>
<li> Click on the <b>Advanced</b> Tab and then click the <b>Environment Variables</b> button.
</li>
<li> Put focus on the second box (System Variables) by clicking on one of the existing values.
</li>
<li> Enter the following variables:
<ul>
<li> HOME = c:\Source
</li>
<li> SDKS_HOME = c:\SDKs
</li>
<li> TOOLS_HOME = c:\Tools
</li>
<li> JAVA_HOME = %SDKS_HOME%\j2sdk-1.4.2_05
</li>
<li> ANT_HOME = %TOOLS_HOME%\apache-ant-1.6.2
</li>
<li> CATALINA_HOME = %TOOLS_HOME%\jakarta-tomcat-5.0.28
</li>
<li> MYSQL_HOME = %TOOLS_HOME%\mysql
</li>
<li> Append to the PATH variable: %JAVA_HOME%\bin;%ANT_HOME%\bin;%CATALINA_HOME%\bin;%MYSQL_HOME%\bin
</li>
</ul>
</li>
</ol>
<p>You should now be able to open a command prompt and type "java -version", "ant -version" or "mysql" and not get errors.
</p>
<h3 id='section-DevelopmentEnvironment-AdditionalTips4'>Additional Tips <a class="footnote" name="ref-DevelopmentEnvironment-4">[#4]</a></h3>
<ul>
<li> I use <a class="external" href="http://www.cygwin.com">Cygwin</a><img class="outlink" src="images/out.png" alt="" /> on Windows for running Ant and doing all command line things.  I install it in %TOOLS_HOME%\cygwin. In my %HOME%\.profile file, I have the following items that might be useful:
</li>
</ul>
<pre style="margin-left: 40px">alias ls="ls -CF --color"
alias ll='ls -la'
alias tstart=$CATALINA_HOME/bin/startup.bat
alias tstop=$CATALINA_HOME/bin/shutdown.bat</pre>
<ul>
<li> I use <a class="external" href="http://www.eclipse.org">Eclipse</a><img class="outlink" src="images/out.png" alt="" /> on Windows for editing .java files.  I install it in %TOOLS_HOME%\eclipse. I still use Ant to build and deploy, but the CVS versions of AppFuse and StrutsResume does contain the .classpath and .project files for Eclipse.  Additionally, AppFuse has project files for <a class="external" href="http://www.intellij.com">Intellij's IDEA</a><img class="outlink" src="images/out.png" alt="" /> (version 4.5+).  To see how you can run Ant in Eclipse, check out my <a class="wikipage" href="Wiki.jsp?page=AppFuseEclipse">AppFuse with Eclipse HowTo</a>.
</li>
</ul>
<p>If you're starting work at a new client, I also recommend you do the following to help your development process become more efficient.  Most of my clients in the last couple years have not had these in place, that's why I recommend them here.
</p>
<ol>
<li> Setup a source control system.  I prefer <a href="http://cvshome.org">CVS</a> because I'm most familiar with it.  A nice addon is <a class="external" href="http://www.badgers-in-foil.co.uk/projects/cvsspam/">CVS Spam</a><img class="outlink" src="images/out.png" alt="" /> for HTML-formatted check-in notifications.
</li>
<li> Setup a bug tracking system.  Popular (free) choices are <a class="external" href="http://www.bugzilla.org/">Bugzilla</a><img class="outlink" src="images/out.png" alt="" /> and <a class="external" href="http://scarab.tigris.org/">Scarab</a><img class="outlink" src="images/out.png" alt="" />.  The best one I've seen is <a class="external" href="http://www.atlassian.com/software/jira/">JIRA</a><img class="outlink" src="images/out.png" alt="" /> (<a class="external" href="http://jira.atlassian.com/secure/Dashboard.jspa">demo</a><img class="outlink" src="images/out.png" alt="" />), but I've yet to convince a client to shell out the $800 for it.
</li>
<li> Setup a Wiki.  My favorite is <a class="external" href="http://www.jspwiki.org">JSPWiki</a><img class="outlink" src="images/out.png" alt="" /> - which is what this site uses.  You can also <a class="external" href="http://www.raibledesigns.com/wiki/templates/redman.tar.gz">download this template</a><img class="outlink" src="images/out.png" alt="" /> if you like.
</li>
<li> Setup a development box to host the source control system, the bug tracking system, and a wiki.  Install Tomcat on this box and <a class="external" href="http://www.urbancode.com/projects/anthill/default.jsp">Anthill</a><img class="outlink" src="images/out.png" alt="" /> for automated testing (I run both AppFuse and Struts-Resume on Anthill at home).
</li>
<li> (optional) Install <a class="external" href="http://rollerweblogger.org/page/project">Roller</a><img class="outlink" src="images/out.png" alt="" /> and use it to report your daily status and issues.  This will allow your client (or supervisor) to track your progress.
</li>
</ol>
<A NAME="Link_HibernateRelationships">
<h1>HibernateRelationships</h1>
</A>
<h3 id='section-HibernateRelationships-AboutThisTutorial'>About this tutorial</h3>
This is a tutorial to show how to create and manage Hibernate relationships within <a class="wikipage" href="Wiki.jsp?page=AppFuse">AppFuse</a>.  This tutorial was written using AppFuse 1.8.2. All of the code for this tutorial is downloadable at <a class="external" href="http://static.appfuse.org/downloads/appfuse-hr.zip">http://static.appfuse.org/downloads/appfuse-hr.zip</a><img class="outlink" src="images/out.png" alt="" />.
<dl>
<dt></dt><dd><i>For further details about the specifics regarding creating objects, XDoclet tags for Hibernate, DAO development, etc., please refer to <a class="wikipage" href="Wiki.jsp?page=CreateDAO">Creating new DAOs and Objects in AppFuse</a>.</i> </dd>
</dl>
<span class="note"><b>NOTE:</b> Copying the Java code in this tutorials <a class="external" href="http://raibledesigns.com/page/rd?anchor=java2html_plugin_for_jspwiki_causes">doesn't work in Firefox</a><img class="outlink" src="images/out.png" alt="" />. A workaround is to CTRL+Click (Command+Click on OS X) the code block and then copy it.</span>
<h4 id='section-HibernateRelationships-TableOfContents'>Table of Contents</h4>
<ul>
<li> <a class="footnoteref" href="#ref-HibernateRelationships-1">[1]</a> Create Weblog.java, Entry.java and Category.java domain objects 
</li>
<li> <a class="footnoteref" href="#ref-HibernateRelationships-2">[2]</a> [Many-to-Many] A Weblogs can have many Users, a User can have many Weblogs
</li>
<li> <a class="footnoteref" href="#ref-HibernateRelationships-3">[3]</a> [One-to-Many] A Weblog object can have many Entries
</li>
<li> <a class="footnoteref" href="#ref-HibernateRelationships-4">[4]</a> [Many-to-One] A Category object can be assigned to many entries
</li>
</ul>
<h3 id='section-HibernateRelationships-CreateWeblog.javaEntry.javaAndAddXDocletTags1'>Create Weblog.java, Entry.java and add XDoclet tags  <a class="footnote" name="ref-HibernateRelationships-1">[#1]</a></h3>
<p>The <i>Weblog</i> object is used to indentify a person's blog. This class has the following properties:
</p>
<ul>
<li> weblogId
</li>
<li> blogTitle
</li>
<li> dateCreated
</li>
</ul>
<p>The <i>Entry</i> object is used to contain a listing of a person's blog entries in their Weblog.  This class contains the following properties:
</p>
<ul>
<li> entryId
</li>
<li> text
</li>
<li> timeCreated
</li>
</ul>
<span class="note"><b>NOTE:</b> The primary keys are prefixed with their entity name to avoid confusion.  I generally recommend using "id" for your entities, but wanted to make thing clearer in this tutorial.</span>
<p>Below is a class diagram of these two objects, as well as the others you'll create in this tutorial.
</p>
<p><img class="inline" src="attach/HibernateRelationships/ER-Diagram.jpg" alt="ER-Diagram.jpg" />
</p>
<p>The first thing you need to do in this tutorial is these two object to persist. Create a <b>Weblog.java</b> class and an <b>Entry.java</b> class (in the src/dao/**/model directory). The necessary XDoclet tags for these entities is included on the <i>getter</i> method's javadoc.  You can download these files using the links below. Note that javadocs have been eliminated for brevity.
</p>
<ul>
<li> <a class="attachment" href="attach/HibernateRelationships/Weblog.java">Download Weblog.java</a><a href="PageInfo.jsp?page=HibernateRelationships/Weblog.java"><img src="images/attachment_small.png" border="0" alt="(info)"/></a> 
</li>
<li> <a class="attachment" href="attach/HibernateRelationships/Entry.java">Download Entry.java</a><a href="PageInfo.jsp?page=HibernateRelationships/Entry.java"><img src="images/attachment_small.png" border="0" alt="(info)"/></a>
</li>
</ul>
<dl>
<dt></dt><dd><i>Rather than fill up this tutorial with large blocks of Java code, the necessary files are attached and linked to.  Small code snippets are used where appropriate. You should be able to easily download the files by right-clicking on them and selecting "Save Target As...".</i></dd>
</dl>
<p>Create a <b>Category.java</b> object to act as an entity for persisting category information about weblog entries. Each category can have many entries. This class contains the following properties:
</p>
<ul>
<li> categoryId
</li>
<li> name
</li>
<li> description
</li>
</ul>
<ul>
<li> <a class="attachment" href="attach/HibernateRelationships/Category.java">Download Category.java</a><a href="PageInfo.jsp?page=HibernateRelationships/Category.java"><img src="images/attachment_small.png" border="0" alt="(info)"/></a>
</li>
</ul>
<h4 id='section-HibernateRelationships-ConfigureSpring'>Configure Spring</h4>
<p>Add the 3 new mapping files (that will be generated) to the "sessionFactory" bean's <i>mappingResources</i> property in <b>src/org/appfuse/dao/hibernate/applicationContext-hibernate.xml</b>.
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#000000">&lt;property&nbsp;name=</font><font color="#2a00ff">&#34;mappingResources&#34;</font><font color="#000000">&gt;&nbsp;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;list&gt;&nbsp;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;value&gt;org/appfuse/model/Role.hbm.xml&lt;/value&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;value&gt;org/appfuse/model/User.hbm.xml&lt;/value&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;value&gt;org/appfuse/model/Weblog.hbm.xml&lt;/value&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;value&gt;org/appfuse/model/Entry.hbm.xml&lt;/value&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;value&gt;org/appfuse/model/Category.hbm.xml&lt;/value&gt;&nbsp;&nbsp;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/list&gt;&nbsp;</font><br/>
<font color="#000000">&lt;/property&gt;&nbsp;</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<h3 id='section-HibernateRelationships-ManyToManyAWeblogsCanHaveManyUsersAUserCanHaveManyWeblogs2'>[Many-to-Many] A Weblogs can have many Users, a User can have many Weblogs <a class="footnote" name="ref-HibernateRelationships-2">[#2]</a></h3>
<p>A Weblog can have many Users. Basically the idea is of a shared weblog that is a place where many users can express themselves about a particular topic of interest. For this bit of functionality the User object will be modified to have a many-to-many relationship with Weblog.
</p>
<p>Add the following <i>users</i> property and accessor methods to <b>Weblog.java</b>.
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>private&nbsp;</b></font><font color="#000000">List&nbsp;users&nbsp;=&nbsp;</font><font color="#7f0055"><b>new&nbsp;</b></font><font color="#000000">ArrayList</font><font color="#000000">()</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">/**</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*&nbsp;@hibernate.bag&nbsp;table=&#34;weblog_user&#34;&nbsp;cascade=&#34;save-update&#34;&nbsp;lazy=&#34;true&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*&nbsp;@hibernate.collection-key&nbsp;column=&#34;weblog_id&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*&nbsp;@hibernate.collection-many-to-many&nbsp;class=&#34;org.appfuse.model.User&#34;&nbsp;column=&#34;username&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*/</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#000000">List&nbsp;getUsers</font><font color="#000000">()&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>return&nbsp;</b></font><font color="#000000">users;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">addUser</font><font color="#000000">(</font><font color="#000000">User&nbsp;user</font><font color="#000000">)&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">getUsers</font><font color="#000000">()</font><font color="#000000">.add</font><font color="#000000">(</font><font color="#000000">user</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">setUsers</font><font color="#000000">(</font><font color="#000000">List&nbsp;users</font><font color="#000000">)&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>this</b></font><font color="#000000">.users&nbsp;=&nbsp;users;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<span class="note"><b>NOTE:</b> The reason a java.util.List is used instead of a java.util.Set is because this is because <a class="external" href="http://www.mail-archive.com/user@struts.apache.org/msg26289.html">Sets aren't supported for indexed properties in Struts</a><img class="outlink" src="images/out.png" alt="" />.</span>
<h4 id='section-HibernateRelationships-UserModifications'>User modifications</h4>
<p>To allow navigation from a User objec to a list of Weblogs, you need to add a List of Weblogs to the User object.  Modify <i>User.java</i> to add a <i>weblogs</i> List and accessor methods. 
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>protected&nbsp;</b></font><font color="#000000">List&nbsp;weblogs;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">/**</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*&nbsp;@hibernate.bag&nbsp;table=&#34;weblog_user&#34;&nbsp;cascade=&#34;save-update&#34;&nbsp;lazy=&#34;true&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*&nbsp;@hibernate.collection-key&nbsp;column=&#34;username&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*&nbsp;@hibernate.collection-many-to-many&nbsp;class=&#34;org.appfuse.model.Weblog&#34;&nbsp;column=&#34;weblog_id&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*/</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#000000">List&nbsp;getWeblogs</font><font color="#000000">()&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>return&nbsp;</b></font><font color="#000000">weblogs;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">setWeblogs</font><font color="#000000">(</font><font color="#000000">List&nbsp;weblogs</font><font color="#000000">)&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>this</b></font><font color="#000000">.weblogs&nbsp;=&nbsp;weblogs;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<h4 id='section-HibernateRelationships-TestIt'>Test it!</h4>
<p>Create a unit test so you can verify that everything actually works.  Create a <b>WeblogDaoTest</b> class in your test/dao/**/dao directory.  This file should extend GenericDaoTest. If you're using anything less than AppFuse 1.9, you may have to modify GenericDAOTest's "dao" variable so its <b>protected</b> instead of private. Copy the code below into this test:
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#7f0055"><b>package&nbsp;</b></font><font color="#000000">org.appfuse.dao;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">java.util.Date;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">org.appfuse.model.User;</font><br/>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">org.appfuse.model.Weblog;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#7f0055"><b>public&nbsp;class&nbsp;</b></font><font color="#000000">WeblogDaoTest&nbsp;</font><font color="#7f0055"><b>extends&nbsp;</b></font><font color="#000000">GenericDAOTest&nbsp;</font><font color="#000000">{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">testWeblogAndUsers</font><font color="#000000">()&nbsp;</font><font color="#7f0055"><b>throws&nbsp;</b></font><font color="#000000">Exception&nbsp;</font><font color="#000000">{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">Weblog&nbsp;w&nbsp;=&nbsp;</font><font color="#7f0055"><b>new&nbsp;</b></font><font color="#000000">Weblog</font><font color="#000000">()</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">w.setBlogTitle</font><font color="#000000">(</font><font color="#2a00ff">&#34;My&nbsp;New&nbsp;Weblog&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">w.setDateCreated</font><font color="#000000">(</font><font color="#7f0055"><b>new&nbsp;</b></font><font color="#000000">Date</font><font color="#000000">())</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f7f5f">//&nbsp;add&nbsp;it&nbsp;to&nbsp;the&nbsp;database</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">dao.saveObject</font><font color="#000000">(</font><font color="#000000">w</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">w&nbsp;=&nbsp;</font><font color="#000000">(</font><font color="#000000">Weblog</font><font color="#000000">)&nbsp;</font><font color="#000000">dao.getObject</font><font color="#000000">(</font><font color="#000000">Weblog.class,&nbsp;w.getWeblogId</font><font color="#000000">())</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">assertTrue</font><font color="#000000">(</font><font color="#000000">w.getUsers</font><font color="#000000">()</font><font color="#000000">.isEmpty</font><font color="#000000">())</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f7f5f">//&nbsp;add&nbsp;a&nbsp;user</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">User&nbsp;u&nbsp;=&nbsp;</font><font color="#000000">(</font><font color="#000000">User</font><font color="#000000">)&nbsp;</font><font color="#000000">dao.getObject</font><font color="#000000">(</font><font color="#000000">User.class,&nbsp;</font><font color="#2a00ff">&#34;mraible&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">w.addUser</font><font color="#000000">(</font><font color="#000000">u</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">dao.saveObject</font><font color="#000000">(</font><font color="#000000">w</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">w&nbsp;=&nbsp;</font><font color="#000000">(</font><font color="#000000">Weblog</font><font color="#000000">)&nbsp;</font><font color="#000000">dao.getObject</font><font color="#000000">(</font><font color="#000000">Weblog.class,&nbsp;w.getWeblogId</font><font color="#000000">())</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">assertTrue</font><font color="#000000">(</font><font color="#000000">w.getUsers</font><font color="#000000">()</font><font color="#000000">.size</font><font color="#000000">()&nbsp;</font><font color="#000000">==&nbsp;</font><font color="#990000">1</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f7f5f">//&nbsp;remove&nbsp;the&nbsp;user</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">w.setUsers</font><font color="#000000">(</font><font color="#7f0055"><b>null</b></font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">dao.saveObject</font><font color="#000000">(</font><font color="#000000">w</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">w&nbsp;=&nbsp;</font><font color="#000000">(</font><font color="#000000">Weblog</font><font color="#000000">)&nbsp;</font><font color="#000000">dao.getObject</font><font color="#000000">(</font><font color="#000000">Weblog.class,&nbsp;w.getWeblogId</font><font color="#000000">())</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">assertNull</font><font color="#000000">(</font><font color="#000000">w.getUsers</font><font color="#000000">())</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#000000">}</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>Make sure you run <b>ant setup-db</b> before running <b>ant test-dao -Dtestcase=UserDAO</b>.  When running the test, you'll probably get a <i>LazyInitializationException</i>.  To solve this, change BaseDaoTestCase to extend Spring's <a class="external" href="http://www.springframework.org/docs/api/org/springframework/test/AbstractTransactionalDataSourceSpringContextTests.html">AbstractTransactionalDataSourceSpringContextTests</a><img class="outlink" src="images/out.png" alt="" /> if it doesn't already.  In additional, you'll need to make a few changes to the existing tests so all the tests pass.  <a class="editpage" title="Create 'LazyDaoTests.diff'" href="Edit.jsp?page=LazyDaoTests.diff">Here is a patch</a>. At a minimum, you'll need to fix BaseDAOTestCase and GenericDAOTest (onSetUp() -> onSetupBeforeTransaction()).  
</p>
<p>Because the WeblogDaoTest is now extending AbstractTransactionalDataSourceSpringContextTests (ATDSSCT), there is a "jdbcTemplate" variable you can use to do additional querying.  For instance, you could add the following at the end of your <i>testWeblogAndUsers()</i> method:
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">String&nbsp;qry&nbsp;=&nbsp;</font><font color="#2a00ff">&#34;select&nbsp;count(*)&nbsp;from&nbsp;weblog_user&nbsp;where&nbsp;username&nbsp;=&nbsp;'mraible'&nbsp;&#34;&nbsp;</font><font color="#000000">+</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#2a00ff">&#34;&nbsp;and&nbsp;weblog_id&nbsp;=&nbsp;&#34;&nbsp;</font><font color="#000000">+&nbsp;w.getWeblogId</font><font color="#000000">()</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">assertEquals</font><font color="#000000">(</font><font color="#990000">0</font><font color="#000000">,&nbsp;jdbcTemplate.queryForInt</font><font color="#000000">(</font><font color="#000000">qry</font><font color="#000000">))</font><font color="#000000">;</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<h3 id='section-HibernateRelationships-OneToManyAWeblogObjectCanHaveManyEntries3'>[One-to-Many] A Weblog object can have many Entries <a class="footnote" name="ref-HibernateRelationships-3">[#3]</a></h3>
<p>Now you'll modify the <b>Weblog</b> object and <b>Entry</b> object to represent the multiplicity of a weblog that can have many entries. This relationship is set on the Weblog class using a java.util.List. XDoclet tags are used to establish this relationship using a <b>bag</b> as the Hibernate collection type.  Add the following code to your <b>Weblog.java</b> class.
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>private&nbsp;</b></font><font color="#000000">List&nbsp;entries;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">/**</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*&nbsp;</font><font color="#7f9fbf">@return&nbsp;</font><font color="#3f5fbf">Returns&nbsp;the&nbsp;entries.</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*&nbsp;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*&nbsp;@hibernate.bag&nbsp;name=&#34;entries&#34;&nbsp;lazy=&#34;false&#34;&nbsp;cascade=&#34;all&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*&nbsp;@hibernate.collection-key&nbsp;column=&#34;weblog_id&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*&nbsp;@hibernate.collection-one-to-many&nbsp;class=&#34;org.appfuse.model.Entry&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*/</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#000000">List&nbsp;getEntries</font><font color="#000000">()&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>return&nbsp;</b></font><font color="#000000">entries;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">setEntries</font><font color="#000000">(</font><font color="#000000">List&nbsp;entries</font><font color="#000000">)&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>this</b></font><font color="#000000">.entries&nbsp;=&nbsp;entries;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>Modify the <b>Entry</b> class is so it contains a foreign key to its parent <b>Weblog</b> class.
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>private&nbsp;</b></font><font color="#000000">Long&nbsp;weblogId;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">/**</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*&nbsp;@hibernate.property&nbsp;column=&#34;weblog_id&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*/</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#000000">Long&nbsp;getWeblogId</font><font color="#000000">()&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>return&nbsp;</b></font><font color="#000000">weblogId;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">setWeblogId</font><font color="#000000">(</font><font color="#000000">Long&nbsp;weblogId</font><font color="#000000">)&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>this</b></font><font color="#000000">.weblogId&nbsp;=&nbsp;weblogId;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>At this point, you could add an additional test method to WeblogDaoTest to test that this relationship works. Of course, you'll need to run <b>ant setup-db</b> to make sure your database knows about the relationship.
</p>
<h3 id='section-HibernateRelationships-ManyToOneACategoryObjectCanBeAssignedToManyEntries4'>[Many-to-One] A Category object can be assigned to many entries <a class="footnote" name="ref-HibernateRelationships-4">[#4]</a></h3>
<p>The <i>many-to-one</i> relationship between <b>Category</b> and <b>Entry</b> can be established using XDoclet tags. Hibernate relationships can be established on either side of the relationship or bi-directionally. For this tutorial, this relationship is maintained by a <b>categoryId</b> property and a <b>Category</b> object in <b>Entry</b>. The list of possible categories for a weblog entry will eventually be represented as a drop-down on the UI. Add the following code to your <b>Entry.java</b> class. Notice that the relationship to <b>Category</b> has <i>insert="false" update="false"</i>.  This is because the object is read-only. This can be useful for displaying a category's name on the UI when you're viewing an Entry.
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>private&nbsp;</b></font><font color="#000000">Long&nbsp;categoryId;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>private&nbsp;</b></font><font color="#000000">Category&nbsp;category;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">/**</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*&nbsp;@hibernate.many-to-one&nbsp;insert=&#34;false&#34;&nbsp;update=&#34;false&#34;&nbsp;cascade=&#34;none&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*&nbsp;&nbsp;column=&#34;category_id&#34;&nbsp;outer-join=&#34;true&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*/</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#000000">Category&nbsp;getCategory</font><font color="#000000">()&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>return&nbsp;</b></font><font color="#000000">category;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">setCategory</font><font color="#000000">(</font><font color="#000000">Category&nbsp;category</font><font color="#000000">)&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>this</b></font><font color="#000000">.category&nbsp;=&nbsp;category;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">/**</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*&nbsp;@hibernate.property&nbsp;column=&#34;category_id&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*/</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#000000">Long&nbsp;getCategoryId</font><font color="#000000">()&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>return&nbsp;</b></font><font color="#000000">categoryId;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">setCategoryId</font><font color="#000000">(</font><font color="#000000">Long&nbsp;categoryId</font><font color="#000000">)&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>this</b></font><font color="#000000">.categoryId&nbsp;=&nbsp;categoryId;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>After making these changes, your <b>WeblogDaoTest</b> should still pass.  Verify it does by running <b>ant setup-db test-dao -Dtestcase=Weblog</b>.
</p>
<p><i><b>Yeah baby, Yeah!</b></i>
</p>
<div style="color: green">
BUILD SUCCESSFUL<br />
Total time: 24 seconds
</div>
<p>Before working on the UI, it's helpful to have some sample data so you don't have to do manual data entry. Add the following XML to the bottom of <b>metadata/sql/sample-data.xml</b>.
</p>
<p><div style="color: blue !important; margin-left: 50px">
</p>
<pre>
  &lt;table name='weblog'&gt;
    &lt;column&gt;weblog_id&lt;/column&gt;
    &lt;column&gt;blog_title&lt;/column&gt;
    &lt;column&gt;date_created&lt;/column&gt;
    &lt;row&gt;
      &lt;value&gt;1&lt;/value&gt;
      &lt;value&gt;&lt;![CDATA[Sponge Bob is Cool]]&gt;&lt;/value&gt;
      &lt;value&gt;2004-03-31&lt;/value&gt;
    &lt;/row&gt;
    &lt;row&gt;
      &lt;value&gt;2&lt;/value&gt;
      &lt;value&gt;&lt;![CDATA[Java Development = Fun]]&gt;&lt;/value&gt;
      &lt;value&gt;2005-01-05&lt;/value&gt;
    &lt;/row&gt;
  &lt;/table&gt;
  &lt;table name='weblog_user'&gt;
    &lt;column&gt;weblog_id&lt;/column&gt;
    &lt;column&gt;username&lt;/column&gt;
    &lt;row&gt;
      &lt;value&gt;1&lt;/value&gt;
      &lt;value&gt;tomcat&lt;/value&gt;
    &lt;/row&gt;
    &lt;row&gt;
      &lt;value&gt;1&lt;/value&gt;
      &lt;value&gt;mraible&lt;/value&gt;
    &lt;/row&gt;
    &lt;row&gt;
      &lt;value&gt;2&lt;/value&gt;
      &lt;value&gt;mraible&lt;/value&gt;
    &lt;/row&gt;
  &lt;/table&gt;
  &lt;table name='category'&gt;
    &lt;column&gt;category_id&lt;/column&gt;
    &lt;column&gt;name&lt;/column&gt;
    &lt;column&gt;description&lt;/column&gt;
    &lt;row&gt;
      &lt;value&gt;1&lt;/value&gt;
      &lt;value&gt;&lt;![CDATA[Struts vs. Spring MVC]]&gt;&lt;/value&gt;
      &lt;value&gt;&lt;![CDATA[Comparing implementations of the MVC Design Pattern]]&gt;&lt;/value&gt;
    &lt;/row&gt;
    &lt;row&gt;
      &lt;value&gt;2&lt;/value&gt;
      &lt;value&gt;&lt;![CDATA[Cycling Notes]]&gt;&lt;/value&gt;
      &lt;value&gt;&lt;![CDATA[All about cycling in the US.]]&gt;&lt;/value&gt;
    &lt;/row&gt;
    &lt;row&gt;
      &lt;value&gt;3&lt;/value&gt;
      &lt;value&gt;&lt;![CDATA[Cyclocross]]&gt;&lt;/value&gt;
      &lt;value&gt;&lt;![CDATA[Bog Trotters Unite!]]&gt;&lt;/value&gt;
    &lt;/row&gt;
  &lt;/table&gt;
  &lt;table name='entry'&gt;
    &lt;column&gt;entry_id&lt;/column&gt;
    &lt;column&gt;entry_text&lt;/column&gt;
    &lt;column&gt;time_created&lt;/column&gt;
    &lt;column&gt;weblog_id&lt;/column&gt;
    &lt;column&gt;category_id&lt;/column&gt;
    &lt;row&gt;
      &lt;value&gt;1&lt;/value&gt;
      &lt;value&gt;&lt;![CDATA[Testing]]&gt;&lt;/value&gt;
      &lt;value&gt;2005-04-11 01:02:03.4&lt;/value&gt;
      &lt;value&gt;1&lt;/value&gt;
      &lt;value&gt;1&lt;/value&gt;
    &lt;/row&gt;
    &lt;row&gt;
      &lt;value&gt;2&lt;/value&gt;
      &lt;value&gt;&lt;![CDATA[Test Value]]&gt;&lt;/value&gt;
      &lt;value&gt;2005-04-12 01:02:03.4&lt;/value&gt;
      &lt;value&gt;1&lt;/value&gt;
      &lt;value&gt;1&lt;/value&gt;
    &lt;/row&gt;
    &lt;row&gt;
      &lt;value&gt;3&lt;/value&gt;
      &lt;value&gt;&lt;![CDATA[Test Value 3]]&gt;&lt;/value&gt;
      &lt;value&gt;2005-04-12 01:02:03.4&lt;/value&gt;
      &lt;value&gt;2&lt;/value&gt;
      &lt;value&gt;3&lt;/value&gt;
    &lt;/row&gt;
  &lt;/table&gt;
</pre>

</div>
<hr />
<p><i>Next Up:</i> <b>Part II:</b> <a class="wikipage" href="Wiki.jsp?page=HibernateRelationshipsUI">Create Weblog UI</a> - Creating a UI to manage the relationships created in this tutorial.
</p>
<A NAME="Link_JSFBeans">
<h1>JSFBeans</h1>
</A>
<b>Part III:</b> <a class="wikipage" href="Wiki.jsp?page=JSFBeans">Creating JSF Beans and JSPs</a> - A HowTo for creating <a class="external" href="http://www.myfaces.org">JSF</a><img class="outlink" src="images/out.png" alt="" /> Beans and JSPs in an <a class="wikipage" href="Wiki.jsp?page=AppFuse">AppFuse</a> project.
<dl>
<dt></dt><dd><i>This tutorial depends on <b>Part II:</b> <a class="wikipage" href="Wiki.jsp?page=CreateManager">Creating new Managers</a>.</i></dd>
</dl>
<h3 id='section-JSFBeans-AboutThisTutorial'>About this Tutorial</h3>
This tutorial will show you how to create JSF Beans and JSPs.  It'll also demonstrate writing a JUnit Test to test PersonForm.  The Managed Bean we create will talk to the PersonManager we created in the <a class="wikipage" href="Wiki.jsp?page=CreateManager">Creating Managers</a> tutorial.  In most web frameworks, the controller logic is contain in an "Action" of some sort.  However, with JSF, they're commonly referred to as "Managed Beans".  The methods within these beans are called actions.  This tutorial is not going to teach you a whole lot about how JSF works, but it will get you up and running quickly with it.  If you want a more in-depth learning experience, I suggest you read <a class="external" href="http://jroller.com/page/dgeary">David Geary's</a><img class="outlink" src="images/out.png" alt="" /> <a class="external" href="http://www.horstmann.com/corejsf/">Core JSF</a><img class="outlink" src="images/out.png" alt="" />.  I had it close by my side and used it frequently while integrating JSF into AppFuse.  Thanks for the help David and Cay (co-author)!
<dl>
<dt></dt><dd><span style="color: blue"><i>I will tell you how I do stuff in the <b>Real World</b> in text like this.</i></span></dd>
</dl>
<p>Let's get started by creating a new Bean and JSP in AppFuse's architecture.  If you haven't installed the JSF module at this point, do so by running <i>ant install-jsf</i>.
</p>
<h4 id='section-JSFBeans-TableOfContents'>Table of Contents</h4>
<ul>
<li> <a class="footnoteref" href="#ref-JSFBeans-1">[1]</a> Create personForm.jsp with XDoclet
</li>
<li> <a class="footnoteref" href="#ref-JSFBeans-2">[2]</a> Create PersonFormTest to test PersonForm
</li>
<li> <a class="footnoteref" href="#ref-JSFBeans-3">[3]</a> Create PersonForm
</li>
<li> <a class="footnoteref" href="#ref-JSFBeans-4">[4]</a> Run PersonFormTest
</li>
<li> <a class="footnoteref" href="#ref-JSFBeans-5">[5]</a> Clean up the JSP to make it presentable 
</li>
<li> <a class="footnoteref" href="#ref-JSFBeans-6">[6]</a> Create Canoo WebTests to test browser-like actions
</li>
</ul>
<h3 id='section-JSFBeans-CreatePersonForm.jspWithXDoclet1'>Create personForm.jsp with XDoclet <a class="footnote" name="ref-JSFBeans-1">[#1]</a></h3>
In this step, you'll generate a JSP page to display information from the Person object.  It will contain JSF's JSP tags that render table rows for each property in Person.java.  The <a class="wikipage" href="Wiki.jsp?page=AppGen">AppGen</a> tool that's used to do this is based off a StrutsGen tool - which was originally written by <a class="external" href="http://www.blogscene.org/erik/">Erik Hatcher</a><img class="outlink" src="images/out.png" alt="" />.  It's basically just a couple of classes and a bunch of XDoclet templates.  All these files are located in extras/appgen.
<p>Here are the simple steps to generating the JSP and a properties file containing the labels for the form elements:
</p>
<ul>
<li> From the command-line, navigate to "extras/appgen"
</li>
<li> Execute <b>ant -Dobject.name=Person -Dappgen.type=pojo</b> to generate a bunch of files in extras/appgen/build/gen.  In fact, it'll generate all the files you need to complete this tutorial.  However, let's just grab the ones you need.
<ul>
<li> web/WEB-INF/classes/Person.properties (labels for your form elements) 
</li>
<li> web/personForm.jsp (JSP file for viewing a single Person)
</li>
<li> web/personList.jsp (JSP file for viewing a list of People)
</li>
</ul>
</li>
<li> Copy the contents of Person.properties into web/WEB-INF/classes/ApplicationResources.properties.  These are all the keys you will need for titles/headings and form properties.  Here is an example of what you should add to ApplicationResources.properties:
</li>
</ul>
<div style="margin-left: 40px">
<pre>
# -- person form --
person.id=Id
person.firstName=First Name
person.lastName=Last Name

person.added=Person has been added successfully.
person.updated=Person has been updated successfully.
person.deleted=Person has been deleted successfully.

# -- person list page --
personList.title=Person List
personList.heading=Persons

# -- person detail page --
personDetail.title=Person Detail
personDetail.heading=Person Information
</pre>

</div>
<ul>
<li> Copy personForm.jsp to web/personForm.jsp.  Copy personList.jsp to web/personList.jsp.   
</li>
</ul>
<dl>
<dt></dt><dd> <i>Unfortunately, JSF doesn't have an out-of-the-box way to deploy the JSPs to the "WEB-INF/pages" directory at deployment time. The container provides security for all files below WEB-INF.  This applies to client requests, but not to forwards from the ServletDispatcher. Placing all JSPs below WEB-INF ensures they are only accessed through the Faces Servlet, and not directly by the client or each other. Maybe in a future JSF release.</i></dd>
</dl>
<span class="note"><b>NOTE:</b> If you want to customize the CSS for a particular page, you can add &lt;body id="pageName"/> to the top of the file (right after the &lt;/content> tag).  This will be slurped up by SiteMesh and put into the final page.  You can then customize your CSS on a page-by-page basis using something like the following: 
<pre>body#pageName element.class { background-color: blue } </pre>
</span>
<h3 id='section-JSFBeans-CreatePersonFormTestToTestPersonForm2'>Create PersonFormTest to test PersonForm <a class="footnote" name="ref-JSFBeans-2">[#2]</a></h3>
To create a JUnit Test for PersonForm, start by creating a PersonFormTest.java file in the test/web/**/action directory.
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#7f0055"><b>package&nbsp;</b></font><font color="#000000">org.appfuse.webapp.action;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">org.appfuse.model.Person;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#7f0055"><b>public&nbsp;class&nbsp;</b></font><font color="#000000">PersonFormTest&nbsp;</font><font color="#7f0055"><b>extends&nbsp;</b></font><font color="#000000">BasePageTestCase&nbsp;</font><font color="#000000">{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>private&nbsp;</b></font><font color="#000000">PersonForm&nbsp;bean;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>protected&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">setUp</font><font color="#000000">()&nbsp;</font><font color="#7f0055"><b>throws&nbsp;</b></font><font color="#000000">Exception&nbsp;</font><font color="#000000">{&nbsp;&nbsp;&nbsp;&nbsp;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>super</b></font><font color="#000000">.setUp</font><font color="#000000">()</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">bean&nbsp;=&nbsp;</font><font color="#000000">(</font><font color="#000000">PersonForm</font><font color="#000000">)&nbsp;</font><font color="#000000">getManagedBean</font><font color="#000000">(</font><font color="#2a00ff">&#34;personForm&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>protected&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">tearDown</font><font color="#000000">()&nbsp;</font><font color="#7f0055"><b>throws&nbsp;</b></font><font color="#000000">Exception&nbsp;</font><font color="#000000">{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>super</b></font><font color="#000000">.tearDown</font><font color="#000000">()</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">bean&nbsp;=&nbsp;</font><font color="#7f0055"><b>null</b></font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">testAdd</font><font color="#000000">()&nbsp;</font><font color="#7f0055"><b>throws&nbsp;</b></font><font color="#000000">Exception&nbsp;</font><font color="#000000">{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">Person&nbsp;person&nbsp;=&nbsp;</font><font color="#7f0055"><b>new&nbsp;</b></font><font color="#000000">Person</font><font color="#000000">()</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f7f5f">//&nbsp;set&nbsp;required&nbsp;fields</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">person.setFirstName</font><font color="#000000">(</font><font color="#2a00ff">&#34;firstName&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">person.setLastName</font><font color="#000000">(</font><font color="#2a00ff">&#34;lastName&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">bean.setPerson</font><font color="#000000">(</font><font color="#000000">person</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">assertEquals</font><font color="#000000">(</font><font color="#000000">bean.save</font><font color="#000000">()</font><font color="#000000">,&nbsp;</font><font color="#2a00ff">&#34;list&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">assertFalse</font><font color="#000000">(</font><font color="#000000">bean.hasErrors</font><font color="#000000">())</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">testEdit</font><font color="#000000">()&nbsp;</font><font color="#7f0055"><b>throws&nbsp;</b></font><font color="#000000">Exception&nbsp;</font><font color="#000000">{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">log.debug</font><font color="#000000">(</font><font color="#2a00ff">&#34;testing&nbsp;edit...&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">bean.setId</font><font color="#000000">(</font><font color="#2a00ff">&#34;1&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">assertEquals</font><font color="#000000">(</font><font color="#000000">bean.edit</font><font color="#000000">()</font><font color="#000000">,&nbsp;</font><font color="#2a00ff">&#34;edit&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">assertNotNull</font><font color="#000000">(</font><font color="#000000">bean.getPerson</font><font color="#000000">())</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">assertFalse</font><font color="#000000">(</font><font color="#000000">bean.hasErrors</font><font color="#000000">())</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">testSave</font><font color="#000000">()&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">bean.setId</font><font color="#000000">(</font><font color="#2a00ff">&#34;1&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">assertEquals</font><font color="#000000">(</font><font color="#000000">bean.edit</font><font color="#000000">()</font><font color="#000000">,&nbsp;</font><font color="#2a00ff">&#34;edit&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">assertNotNull</font><font color="#000000">(</font><font color="#000000">bean.getPerson</font><font color="#000000">())</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">Person&nbsp;person&nbsp;=&nbsp;bean.getPerson</font><font color="#000000">()</font><font color="#000000">;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f7f5f">//&nbsp;update&nbsp;fields</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">person.setFirstName</font><font color="#000000">(</font><font color="#2a00ff">&#34;firstName&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">person.setLastName</font><font color="#000000">(</font><font color="#2a00ff">&#34;lastName&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">bean.setPerson</font><font color="#000000">(</font><font color="#000000">person</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">assertEquals</font><font color="#000000">(</font><font color="#000000">bean.save</font><font color="#000000">()</font><font color="#000000">,&nbsp;</font><font color="#2a00ff">&#34;edit&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">assertFalse</font><font color="#000000">(</font><font color="#000000">bean.hasErrors</font><font color="#000000">())</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">testRemove</font><font color="#000000">()&nbsp;</font><font color="#7f0055"><b>throws&nbsp;</b></font><font color="#000000">Exception&nbsp;</font><font color="#000000">{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">Person&nbsp;person&nbsp;=&nbsp;</font><font color="#7f0055"><b>new&nbsp;</b></font><font color="#000000">Person</font><font color="#000000">()</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">person.setId</font><font color="#000000">(</font><font color="#7f0055"><b>new&nbsp;</b></font><font color="#000000">Long</font><font color="#000000">(</font><font color="#990000">2</font><font color="#000000">))</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">bean.setPerson</font><font color="#000000">(</font><font color="#000000">person</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">assertEquals</font><font color="#000000">(</font><font color="#000000">bean.delete</font><font color="#000000">()</font><font color="#000000">,&nbsp;</font><font color="#2a00ff">&#34;list&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">assertFalse</font><font color="#000000">(</font><font color="#000000">bean.hasErrors</font><font color="#000000">())</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#000000">}</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>Nothing will compile at this point because you need to create the PersonForm that you're referring to in this test.
</p>
<h3 id='section-JSFBeans-CreatePersonForm3'>Create PersonForm <a class="footnote" name="ref-JSFBeans-3">[#3]</a></h3>
<p>In src/web/**/action, create a PersonForm.java file with the following contents:
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#7f0055"><b>package&nbsp;</b></font><font color="#000000">org.appfuse.webapp.action;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">java.io.Serializable;</font><br/>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">java.util.List;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">org.appfuse.model.Person;</font><br/>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">org.appfuse.service.Manager;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#7f0055"><b>public&nbsp;class&nbsp;</b></font><font color="#000000">PersonForm&nbsp;</font><font color="#7f0055"><b>extends&nbsp;</b></font><font color="#000000">BasePage&nbsp;</font><font color="#7f0055"><b>implements&nbsp;</b></font><font color="#000000">Serializable&nbsp;</font><font color="#000000">{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>private&nbsp;</b></font><font color="#000000">PersonManager&nbsp;personManager;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>private&nbsp;</b></font><font color="#000000">Person&nbsp;person&nbsp;=&nbsp;</font><font color="#7f0055"><b>new&nbsp;</b></font><font color="#000000">Person</font><font color="#000000">()</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>private&nbsp;</b></font><font color="#000000">String&nbsp;id;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">setPersonManager</font><font color="#000000">(</font><font color="#000000">PersonManager&nbsp;manager</font><font color="#000000">)&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>this</b></font><font color="#000000">.personManager&nbsp;=&nbsp;manager;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#000000">Person&nbsp;getPerson</font><font color="#000000">()&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>return&nbsp;</b></font><font color="#000000">person;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">setPerson</font><font color="#000000">(</font><font color="#000000">Person&nbsp;person</font><font color="#000000">)&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>this</b></font><font color="#000000">.person&nbsp;=&nbsp;person;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">setId</font><font color="#000000">(</font><font color="#000000">String&nbsp;id</font><font color="#000000">)&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>this</b></font><font color="#000000">.id&nbsp;=&nbsp;id;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#000000">String&nbsp;delete</font><font color="#000000">()&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">personManager.removePerson</font><font color="#000000">(</font><font color="#000000">String.valueOf</font><font color="#000000">(</font><font color="#000000">person.getId</font><font color="#000000">()))</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">addMessage</font><font color="#000000">(</font><font color="#2a00ff">&#34;person.deleted&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>return&nbsp;</b></font><font color="#2a00ff">&#34;list&#34;</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#000000">String&nbsp;edit</font><font color="#000000">()&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>if&nbsp;</b></font><font color="#000000">(</font><font color="#000000">id&nbsp;!=&nbsp;</font><font color="#7f0055"><b>null</b></font><font color="#000000">)&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">person&nbsp;=&nbsp;personManager.getPerson</font><font color="#000000">(</font><font color="#000000">id</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}&nbsp;</font><font color="#7f0055"><b>else&nbsp;</b></font><font color="#000000">{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">person&nbsp;=&nbsp;</font><font color="#7f0055"><b>new&nbsp;</b></font><font color="#000000">Person</font><font color="#000000">()</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>return&nbsp;</b></font><font color="#2a00ff">&#34;edit&#34;</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#000000">String&nbsp;save</font><font color="#000000">()&nbsp;{</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>boolean&nbsp;</b></font><font color="#000000">isNew&nbsp;=&nbsp;</font><font color="#000000">(</font><font color="#000000">person.getId</font><font color="#000000">()&nbsp;</font><font color="#000000">==&nbsp;</font><font color="#7f0055"><b>null</b></font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">personManager.savePerson</font><font color="#000000">(</font><font color="#000000">person</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">String&nbsp;key&nbsp;=&nbsp;</font><font color="#000000">(</font><font color="#000000">isNew</font><font color="#000000">)&nbsp;</font><font color="#000000">?&nbsp;</font><font color="#2a00ff">&#34;person.added&#34;&nbsp;</font><font color="#000000">:&nbsp;</font><font color="#2a00ff">&#34;person.updated&#34;</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">addMessage</font><font color="#000000">(</font><font color="#000000">key</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>if&nbsp;</b></font><font color="#000000">(</font><font color="#000000">isNew</font><font color="#000000">)&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>return&nbsp;</b></font><font color="#2a00ff">&#34;list&#34;</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}&nbsp;</font><font color="#7f0055"><b>else&nbsp;</b></font><font color="#000000">{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>return&nbsp;</b></font><font color="#2a00ff">&#34;edit&#34;</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#000000">}</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>You'll notice a number of keys in this file - "person.deleted", "person.added" and "person.updated". These are all keys that need to be in your i18n bundle (ApplicationResources.properties).  You should've added these at the beginning of this tutorial.  If you want to customize these messages, to add the a person's name or something, simply add a {0} placeholder in the key's message and then use the addMessage(key, stringtoreplace) method.  You can also use an Object<u></u> for the stringtoreplace variable if you want to make multiple substitutions.
</p>
<p>You might notice that the code we're using to call the PersonManager is the same as the code we used in our PersonManagerTest.  Both PersonForm and PersonManagerTest are <i>clients</i> of PersonManagerImpl, so this makes perfect sense.
</p>
<p>Now you need to tell JSF that this bean exists.  First, add a managed-bean definition for PersonForm to web/WEB-INF/faces-config.xml:
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;managed-bean&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;managed-bean-name&gt;personForm&lt;/managed-bean-name&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;managed-bean-</font><font color="#7f0055"><b>class</b></font><font color="#000000">&gt;org.appfuse.webapp.action.PersonForm&lt;/managed-bean-</font><font color="#7f0055"><b>class</b></font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;managed-bean-scope&gt;request&lt;/managed-bean-scope&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;managed-property&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;property-name&gt;id&lt;/property-name&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;value&gt;#</font><font color="#000000">{</font><font color="#000000">param.id</font><font color="#000000">}</font><font color="#000000">&lt;/value&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/managed-property&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;managed-property&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;property-name&gt;personManager&lt;/property-name&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;value&gt;#</font><font color="#000000">{</font><font color="#000000">personManager</font><font color="#000000">}</font><font color="#000000">&lt;/value&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/managed-property&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/managed-bean&gt;</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<span class="note">Spring's <a class="external" href="http://www.springframework.org/docs/api_1.2/org/springframework/web/jsf/DelegatingVariableResolver.html">DelegatingVariableResolver</a><img class="outlink" src="images/out.png" alt="" />  helps JSF to resolve "#{personManager}" to the "personManager" Spring bean.  This "variableResolver" has already been declared at the top of the <i>faces-config.xml</i> file.</span>
<p>Then add navigation-rules that control where it goes after actions are executed:
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;navigation-rule&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;from-view-id&gt;/personForm.jsp&lt;/from-view-id&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;navigation-</font><font color="#7f0055"><b>case</b></font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;from-outcome&gt;cancel&lt;/from-outcome&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;to-view-id&gt;/mainMenu.jsp&lt;/to-view-id&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;redirect/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/navigation-</font><font color="#7f0055"><b>case</b></font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;navigation-</font><font color="#7f0055"><b>case</b></font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;from-outcome&gt;list&lt;/from-outcome&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;to-view-id&gt;/mainMenu.jsp&lt;/to-view-id&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;redirect/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/navigation-</font><font color="#7f0055"><b>case</b></font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/navigation-rule&gt;</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<dl>
<dt></dt><dd><i>The PersonForm returns "list" from the <tt>cancel()</tt>, <tt>delete()</tt> and <tt>save()</tt> methods.  In the next tutorial, you will change the "list" in the navigation-rule to point to the list screen.</i></dd>
</dl>
<h3 id='section-JSFBeans-RunThePersonFormTest4'>Run the PersonFormTest <a class="footnote" name="ref-JSFBeans-4">[#4]</a></h3>
If you look at our PersonFormTest, all the tests depend on having a record with id=1 in the database (and testRemove depends on id=2), so add those records to your sample data file (metadata/sql/sample-data.xml). I'd just add it at the bottom - order is not important since it (currently) does not relate to any other tables.
<pre>
  &lt;table name='person'&gt;
    &lt;column&gt;id&lt;/column&gt;
    &lt;column&gt;first_name&lt;/column&gt;
    &lt;column&gt;last_name&lt;/column&gt;
    &lt;row&gt;
      &lt;value&gt;1&lt;/value&gt;
      &lt;value&gt;Matt&lt;/value&gt;
      &lt;value&gt;Raible&lt;/value&gt;
    &lt;/row&gt;
    &lt;row&gt;
      &lt;value&gt;2&lt;/value&gt;
      &lt;value&gt;James&lt;/value&gt;
      &lt;value&gt;Davidson&lt;/value&gt;
    &lt;/row&gt;
  &lt;/table&gt;
</pre>

<p>DBUnit loads this file before we running any of the tests, so this record will be available to your Form test.
</p>
<p>Make sure are in the base directory of your project and all files are saved.  If you run <b>ant test-web -Dtestcase=PersonForm</b> - everything should work as planned.  
</p>
<span style="color:green">BUILD SUCCESSFUL<br />
Total time: 9 seconds</span>
<p></p>
<h3 id='section-JSFBeans-CleanUpTheJSPToMakeItPresentable5'>Clean up the JSP to make it presentable <a class="footnote" name="ref-JSFBeans-5">[#5]</a></h3>
If you want to add a usability enhancement to your form, you can set the cursor to focus on the first field when the page loads.  Simply add the following JavaScript at the bottom of your form (web/personForm.jsp):
<pre>&lt;script type="text/javascript"&gt;
    document.forms["person"].elements["firstName"].focus();
&lt;/script&gt;</pre>
  
<p>Now if you execute <b>ant db-load deploy</b>, start Tomcat and point your browser to <a class="external" href="http://localhost:8080/appfuse/personForm.html">http://localhost:8080/appfuse/personForm.html</a><img class="outlink" src="images/out.png" alt="" />, you should see something like this:
</p>
<div style="border: 1px solid black; margin: 0 auto; height: 166px; width: 337px">
<img class="inline" src="attach/JSFBeans/personForm-final.png" alt="personForm-final.png" />
</div>
<p>With JSF, everything is a post, so if you want to edit a user, you cannot get to them from a URL.  To edit a person, add the following to the mainMenu.jsp:
</p>
<pre>
    &lt;h:commandLink value="Edit Person" action="#{personForm.edit}"&gt;
        &lt;f:param name="id" value="1"/&gt;
    &lt;/h:commandLink&gt;
</pre>

<p>Then add a &lt;navigation-rule> near the top of web/WEB-INF/faces-config.xml:
</p>
<pre>
    &lt;navigation-rule&gt;
        &lt;from-view-id&gt;/mainMenu.jsp&lt;/from-view-id&gt;
        &lt;navigation-case&gt;
            &lt;from-outcome&gt;edit&lt;/from-outcome&gt;
            &lt;to-view-id&gt;/personForm.jsp&lt;/to-view-id&gt;
        &lt;/navigation-case&gt;
    &lt;/navigation-rule&gt;
</pre>

<p>Finally, to make this page more user friendly, you may want to add a message for your users at the top of the form, but this can easily be done by adding text (using &lt;fmt:message&gt;) at the top of the personForm.jsp page.
</p>
<h3 id='section-JSFBeans-OptionalCreateACanooWebTestToTestBrowserLikeActions6'>[Optional] Create a Canoo WebTest to test browser-like actions <a class="footnote" name="ref-JSFBeans-6">[#6]</a></h3>
The final (optional) step in this tutorial is to create a <a class="external" href="http://webtest.canoo.com">Canoo WebTest</a><img class="outlink" src="images/out.png" alt="" /> to test the JSPs.  
<dl>
<dt></dt><dd><i>I say this step is optional, because you can run the same tests through your browser.</i></dd>
</dl>
<p>You can use the following steps to test the different actions for adding, editing and saving a user.
</p>
<ul>
<li> Add - <a class="external" href="http://localhost:8080/appfuse/personForm.html">http://localhost:8080/appfuse/personForm.html</a><img class="outlink" src="images/out.png" alt="" />.
</li>
<li> Edit - Use the link you created on the Main Menu (make sure and run <b>ant db-load</b> first).
</li>
<li> Delete - Use the edit link above and click on the Delete button.
</li>
<li> Save - Click the edit link on the Main Menu (run ant db-load first if you deleted already) and then click the Save button.
</li>
</ul>
<p>Canoo tests are pretty slick in that they're simply configured in an XML file.  To add tests for add, edit, save and delete, open test/web/web-tests.xml and add the following XML.  You'll notice that this fragment has a target named <i>PersonTests</i> that runs all the related tests.  
</p>
<dl>
<dt></dt><dd><i>I use CamelCase target names (vs. the traditional lowercase, dash-separated) because when you're typing </i>-Dtestcase=Name<i>, I've found that I'm used to doing CamelCase for my JUnit Tests.</i></dd>
</dl>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;!--&nbsp;runs&nbsp;person-related&nbsp;tests&nbsp;--&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;target&nbsp;name=</font><font color="#2a00ff">&#34;PersonTests&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">depends=</font><font color="#2a00ff">&#34;EditPerson,SavePerson,AddPerson,DeletePerson&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">description=</font><font color="#2a00ff">&#34;Call&nbsp;and&nbsp;executes&nbsp;all&nbsp;person&nbsp;test&nbsp;cases&nbsp;(targets)&#34;</font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;echo&gt;Successfully&nbsp;ran&nbsp;all&nbsp;Person&nbsp;JSP&nbsp;tests!&lt;/echo&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/target&gt;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;!--&nbsp;Verify&nbsp;the&nbsp;edit&nbsp;person&nbsp;screen&nbsp;displays&nbsp;without&nbsp;errors&nbsp;--&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;target&nbsp;name=</font><font color="#2a00ff">&#34;EditPerson&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">description=</font><font color="#2a00ff">&#34;Tests&nbsp;editing&nbsp;an&nbsp;existing&nbsp;Person's&nbsp;information&#34;</font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;webtest&nbsp;name=</font><font color="#2a00ff">&#34;editPerson&#34;</font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&amp;config;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;steps&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&amp;login;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;clicklink&nbsp;label=</font><font color="#2a00ff">&#34;Edit&nbsp;Person&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;verifytitle&nbsp;description=</font><font color="#2a00ff">&#34;we&nbsp;should&nbsp;see&nbsp;the&nbsp;personDetail&nbsp;title&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">text=</font><font color="#2a00ff">&#34;.*${personDetail.title}.*&#34;&nbsp;</font><font color="#000000">regex=</font><font color="#2a00ff">&#34;true&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/steps&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/webtest&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/target&gt;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;!--&nbsp;Edit&nbsp;a&nbsp;person&nbsp;and&nbsp;then&nbsp;save&nbsp;--&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;target&nbsp;name=</font><font color="#2a00ff">&#34;SavePerson&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">description=</font><font color="#2a00ff">&#34;Tests&nbsp;editing&nbsp;and&nbsp;saving&nbsp;a&nbsp;user&#34;</font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;webtest&nbsp;name=</font><font color="#2a00ff">&#34;savePerson&#34;</font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&amp;config;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;steps&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&amp;login;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;clicklink&nbsp;label=</font><font color="#2a00ff">&#34;Edit&nbsp;Person&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;verifytitle&nbsp;description=</font><font color="#2a00ff">&#34;we&nbsp;should&nbsp;see&nbsp;the&nbsp;personDetail&nbsp;title&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">text=</font><font color="#2a00ff">&#34;.*${personDetail.title}.*&#34;&nbsp;</font><font color="#000000">regex=</font><font color="#2a00ff">&#34;true&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;!--&nbsp;update&nbsp;some&nbsp;of&nbsp;the&nbsp;required&nbsp;fields&nbsp;--&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;setinputfield&nbsp;description=</font><font color="#2a00ff">&#34;set&nbsp;firstName&#34;&nbsp;</font><font color="#000000">name=</font><font color="#2a00ff">&#34;personForm:firstName&#34;&nbsp;</font><font color="#000000">value=</font><font color="#2a00ff">&#34;Canoo&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;setinputfield&nbsp;description=</font><font color="#2a00ff">&#34;set&nbsp;lastName&#34;&nbsp;</font><font color="#000000">name=</font><font color="#2a00ff">&#34;personForm:lastName&#34;&nbsp;</font><font color="#000000">value=</font><font color="#2a00ff">&#34;WebTest&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;clickbutton&nbsp;label=</font><font color="#2a00ff">&#34;${button.save}&#34;&nbsp;</font><font color="#000000">description=</font><font color="#2a00ff">&#34;Click&nbsp;Save&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;verifytitle&nbsp;description=</font><font color="#2a00ff">&#34;Page&nbsp;re-appears&nbsp;if&nbsp;save&nbsp;successful&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">text=</font><font color="#2a00ff">&#34;.*${personDetail.title}.*&#34;&nbsp;</font><font color="#000000">regex=</font><font color="#2a00ff">&#34;true&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;verifytext&nbsp;description=</font><font color="#2a00ff">&#34;verify&nbsp;success&nbsp;message&#34;&nbsp;</font><font color="#000000">text=</font><font color="#2a00ff">&#34;${person.updated}&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/steps&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/webtest&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/target&gt;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;!--&nbsp;Add&nbsp;a&nbsp;</font><font color="#7f0055"><b>new&nbsp;</b></font><font color="#000000">Person&nbsp;--&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;target&nbsp;name=</font><font color="#2a00ff">&#34;AddPerson&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">description=</font><font color="#2a00ff">&#34;Adds&nbsp;a&nbsp;new&nbsp;Person&#34;</font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;webtest&nbsp;name=</font><font color="#2a00ff">&#34;addPerson&#34;</font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&amp;config;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;steps&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&amp;login;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;invoke&nbsp;description=</font><font color="#2a00ff">&#34;View&nbsp;Person&nbsp;Form&#34;&nbsp;</font><font color="#000000">url=</font><font color="#2a00ff">&#34;/personForm.html&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;verifytitle&nbsp;description=</font><font color="#2a00ff">&#34;we&nbsp;should&nbsp;see&nbsp;the&nbsp;personDetail&nbsp;title&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">text=</font><font color="#2a00ff">&#34;.*${personDetail.title}.*&#34;&nbsp;</font><font color="#000000">regex=</font><font color="#2a00ff">&#34;true&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;!--&nbsp;enter&nbsp;required&nbsp;fields&nbsp;--&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;setinputfield&nbsp;description=</font><font color="#2a00ff">&#34;set&nbsp;firstName&#34;&nbsp;</font><font color="#000000">name=</font><font color="#2a00ff">&#34;personForm:firstName&#34;&nbsp;</font><font color="#000000">value=</font><font color="#2a00ff">&#34;Jack&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;setinputfield&nbsp;description=</font><font color="#2a00ff">&#34;set&nbsp;lastName&#34;&nbsp;</font><font color="#000000">name=</font><font color="#2a00ff">&#34;personForm:lastName&#34;&nbsp;</font><font color="#000000">value=</font><font color="#2a00ff">&#34;Raible&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;clickbutton&nbsp;label=</font><font color="#2a00ff">&#34;${button.save}&#34;&nbsp;</font><font color="#000000">description=</font><font color="#2a00ff">&#34;Click&nbsp;button&nbsp;'Save'&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;verifytitle&nbsp;description=</font><font color="#2a00ff">&#34;Main&nbsp;Menu&nbsp;appears&nbsp;if&nbsp;save&nbsp;successful&#34;&nbsp;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">text=</font><font color="#2a00ff">&#34;.*${mainMenu.title}.*&#34;&nbsp;</font><font color="#000000">regex=</font><font color="#2a00ff">&#34;true&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;verifytext&nbsp;description=</font><font color="#2a00ff">&#34;verify&nbsp;success&nbsp;message&#34;&nbsp;</font><font color="#000000">text=</font><font color="#2a00ff">&#34;${person.added}&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/steps&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/webtest&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/target&gt;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;!--&nbsp;Delete&nbsp;existing&nbsp;person&nbsp;--&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;target&nbsp;name=</font><font color="#2a00ff">&#34;DeletePerson&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">description=</font><font color="#2a00ff">&#34;Deletes&nbsp;existing&nbsp;Person&#34;</font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;webtest&nbsp;name=</font><font color="#2a00ff">&#34;deletePerson&#34;</font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&amp;config;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;steps&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&amp;login;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;clicklink&nbsp;label=</font><font color="#2a00ff">&#34;Edit&nbsp;Person&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;prepareDialogResponse&nbsp;description=</font><font color="#2a00ff">&#34;Confirm&nbsp;delete&#34;&nbsp;</font><font color="#000000">dialogType=</font><font color="#2a00ff">&#34;confirm&#34;&nbsp;</font><font color="#000000">response=</font><font color="#2a00ff">&#34;true&#34;</font><font color="#000000">/&gt;&nbsp;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;clickbutton&nbsp;label=</font><font color="#2a00ff">&#34;${button.delete}&#34;&nbsp;</font><font color="#000000">description=</font><font color="#2a00ff">&#34;Click&nbsp;button&nbsp;'Delete'&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;verifyNoDialogResponses/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;verifytitle&nbsp;description=</font><font color="#2a00ff">&#34;display&nbsp;Main&nbsp;Menu&#34;&nbsp;</font><font color="#000000">text=</font><font color="#2a00ff">&#34;.*${mainMenu.title}.*&#34;&nbsp;</font><font color="#000000">regex=</font><font color="#2a00ff">&#34;true&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;verifytext&nbsp;description=</font><font color="#2a00ff">&#34;verify&nbsp;success&nbsp;message&#34;&nbsp;</font><font color="#000000">text=</font><font color="#2a00ff">&#34;${person.deleted}&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/steps&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/webtest&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/target&gt;</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>After adding this, you should be able to run <b>ant test-canoo -Dtestcase=PersonTests</b> with Tomcat running or <b>ant test-jsp -Dtestcase=PersonTests</b> if you want Ant to start/stop Tomcat for you.  To include the PersonTests when all Canoo tests are run, add it as a dependency to the "run-all-tests" target.
</p>
<p>You'll notice that there's no logging in the client-side window by Canoo.  If you'd like to see what it's doing, you can add <a class="external" href="http://webtest-community.canoo.com/wiki/space/WebTest+FAQ">tweak the log4j settings</a><img class="outlink" src="images/out.png" alt="" /> in web/WEB-INF/classes/log4j.properties.
</p>
<p></p>
<span style="color:green">BUILD SUCCESSFUL<br />
Total time: 11 seconds</span>
<p></p>
<hr />
<p><i>Next Up:</i> <b>Part IV:</b> <a class="wikipage" href="Wiki.jsp?page=ValidationAndListJSF">Adding Validation and List Screen</a> - Explains the validation logic on the personForm and how the firstName and lastName are required fields.  You'll also add a list screen to display all person records in the database.
</p>
<A NAME="Link_RunningOnOracle">
<h1>RunningOnOracle</h1>
</A>
The following instructions describe the steps needed to configure AppFuse so that the applications it generates will work with an Oracle database.
<h4 id='section-RunningOnOracle-TableOfContents'>Table of Contents</h4>
<ul>
<li> <a class="footnoteref" href="#ref-RunningOnOracle-1">[1]</a> Create Database Schema
</li>
<li> <a class="footnoteref" href="#ref-RunningOnOracle-2">[2]</a> Setup JDBC Driver
</li>
<li> <a class="footnoteref" href="#ref-RunningOnOracle-3">[3]</a> Edit build.properties in the main AppFuse Directory
</li>
<li> <a class="footnoteref" href="#ref-RunningOnOracle-4">[4]</a> Generate Application
</li>
<li> <a class="footnoteref" href="#ref-RunningOnOracle-5">[5]</a> Deploy Application
</li>
<li> <a class="footnoteref" href="#ref-RunningOnOracle-6">[6]</a> Test Database Access
</li>
</ul>
<h3 id='section-RunningOnOracle-CreateDatabaseSchema1'>Create Database Schema <a class="footnote" name="ref-RunningOnOracle-1">[#1]</a></h3>
<p>Create the Oracle Database schema account that will hold your application's tables.  This value should correspond to the <tt>-Ddb.name</tt> you use when running the <b>ant new</b> task.
</p>
<pre>
CREATE USER &lt;database-schema-owner&gt; IDENTIFIED BY &lt;password&gt;;  
GRANT CONNECT TO &lt;database-schema-owner&gt;;
GRANT RESOURCE TO &lt;database-schema-owner&gt;;
</pre>

<h3 id='section-RunningOnOracle-SetupJDBCDriver2'>Setup JDBC Driver <a class="footnote" name="ref-RunningOnOracle-2">[#2]</a></h3>
<p>Obtain the <a class="external" href="http://www.oracle.com/technology/software/tech/java/sqlj_jdbc/index.html">Oracle JDBC driver</a><img class="outlink" src="images/out.png" alt="" /> appropriate for your database and JDK version.  (Oracle's license agreement will be shown just be downloading, make sure you read and understand it.)  
</p>
<p><div class="note" style="margin: 10px"><b>NOTE:</b>  According to the <a class="external" href="http://www.oracle.com/technology/software/tech/java/sqlj_jdbc/htdocs/jdbc_readme9201.html">Oracle JDBC Driver README </a><img class="outlink" src="images/out.png" alt="" />, classes12.jar is for JDK1.2 & 1.3, ojdbc14.jar is for JDK 1.4.  The instructions here assume you will be using ojdbc14.jar, modify the instructions below accordingly if otherwise.</div>
</p>
<p>Next, in your {AppFuse home}/lib directory, add an "oracle" directory and place the ojdbc14.jar in it.
</p>
<p></p>
<h3 id='section-RunningOnOracle-EditBuild.propertiesInTheMainAppFuseDirectory3'>Edit build.properties in the main AppFuse Directory <a class="footnote" name="ref-RunningOnOracle-3">[#3]</a></h3>
<p>Next, the build.properties file needs to be updated to use an Oracle (instead of the default MySQL) database.
</p>
<p>Here is a idea of what the database entries should look like for Oracle (modify the various fields as appropriate for your system):
</p>
<pre>
database.jar=${lib.dir}/oracle/ojdbc14.jar
database.type=oracle
database.host=localhost
#use the database schema owner and password created in step #1 above here
database.username=username
database.password=password
database.schema=schemaname (case sensitive using 10g)

hibernate.dialect=org.hibernate.dialect.Oracle9Dialect
database.driver_class=oracle.jdbc.driver.OracleDriver
database.url=jdbc:oracle:thin:@localhost:1521:mySID
</pre>

<p>You'll also need to add the "database.schema" property to build.xml - in the &lt;dbunit&gt; tasks.  For example:
</p>
<pre>
&lt;dbunit driver="${database.driver_class}" schema="${database.schema}"
    supportBatchStatement="false" url="${database.url}"
    userid="${database.username}" password="${database.password}"&gt;
</pre>

<p><div class="note" style="margin: 10px; background-color: #fcc"><b>WARNING:</b>  Avoid the use of "appfuse" as values for any of the parameters here.  They may end up getting modified when you run the "ant new" task below.</div>
</p>
<p><div class="note" style="margin: 10px"><b>NOTE:</b>  In the listings above, <tt>database.host</tt> should refer to the machine the Oracle database is running on.  Also, the "mySID" at the end of the <tt>database.url</tt> value should refer to the SERVICE_NAME within the tnsnames.ora database file on the database server machine.</div>
</p>
<p><div class="note" style="margin: 10px"><b>NOTE:</b>  There is also a <tt>database.name</tt> parameter available, but you should only add it to <tt>build.properties</tt> if you want to use a different database name than provided in the <tt>-Ddb.name</tt> parameter when you ran the <b>ant new</b> task.</div>
</p>
<h3 id='section-RunningOnOracle-GenerateApplication4'>Generate Application <a class="footnote" name="ref-RunningOnOracle-4">[#4]</a></h3>
<p>Run <b>ant new -Dapp.name=<tt>myappname</tt> -Ddb.name=<tt>mydbname</tt></b> as usual to generate the new web application directory.
</p>
<p>For <tt>mydbname</tt>, use the schema owner name you created in Step #1 above.
</p>
<p></p>
<p></p>
<h3 id='section-RunningOnOracle-DeployApplication5'>Deploy Application <a class="footnote" name="ref-RunningOnOracle-5">[#5]</a></h3>
<p>Run "ant setup" within your new web app directory to compile and deploy your new application on Tomcat.
Next, Start Tomcat and bring up the application:  http://localhost:8080/myappname
</p>
<p><div class="note" style="margin: 10px">
<b>NOTE:</b>  The Oracle database server may be configured to occupy port 8080 with its own servlet container, which you may find very difficult to disable.  This can cause port conflicts if you are running Tomcat on the same machine.  If this problem occurs, it may be easiest to shut down the Oracle database, start Tomcat (so it will occupy port 8080), and then restart Oracle.
</div>
</p>
<h3 id='section-RunningOnOracle-TestDatabaseAccess6'>Test Database Access <a class="footnote" name="ref-RunningOnOracle-6">[#6]</a></h3>
<p>To test that database accesses are working properly, edit one of the profiles within the sample application and change the country listed.  Then, within Oracle SQL*Plus, log in as the schema owner and issue this command:  
</p>
<pre>
select username, country from app_user;  
</pre>

<p>If everything is working correctly, you should see that the country value has changed for the profile that you edited.
</p>
<p></p>
<A NAME="Link_SpringControllers">
<h1>SpringControllers</h1>
</A>
<b>Part III:</b> <a class="wikipage" href="Wiki.jsp?page=SpringControllers">Creating Controllers and JSPs</a> - A HowTo for creating <a class="external" href="http://www.springframework.org">Spring</a><img class="outlink" src="images/out.png" alt="" /> Controllers and JSPs in an <a class="wikipage" href="Wiki.jsp?page=AppFuse">AppFuse</a> project.
<dl>
<dt></dt><dd><i>This tutorial depends on <b>Part II:</b> <a class="wikipage" href="Wiki.jsp?page=CreateManager">Creating new Managers</a>.</i></dd>
</dl>
<h3 id='section-SpringControllers-AboutThisTutorial'>About this Tutorial</h3>
This tutorial will show you how to create Spring Controllers and JSPs.  It'll also demonstrate writing JUnit Tests to test your Controllers.  The Controller we create will talk to the PersonManager we created in the <a class="wikipage" href="Wiki.jsp?page=CreateManager">Creating Managers</a> tutorial.  
<dl>
<dt></dt><dd><span style="color: blue"><i>I will tell you how I do stuff in the <b>Real World</b> in text like this.</i></span></dd>
</dl>
<p>Let's get started by creating a new Controller and JSP in AppFuse's architecture.  If you haven't installed the Spring MVC module at this point, do so by running <i>ant install-springmvc</i>.
</p>
<h4 id='section-SpringControllers-TableOfContents'>Table of Contents</h4>
<ul>
<li> <a class="footnoteref" href="#ref-SpringControllers-1">[1]</a> Create skeleton JSPs using XDoclet
</li>
<li> <a class="footnoteref" href="#ref-SpringControllers-2">[2]</a> Create PersonFormControllerTest to test PersonFormController
</li>
<li> <a class="footnoteref" href="#ref-SpringControllers-3">[3]</a> Create PersonFormController 
</li>
<li> <a class="footnoteref" href="#ref-SpringControllers-4">[4]</a> Run PersonFormControllerTest
</li>
<li> <a class="footnoteref" href="#ref-SpringControllers-5">[5]</a> Clean up the JSP to make it presentable 
</li>
<li> <a class="footnoteref" href="#ref-SpringControllers-6">[6]</a> Create Canoo WebTests to test browser-like actions
</li>
</ul>
<h3 id='section-SpringControllers-CreateASkeletonJSPUsingXDoclet1'>Create a skeleton JSP using XDoclet <a class="footnote" name="ref-SpringControllers-1">[#1]</a></h3>
In this step, you'll generate a JSP page to display information from the Person object.  It will contain Spring's JSP tags that render table rows for each property in Person.java.  The <a class="wikipage" href="Wiki.jsp?page=AppGen">AppGen</a> tool that's used to do this is based off a StrutsGen tool - which was originally written by <a class="external" href="http://www.blogscene.org/erik/">Erik Hatcher</a><img class="outlink" src="images/out.png" alt="" />.  It's basically just a couple of classes and a bunch of XDoclet templates.  All these files are located in extras/appgen.
<p>Here are the simple steps to generating the JSP and a properties file containing the labels for the form elements:
</p>
<ul>
<li> From the command-line, navigate to "extras/appgen"
</li>
<li> Execute <b>ant -Dobject.name=Person -Dappgen.type=pojo</b> to generate a bunch of files in extras/appgen/build/gen.  In fact, it'll generate all the files you need to complete this tutorial.  However, let's just grab the ones you need.
<ul>
<li> web/WEB-INF/classes/Person.properties (labels for your form elements) 
</li>
<li> web/pages/personForm.jsp (JSP file for viewing a single Person)
</li>
<li> web/pages/personList.jsp (JSP file for viewing a list of People)
</li>
</ul>
</li>
<li> Copy the contents of Person.properties into web/WEB-INF/classes/ApplicationResources.properties.  These are all the keys you will need for titles/headings and form properties.  Here is an example of what you should add to ApplicationResources.properties:
</li>
</ul>
<div style="margin-left: 40px">
<pre>
# -- person form --
person.id=Id
person.firstName=First Name
person.lastName=Last Name

person.added=Person has been added successfully.
person.updated=Person has been updated successfully.
person.deleted=Person has been deleted successfully.

# -- person list page --
personList.title=Person List
personList.heading=Persons

# -- person detail page --
personDetail.title=Person Detail
personDetail.heading=Person Information
</pre>

</div>
<ul>
<li> Copy personForm.jsp to web/pages/personForm.jsp.  Copy personList.jsp to web/pages/personList.jsp.   
</li>
</ul>
<dl>
<dt></dt><dd> <i>The files in the "pages" directory will end up in "WEB-INF/pages" at deployment time. The container provides security for all files below WEB-INF.  This applies to client requests, but not to forwards from the DispatchServlet. Placing all JSPs below WEB-INF ensures they are only accessed through Controllers, and not directly by the client or each other. This allows security to be moved up into the Controller, where it can be handled more efficiently, and out of the base presentation layer.</i></dd>
</dl>
<p>The web application security for AppFuse specifies that all *.html url-patterns should be protected (except for /signup.html and /passwordHint.html).  This guarantees that clients must go through an Action to get to a JSP (or at least the ones in <i>pages</i>).  
</p>
<span class="note"><b>NOTE:</b> If you want to customize the CSS for a particular page, you can add &lt;body id="pageName"/> to the top of the file.  This will be slurped up by SiteMesh and put into the final page.  You can then customize your CSS on a page-by-page basis using something like the following: 
<pre>body#pageName element.class { background-color: blue } </pre>
</span>
<ul>
<li> Add keys in ApplicationResources.properties the titles and headings in the JSPs
</li>
</ul>
In the generated JSPs, there are two keys for the title (top of the browser window) and the header (heading in the page).  We now need to add these two keys (personDetail.title and personDetail.heading) to ApplicationResources.properties.
<pre>
# -- person detail page --
personDetail.title=Person Detail
personDetail.heading=Person Information
</pre>

<dl>
<dt></dt><dd><i>Just above, we added "personForm.*" keys to this file, so why do I use personForm </i>and<i> personDetail?  The best reason is because it gives a nice separation between form labels and text on the page.  Another reason is because all the *Form.* give you a nice representation of all the fields in your database.  </dd>
</dl>
<p>I recently had a client who wanted all fields in the database searchable.  This was fairly easy to do.  I just looked up all the keys in ApplicationResources.properties which contained "Form." and then put them into a drop-down.  On the UI, the user was able to enter a search term and select the column they wanted to search.  I was glad I followed this Form vs. Detail distinction on that project!</i>
</p>
<p></p>
<h3 id='section-SpringControllers-CreatePersonFormControllerTestToTestPersonFormController2'>Create PersonFormControllerTest to test PersonFormController <a class="footnote" name="ref-SpringControllers-2">[#2]</a></h3>
To create a JUnit Test for the PersonFormController, start by creating a PersonFormControllerTest.java file in the test/web/**/action directory.
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#7f0055"><b>package&nbsp;</b></font><font color="#000000">org.appfuse.webapp.action;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">org.appfuse.model.Person;</font><br/>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">org.springframework.mock.web.MockHttpServletRequest;</font><br/>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">org.springframework.mock.web.MockHttpServletResponse;</font><br/>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">org.springframework.validation.BindException;</font><br/>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">org.springframework.validation.Errors;</font><br/>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">org.springframework.web.servlet.ModelAndView;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#7f0055"><b>public&nbsp;class&nbsp;</b></font><font color="#000000">PersonFormControllerTest&nbsp;</font><font color="#7f0055"><b>extends&nbsp;</b></font><font color="#000000">BaseControllerTestCase&nbsp;</font><font color="#000000">{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>private&nbsp;</b></font><font color="#000000">PersonFormController&nbsp;c;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>private&nbsp;</b></font><font color="#000000">MockHttpServletRequest&nbsp;request;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>private&nbsp;</b></font><font color="#000000">ModelAndView&nbsp;mv;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>protected&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">setUp</font><font color="#000000">()&nbsp;</font><font color="#7f0055"><b>throws&nbsp;</b></font><font color="#000000">Exception&nbsp;</font><font color="#000000">{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f7f5f">//&nbsp;needed&nbsp;to&nbsp;initialize&nbsp;a&nbsp;user</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>super</b></font><font color="#000000">.setUp</font><font color="#000000">()</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">c&nbsp;=&nbsp;</font><font color="#000000">(</font><font color="#000000">PersonFormController</font><font color="#000000">)&nbsp;</font><font color="#000000">ctx.getBean</font><font color="#000000">(</font><font color="#2a00ff">&#34;personFormController&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>protected&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">tearDown</font><font color="#000000">()&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">c&nbsp;=&nbsp;</font><font color="#7f0055"><b>null</b></font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">testEdit</font><font color="#000000">()&nbsp;</font><font color="#7f0055"><b>throws&nbsp;</b></font><font color="#000000">Exception&nbsp;</font><font color="#000000">{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">log.debug</font><font color="#000000">(</font><font color="#2a00ff">&#34;testing&nbsp;edit...&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">request&nbsp;=&nbsp;newGet</font><font color="#000000">(</font><font color="#2a00ff">&#34;/editPerson.html&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">request.addParameter</font><font color="#000000">(</font><font color="#2a00ff">&#34;username&#34;</font><font color="#000000">,&nbsp;</font><font color="#2a00ff">&#34;tomcat&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">mv&nbsp;=&nbsp;c.handleRequest</font><font color="#000000">(</font><font color="#000000">request,&nbsp;</font><font color="#7f0055"><b>new&nbsp;</b></font><font color="#000000">MockHttpServletResponse</font><font color="#000000">())</font><font color="#000000">;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">assertEquals</font><font color="#000000">(</font><font color="#2a00ff">&#34;personForm&#34;</font><font color="#000000">,&nbsp;mv.getViewName</font><font color="#000000">())</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">testSave</font><font color="#000000">()&nbsp;</font><font color="#7f0055"><b>throws&nbsp;</b></font><font color="#000000">Exception&nbsp;</font><font color="#000000">{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">request&nbsp;=&nbsp;newGet</font><font color="#000000">(</font><font color="#2a00ff">&#34;/editPerson.html&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">request.addParameter</font><font color="#000000">(</font><font color="#2a00ff">&#34;id&#34;</font><font color="#000000">,&nbsp;</font><font color="#2a00ff">&#34;1&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">mv&nbsp;=&nbsp;c.handleRequest</font><font color="#000000">(</font><font color="#000000">request,&nbsp;</font><font color="#7f0055"><b>new&nbsp;</b></font><font color="#000000">MockHttpServletResponse</font><font color="#000000">())</font><font color="#000000">;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">Person&nbsp;person&nbsp;=&nbsp;</font><font color="#000000">(</font><font color="#000000">Person</font><font color="#000000">)&nbsp;</font><font color="#000000">mv.getModel</font><font color="#000000">()</font><font color="#000000">.get</font><font color="#000000">(</font><font color="#000000">c.getCommandName</font><font color="#000000">())</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">assertNotNull</font><font color="#000000">(</font><font color="#000000">person</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">request&nbsp;=&nbsp;newPost</font><font color="#000000">(</font><font color="#2a00ff">&#34;/editPerson.html&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>super</b></font><font color="#000000">.objectToRequestParameters</font><font color="#000000">(</font><font color="#000000">person,&nbsp;request</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">request.addParameter</font><font color="#000000">(</font><font color="#2a00ff">&#34;lastName&#34;</font><font color="#000000">,&nbsp;</font><font color="#2a00ff">&#34;Updated&nbsp;Last&nbsp;Name&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">mv&nbsp;=&nbsp;c.handleRequest</font><font color="#000000">(</font><font color="#000000">request,&nbsp;</font><font color="#7f0055"><b>new&nbsp;</b></font><font color="#000000">MockHttpServletResponse</font><font color="#000000">())</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">Errors&nbsp;errors&nbsp;=</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">(</font><font color="#000000">Errors</font><font color="#000000">)&nbsp;</font><font color="#000000">mv.getModel</font><font color="#000000">()</font><font color="#000000">.get</font><font color="#000000">(</font><font color="#000000">BindException.ERROR_KEY_PREFIX&nbsp;+&nbsp;</font><font color="#2a00ff">&#34;person&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">assertNull</font><font color="#000000">(</font><font color="#000000">errors</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">assertNotNull</font><font color="#000000">(</font><font color="#000000">request.getSession</font><font color="#000000">()</font><font color="#000000">.getAttribute</font><font color="#000000">(</font><font color="#2a00ff">&#34;messages&#34;</font><font color="#000000">))</font><font color="#000000">;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">testRemove</font><font color="#000000">()&nbsp;</font><font color="#7f0055"><b>throws&nbsp;</b></font><font color="#000000">Exception&nbsp;</font><font color="#000000">{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">request&nbsp;=&nbsp;newPost</font><font color="#000000">(</font><font color="#2a00ff">&#34;/editPerson.html&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">request.addParameter</font><font color="#000000">(</font><font color="#2a00ff">&#34;delete&#34;</font><font color="#000000">,&nbsp;</font><font color="#2a00ff">&#34;&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">request.addParameter</font><font color="#000000">(</font><font color="#2a00ff">&#34;id&#34;</font><font color="#000000">,&nbsp;</font><font color="#2a00ff">&#34;2&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">mv&nbsp;=&nbsp;c.handleRequest</font><font color="#000000">(</font><font color="#000000">request,&nbsp;</font><font color="#7f0055"><b>new&nbsp;</b></font><font color="#000000">MockHttpServletResponse</font><font color="#000000">())</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">assertNotNull</font><font color="#000000">(</font><font color="#000000">request.getSession</font><font color="#000000">()</font><font color="#000000">.getAttribute</font><font color="#000000">(</font><font color="#2a00ff">&#34;messages&#34;</font><font color="#000000">))</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#000000">}</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>Nothing will compile at this point (ant compile) because you need to create the PersonFormController that you're referring to in this test.
</p>
<p></p>
<h3 id='section-SpringControllers-CreatePersonFormController3'>Create PersonFormController <a class="footnote" name="ref-SpringControllers-3">[#3]</a></h3>
<p>In src/web/**/action, create a PersonFormController.java file with the following contents:
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#7f0055"><b>package&nbsp;</b></font><font color="#000000">org.appfuse.webapp.action;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">java.util.Locale;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">javax.servlet.http.HttpServletRequest;</font><br/>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">javax.servlet.http.HttpServletResponse;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">org.apache.commons.lang.StringUtils;</font><br/>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">org.appfuse.model.Person;</font><br/>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">org.appfuse.service.PersonManager;</font><br/>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">org.springframework.validation.BindException;</font><br/>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">org.springframework.web.servlet.ModelAndView;</font><br/>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">org.springframework.web.servlet.view.RedirectView;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#7f0055"><b>public&nbsp;class&nbsp;</b></font><font color="#000000">PersonFormController&nbsp;</font><font color="#7f0055"><b>extends&nbsp;</b></font><font color="#000000">BaseFormController&nbsp;</font><font color="#000000">{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>private&nbsp;</b></font><font color="#000000">PersonManager&nbsp;mgr&nbsp;=&nbsp;</font><font color="#7f0055"><b>null</b></font><font color="#000000">;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">setPersonManager</font><font color="#000000">(</font><font color="#000000">PersonManager&nbsp;mgr</font><font color="#000000">)&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>this</b></font><font color="#000000">.mgr&nbsp;=&nbsp;mgr;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>protected&nbsp;</b></font><font color="#000000">Object&nbsp;formBackingObject</font><font color="#000000">(</font><font color="#000000">HttpServletRequest&nbsp;request</font><font color="#000000">)</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>throws&nbsp;</b></font><font color="#000000">Exception&nbsp;</font><font color="#000000">{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">String&nbsp;id&nbsp;=&nbsp;request.getParameter</font><font color="#000000">(</font><font color="#2a00ff">&#34;id&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">Person&nbsp;person&nbsp;=&nbsp;</font><font color="#7f0055"><b>null</b></font><font color="#000000">;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>if&nbsp;</b></font><font color="#000000">(</font><font color="#000000">!StringUtils.isEmpty</font><font color="#000000">(</font><font color="#000000">id</font><font color="#000000">))&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">person&nbsp;=&nbsp;mgr.getPerson</font><font color="#000000">(</font><font color="#000000">id</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}&nbsp;</font><font color="#7f0055"><b>else&nbsp;</b></font><font color="#000000">{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">person&nbsp;=&nbsp;</font><font color="#7f0055"><b>new&nbsp;</b></font><font color="#000000">Person</font><font color="#000000">()</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>return&nbsp;</b></font><font color="#000000">person;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#000000">ModelAndView&nbsp;processFormSubmission</font><font color="#000000">(</font><font color="#000000">HttpServletRequest&nbsp;request,</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">HttpServletResponse&nbsp;response,</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">Object&nbsp;command,</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">BindException&nbsp;errors</font><font color="#000000">)</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>throws&nbsp;</b></font><font color="#000000">Exception&nbsp;</font><font color="#000000">{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>if&nbsp;</b></font><font color="#000000">(</font><font color="#000000">request.getParameter</font><font color="#000000">(</font><font color="#2a00ff">&#34;cancel&#34;</font><font color="#000000">)&nbsp;</font><font color="#000000">!=&nbsp;</font><font color="#7f0055"><b>null</b></font><font color="#000000">)&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>return&nbsp;new&nbsp;</b></font><font color="#000000">ModelAndView</font><font color="#000000">(</font><font color="#7f0055"><b>new&nbsp;</b></font><font color="#000000">RedirectView</font><font color="#000000">(</font><font color="#000000">getSuccessView</font><font color="#000000">()))</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>return&nbsp;super</b></font><font color="#000000">.processFormSubmission</font><font color="#000000">(</font><font color="#000000">request,&nbsp;response,&nbsp;command,&nbsp;errors</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#000000">ModelAndView&nbsp;onSubmit</font><font color="#000000">(</font><font color="#000000">HttpServletRequest&nbsp;request,</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">HttpServletResponse&nbsp;response,&nbsp;Object&nbsp;command,</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">BindException&nbsp;errors</font><font color="#000000">)</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>throws&nbsp;</b></font><font color="#000000">Exception&nbsp;</font><font color="#000000">{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>if&nbsp;</b></font><font color="#000000">(</font><font color="#000000">log.isDebugEnabled</font><font color="#000000">())&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">log.debug</font><font color="#000000">(</font><font color="#2a00ff">&#34;entering&nbsp;'onSubmit'&nbsp;method...&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">Person&nbsp;person&nbsp;=&nbsp;</font><font color="#000000">(</font><font color="#000000">Person</font><font color="#000000">)&nbsp;</font><font color="#000000">command;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>boolean&nbsp;</b></font><font color="#000000">isNew&nbsp;=&nbsp;</font><font color="#000000">(</font><font color="#000000">person.getId</font><font color="#000000">()&nbsp;</font><font color="#000000">==&nbsp;</font><font color="#7f0055"><b>null</b></font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">String&nbsp;success&nbsp;=&nbsp;getSuccessView</font><font color="#000000">()</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">Locale&nbsp;locale&nbsp;=&nbsp;request.getLocale</font><font color="#000000">()</font><font color="#000000">;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>if&nbsp;</b></font><font color="#000000">(</font><font color="#000000">request.getParameter</font><font color="#000000">(</font><font color="#2a00ff">&#34;delete&#34;</font><font color="#000000">)&nbsp;</font><font color="#000000">!=&nbsp;</font><font color="#7f0055"><b>null</b></font><font color="#000000">)&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">mgr.removePerson</font><font color="#000000">(</font><font color="#000000">person.getId</font><font color="#000000">()</font><font color="#000000">.toString</font><font color="#000000">())</font><font color="#000000">;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">saveMessage</font><font color="#000000">(</font><font color="#000000">request,&nbsp;getText</font><font color="#000000">(</font><font color="#2a00ff">&#34;person.deleted&#34;</font><font color="#000000">,&nbsp;locale</font><font color="#000000">))</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}&nbsp;</font><font color="#7f0055"><b>else&nbsp;</b></font><font color="#000000">{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">mgr.savePerson</font><font color="#000000">(</font><font color="#000000">person</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">String&nbsp;key&nbsp;=&nbsp;</font><font color="#000000">(</font><font color="#000000">isNew</font><font color="#000000">)&nbsp;</font><font color="#000000">?&nbsp;</font><font color="#2a00ff">&#34;person.added&#34;&nbsp;</font><font color="#000000">:&nbsp;</font><font color="#2a00ff">&#34;person.updated&#34;</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">saveMessage</font><font color="#000000">(</font><font color="#000000">request,&nbsp;getText</font><font color="#000000">(</font><font color="#000000">key,&nbsp;locale</font><font color="#000000">))</font><font color="#000000">;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>if&nbsp;</b></font><font color="#000000">(</font><font color="#000000">!isNew</font><font color="#000000">)&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">success&nbsp;=&nbsp;</font><font color="#2a00ff">&#34;editPerson.html?id=&#34;&nbsp;</font><font color="#000000">+&nbsp;person.getId</font><font color="#000000">()</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>return&nbsp;new&nbsp;</b></font><font color="#000000">ModelAndView</font><font color="#000000">(</font><font color="#7f0055"><b>new&nbsp;</b></font><font color="#000000">RedirectView</font><font color="#000000">(</font><font color="#000000">success</font><font color="#000000">))</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#000000">}</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>In the class above, there are a few methods you might not be familiar with.  The <tt>formBackingObject()</tt> method is used to supply the object this Controller operates on.  The <tt>processFormSubmission()</tt> method is used to detect the cancel button, and <tt>onSubmit()</tt> is called on POST requests and handles delete/add/update of a user.
</p>
<p>There are a few keys you (might) need to add to ApplicationResources.properties to display the success messages.  This file is located in <i>web/WEB-INF/classes</i> - open it and add the following:
</p>
<dl>
<dt></dt><dd><i>I usually add these under the <tt># -- success messages --</tt> comment.</i></dd>
</dl>
<pre>person.added=Person has been added successfully.
person.updated=Person has been updated successfully.
person.deleted=Person has been deleted successfully.
</pre>

<p>You could use generic <i>added</i>, <i>deleted</i> and <i>updated</i> messages, whatever works for you.  It's nice to have separate messages in case these need to change on a per-entity basis.
</p>
<p>You might notice that the code we're using to call the PersonManager is the same as the code we used in our PersonManagerTest.  Both PersonFormController and PersonManagerTest are <i>clients</i> of PersonManagerImpl, so this makes perfect sense.
</p>
<p>Now you need to add a url-mapping for this controller in the web/WEB-INF/action-servlet.xml file.  In the block below, the new line is at the bottom, with <b>&lt;prop key="/editPerson.html"&gt;</b>:
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;bean&nbsp;id=</font><font color="#2a00ff">&#34;urlMapping&#34;&nbsp;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>class</b></font><font color="#000000">=</font><font color="#2a00ff">&#34;org.springframework.web.servlet.handler.SimpleUrlHandlerMapping&#34;</font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;property&nbsp;name=</font><font color="#2a00ff">&#34;mappings&#34;</font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;props&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;prop&nbsp;key=</font><font color="#2a00ff">&#34;/editProfile.html&#34;</font><font color="#000000">&gt;userFormController&lt;/prop&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;prop&nbsp;key=</font><font color="#2a00ff">&#34;/mainMenu.html&#34;</font><font color="#000000">&gt;filenameController&lt;/prop&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;prop&nbsp;key=</font><font color="#2a00ff">&#34;/editUser.html&#34;</font><font color="#000000">&gt;userFormController&lt;/prop&gt;&nbsp;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;prop&nbsp;key=</font><font color="#2a00ff">&#34;/selectFile.html&#34;</font><font color="#000000">&gt;filenameController&lt;/prop&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;prop&nbsp;key=</font><font color="#2a00ff">&#34;/uploadFile.html&#34;</font><font color="#000000">&gt;fileUploadController&lt;/prop&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;prop&nbsp;key=</font><font color="#2a00ff">&#34;/passwordHint.xml&#34;</font><font color="#000000">&gt;passwordHintController&lt;/prop&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;prop&nbsp;key=</font><font color="#2a00ff">&#34;/signup.xml&#34;</font><font color="#000000">&gt;signupController&lt;/prop&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;prop&nbsp;key=</font><font color="#2a00ff">&#34;/editPerson.html&#34;</font><font color="#000000">&gt;personFormController&lt;/prop&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/props&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/property&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/bean&gt;</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>You also need to add the &lt;bean&gt; definition for personFormController in this same file:
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;bean&nbsp;id=</font><font color="#2a00ff">&#34;personFormController&#34;&nbsp;</font><font color="#7f0055"><b>class</b></font><font color="#000000">=</font><font color="#2a00ff">&#34;org.appfuse.webapp.action.PersonFormController&#34;</font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;property&nbsp;name=</font><font color="#2a00ff">&#34;commandName&#34;</font><font color="#000000">&gt;&lt;value&gt;person&lt;/value&gt;&lt;/property&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;property&nbsp;name=</font><font color="#2a00ff">&#34;commandClass&#34;</font><font color="#000000">&gt;&lt;value&gt;org.appfuse.model.Person&lt;/value&gt;&lt;/property&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;!--property&nbsp;name=</font><font color="#2a00ff">&#34;validator&#34;</font><font color="#000000">&gt;&lt;ref&nbsp;bean=</font><font color="#2a00ff">&#34;beanValidator&#34;</font><font color="#000000">/&gt;&lt;/property--&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;property&nbsp;name=</font><font color="#2a00ff">&#34;formView&#34;</font><font color="#000000">&gt;&lt;value&gt;personForm&lt;/value&gt;&lt;/property&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;property&nbsp;name=</font><font color="#2a00ff">&#34;successView&#34;</font><font color="#000000">&gt;&lt;value&gt;mainMenu.html&lt;/value&gt;&lt;/property&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;property&nbsp;name=</font><font color="#2a00ff">&#34;personManager&#34;</font><font color="#000000">&gt;&lt;ref&nbsp;bean=</font><font color="#2a00ff">&#34;personManager&#34;</font><font color="#000000">/&gt;&lt;/property&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/bean&gt;</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<dl>
<dt></dt><dd><i>The "validator" property is commented out in the above XML block because we haven't defined any validation rules for the Person object.  We'll uncomment this value when we add validation.</i></dd>
</dl>
<h3 id='section-SpringControllers-RunThePersonFormControllerTest4'>Run the PersonFormControllerTest <a class="footnote" name="ref-SpringControllers-4">[#4]</a></h3>
If you look at our PersonFormControllerTest, all the tests depend on having a record with id=1 in the database (and testRemove depends on id=2), so let's add those records to our sample data file (metadata/sql/sample-data.xml). I'd just add it at the bottom - order is not important since it (currently) does not relate to any other tables.
<pre>
  &lt;table name='person'&gt;
    &lt;column&gt;id&lt;/column&gt;
    &lt;column&gt;first_name&lt;/column&gt;
    &lt;column&gt;last_name&lt;/column&gt;
    &lt;row&gt;
      &lt;value&gt;1&lt;/value&gt;
      &lt;value&gt;Matt&lt;/value&gt;
      &lt;value&gt;Raible&lt;/value&gt;
    &lt;/row&gt;
    &lt;row&gt;
      &lt;value&gt;2&lt;/value&gt;
      &lt;value&gt;James&lt;/value&gt;
      &lt;value&gt;Davidson&lt;/value&gt;
    &lt;/row&gt;
  &lt;/table&gt;
</pre>

<p>DBUnit loads this file before we running any of the tests, so this record will be available to your Controller test.
</p>
<p>Make sure are in the base directory of your project.  If you run <b>ant test-web -Dtestcase=PersonFormController</b> - everything should work as planned.  
</p>
<span style="color:green">BUILD SUCCESSFUL<br />
Total time: 21 seconds</span>
<p></p>
<h3 id='section-SpringControllers-CleanUpTheJSPToMakeItPresentable5'>Clean up the JSP to make it presentable <a class="footnote" name="ref-SpringControllers-5">[#5]</a></h3>
<p>If you want to add a usability enhancement to your form, you can set the cursor to focus on the first field when the page loads.  Simply add the following JavaScript at the bottom of your form:
</p>
<pre>&lt;script type="text/javascript"&gt;
    document.forms["person"].elements["firstName"].focus();
&lt;/script&gt;</pre>
  
<p>Now if you execute <b>ant db-load deploy</b>, start Tomcat and point your browser to <a class="external" href="http://localhost:8080/appfuse/editPerson.html?id=1">http://localhost:8080/appfuse/editPerson.html?id=1</a><img class="outlink" src="images/out.png" alt="" />, you should see something like this:
</p>
<div style="border: 1px solid black; margin: 0 auto; height: 166px; width: 337px">
<img class="inline" src="attach/CreateActions/personForm-final.png" alt="CreateActions/personForm-final.png" />
</div>
<p>Finally, to make this page more user friendly, you may want to add a message for your users at the top of the form, but this can easily be done by adding text (using &lt;fmt:message&gt;) at the top of the personForm.jsp page.
</p>
<h3 id='section-SpringControllers-OptionalCreateACanooWebTestToTestBrowserLikeActions6'>[Optional] Create a Canoo WebTest to test browser-like actions <a class="footnote" name="ref-SpringControllers-6">[#6]</a></h3>
The final (optional) step in this tutorial is to create a <a class="external" href="http://webtest.canoo.com">Canoo WebTest</a><img class="outlink" src="images/out.png" alt="" /> to test the JSPs.  
<dl>
<dt></dt><dd><i>I say this step is optional, because you can run the same tests through your browser.</i></dd>
</dl>
<p>You can use the following URLs to test the different actions for adding, editing and saving a user.
</p>
<ul>
<li> Add - <a class="external" href="http://localhost:8080/appfuse/editPerson.html">http://localhost:8080/appfuse/editPerson.html</a><img class="outlink" src="images/out.png" alt="" />.
</li>
<li> Edit - <a class="external" href="http://localhost:8080/appfuse/editPerson.html?id=1">http://localhost:8080/appfuse/editPerson.html?id=1</a><img class="outlink" src="images/out.png" alt="" /> (make sure and run <b>ant db-load</b> first).
</li>
<li> Delete - <a class="external" href="http://localhost:8080/appfuse/editPerson.html?method=Delete&amp;amp;id=1">http://localhost:8080/appfuse/editPerson.html?method=Delete&amp;amp;id=1</a><img class="outlink" src="images/out.png" alt="" /> (or edit and click on the Delete button).
</li>
<li> Save - Click <a class="external" href="http://localhost:8080/appfuse/editPerson.html?id=1">edit</a><img class="outlink" src="images/out.png" alt="" /> and then click the Save button.
</li>
</ul>
<p>Canoo tests are pretty slick in that they're simply configured in an XML file.  To add tests for add, edit, save and delete, open test/web/web-tests.xml and add the following XML.  You'll notice that this fragment has a target named <i>PersonTests</i> that runs all the related tests.  
</p>
<dl>
<dt></dt><dd><i>I use CamelCase target names (vs. the traditional lowercase, dash-separated) because when you're typing </i>-Dtestcase=Name<i>, I've found that I'm used to doing CamelCase for my JUnit Tests.</i></dd>
</dl>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#000000">&lt;!--&nbsp;runs&nbsp;person-related&nbsp;tests&nbsp;--&gt;</font><br/>
<font color="#000000">&lt;target&nbsp;name=</font><font color="#2a00ff">&#34;PersonTests&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">depends=</font><font color="#2a00ff">&#34;EditPerson,SavePerson,AddPerson,DeletePerson&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">description=</font><font color="#2a00ff">&#34;Call&nbsp;and&nbsp;executes&nbsp;all&nbsp;person&nbsp;test&nbsp;cases&nbsp;(targets)&#34;</font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;echo&gt;Successfully&nbsp;ran&nbsp;all&nbsp;Person&nbsp;JSP&nbsp;tests!&lt;/echo&gt;</font><br/>
<font color="#000000">&lt;/target&gt;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#000000">&lt;!--&nbsp;Verify&nbsp;the&nbsp;edit&nbsp;person&nbsp;screen&nbsp;displays&nbsp;without&nbsp;errors&nbsp;--&gt;</font><br/>
<font color="#000000">&lt;target&nbsp;name=</font><font color="#2a00ff">&#34;EditPerson&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">description=</font><font color="#2a00ff">&#34;Tests&nbsp;editing&nbsp;an&nbsp;existing&nbsp;Person's&nbsp;information&#34;</font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;webtest&nbsp;name=</font><font color="#2a00ff">&#34;editPerson&#34;</font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&amp;config;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;steps&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&amp;login;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;invoke&nbsp;description=</font><font color="#2a00ff">&#34;click&nbsp;Edit&nbsp;Person&nbsp;link&#34;&nbsp;</font><font color="#000000">url=</font><font color="#2a00ff">&#34;/editPerson.html?id=1&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;verifytitle&nbsp;description=</font><font color="#2a00ff">&#34;we&nbsp;should&nbsp;see&nbsp;the&nbsp;personDetail&nbsp;title&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">text=</font><font color="#2a00ff">&#34;.*${personDetail.title}.*&#34;&nbsp;</font><font color="#000000">regex=</font><font color="#2a00ff">&#34;true&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/steps&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/webtest&gt;</font><br/>
<font color="#000000">&lt;/target&gt;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#000000">&lt;!--&nbsp;Edit&nbsp;a&nbsp;person&nbsp;and&nbsp;then&nbsp;save&nbsp;--&gt;</font><br/>
<font color="#000000">&lt;target&nbsp;name=</font><font color="#2a00ff">&#34;SavePerson&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">description=</font><font color="#2a00ff">&#34;Tests&nbsp;editing&nbsp;and&nbsp;saving&nbsp;a&nbsp;user&#34;</font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;webtest&nbsp;name=</font><font color="#2a00ff">&#34;savePerson&#34;</font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&amp;config;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;steps&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&amp;login;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;invoke&nbsp;description=</font><font color="#2a00ff">&#34;click&nbsp;Edit&nbsp;Person&nbsp;link&#34;&nbsp;</font><font color="#000000">url=</font><font color="#2a00ff">&#34;/editPerson.html?id=1&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;verifytitle&nbsp;description=</font><font color="#2a00ff">&#34;we&nbsp;should&nbsp;see&nbsp;the&nbsp;personDetail&nbsp;title&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">text=</font><font color="#2a00ff">&#34;.*${personDetail.title}.*&#34;&nbsp;</font><font color="#000000">regex=</font><font color="#2a00ff">&#34;true&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;setinputfield&nbsp;description=</font><font color="#2a00ff">&#34;set&nbsp;lastName&#34;&nbsp;</font><font color="#000000">name=</font><font color="#2a00ff">&#34;lastName&#34;&nbsp;</font><font color="#000000">value=</font><font color="#2a00ff">&#34;Canoo&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;clickbutton&nbsp;label=</font><font color="#2a00ff">&#34;Save&#34;&nbsp;</font><font color="#000000">description=</font><font color="#2a00ff">&#34;Click&nbsp;Save&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;verifytitle&nbsp;description=</font><font color="#2a00ff">&#34;Page&nbsp;re-appears&nbsp;if&nbsp;save&nbsp;successful&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">text=</font><font color="#2a00ff">&#34;.*${personDetail.title}.*&#34;&nbsp;</font><font color="#000000">regex=</font><font color="#2a00ff">&#34;true&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;verifytext&nbsp;description=</font><font color="#2a00ff">&#34;verify&nbsp;success&nbsp;message&#34;&nbsp;</font><font color="#000000">text=</font><font color="#2a00ff">&#34;${person.updated}&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/steps&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/webtest&gt;</font><br/>
<font color="#000000">&lt;/target&gt;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#000000">&lt;!--&nbsp;Add&nbsp;a&nbsp;</font><font color="#7f0055"><b>new&nbsp;</b></font><font color="#000000">Person&nbsp;--&gt;</font><br/>
<font color="#000000">&lt;target&nbsp;name=</font><font color="#2a00ff">&#34;AddPerson&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">description=</font><font color="#2a00ff">&#34;Adds&nbsp;a&nbsp;new&nbsp;Person&#34;</font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;webtest&nbsp;name=</font><font color="#2a00ff">&#34;addPerson&#34;</font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&amp;config;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;steps&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&amp;login;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;invoke&nbsp;description=</font><font color="#2a00ff">&#34;click&nbsp;Add&nbsp;Button&#34;&nbsp;</font><font color="#000000">url=</font><font color="#2a00ff">&#34;/editPerson.html&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;verifytitle&nbsp;description=</font><font color="#2a00ff">&#34;we&nbsp;should&nbsp;see&nbsp;the&nbsp;personDetail&nbsp;title&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">text=</font><font color="#2a00ff">&#34;.*${personDetail.title}.*&#34;&nbsp;</font><font color="#000000">regex=</font><font color="#2a00ff">&#34;true&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;setinputfield&nbsp;description=</font><font color="#2a00ff">&#34;set&nbsp;firstName&#34;&nbsp;</font><font color="#000000">name=</font><font color="#2a00ff">&#34;firstName&#34;&nbsp;</font><font color="#000000">value=</font><font color="#2a00ff">&#34;Abbie&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;setinputfield&nbsp;description=</font><font color="#2a00ff">&#34;set&nbsp;lastName&#34;&nbsp;</font><font color="#000000">name=</font><font color="#2a00ff">&#34;lastName&#34;&nbsp;</font><font color="#000000">value=</font><font color="#2a00ff">&#34;Raible&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;clickbutton&nbsp;label=</font><font color="#2a00ff">&#34;${button.save}&#34;&nbsp;</font><font color="#000000">description=</font><font color="#2a00ff">&#34;Click&nbsp;button&nbsp;'Save'&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;verifytitle&nbsp;description=</font><font color="#2a00ff">&#34;Main&nbsp;Menu&nbsp;appears&nbsp;if&nbsp;save&nbsp;successful&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">text=</font><font color="#2a00ff">&#34;.*${mainMenu.title}.*&#34;&nbsp;</font><font color="#000000">regex=</font><font color="#2a00ff">&#34;true&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;verifytext&nbsp;description=</font><font color="#2a00ff">&#34;verify&nbsp;success&nbsp;message&#34;&nbsp;</font><font color="#000000">text=</font><font color="#2a00ff">&#34;${person.added}&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/steps&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/webtest&gt;</font><br/>
<font color="#000000">&lt;/target&gt;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#000000">&lt;!--&nbsp;Delete&nbsp;existing&nbsp;person&nbsp;--&gt;</font><br/>
<font color="#000000">&lt;target&nbsp;name=</font><font color="#2a00ff">&#34;DeletePerson&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">description=</font><font color="#2a00ff">&#34;Deletes&nbsp;existing&nbsp;Person&#34;</font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;webtest&nbsp;name=</font><font color="#2a00ff">&#34;deletePerson&#34;</font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&amp;config;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;steps&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&amp;login;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;invoke&nbsp;description=</font><font color="#2a00ff">&#34;click&nbsp;Edit&nbsp;Person&nbsp;link&#34;&nbsp;</font><font color="#000000">url=</font><font color="#2a00ff">&#34;/editPerson.html?id=1&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;prepareDialogResponse&nbsp;description=</font><font color="#2a00ff">&#34;Confirm&nbsp;delete&#34;&nbsp;</font><font color="#000000">dialogType=</font><font color="#2a00ff">&#34;confirm&#34;&nbsp;</font><font color="#000000">response=</font><font color="#2a00ff">&#34;true&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;clickbutton&nbsp;label=</font><font color="#2a00ff">&#34;${button.delete}&#34;&nbsp;</font><font color="#000000">description=</font><font color="#2a00ff">&#34;Click&nbsp;button&nbsp;'Delete'&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;verifyNoDialogResponses/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;verifytitle&nbsp;description=</font><font color="#2a00ff">&#34;display&nbsp;Main&nbsp;Menu&#34;&nbsp;</font><font color="#000000">text=</font><font color="#2a00ff">&#34;.*${mainMenu.title}.*&#34;&nbsp;</font><font color="#000000">regex=</font><font color="#2a00ff">&#34;true&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;verifytext&nbsp;description=</font><font color="#2a00ff">&#34;verify&nbsp;success&nbsp;message&#34;&nbsp;</font><font color="#000000">text=</font><font color="#2a00ff">&#34;${person.deleted}&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/steps&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/webtest&gt;</font><br/>
<font color="#000000">&lt;/target&gt;</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>After adding this, you should be able to run <b>ant test-canoo -Dtestcase=PersonTests</b> with Tomcat running or <b>ant test-jsp -Dtestcase=PersonTests</b> if you want Ant to start/stop Tomcat for you.  To include the PersonTests when all Canoo tests are run, add it as a dependency to the "run-all-tests" target.
</p>
<p>You'll notice that there's no logging in the client-side window by Canoo.  If you'd like to see what it's doing, you can add the following between &lt;/webtest&gt; and &lt;/target&gt; at the end of each target.
</p>
<pre>&lt;loadfile property="web-tests.result" 
    srcFile="${test.dir}/data/web-tests-result.xml"/&gt;
&lt;echo&gt;${web-tests.result}&lt;/echo&gt;</pre>

<span style="color:green">BUILD SUCCESSFUL<br />
Total time: 10 seconds</span>
<p></p>
<hr />
<p><i>Next Up:</i> <b>Part IV:</b> <a class="wikipage" href="Wiki.jsp?page=ValidationAndListSpring">Adding Validation and List Screen</a> - Adding validation logic to the personForm so that firstName and lastName are required fields and adding a list screen to display all person records in the database.
</p>
<A NAME="Link_TapestryPages">
<h1>TapestryPages</h1>
</A>
<b>Part III:</b> <a class="wikipage" href="Wiki.jsp?page=TapestryPages">Creating Tapestry Pages and HTML Templates</a> - A HowTo for creating <a class="external" href="http://jakarta.apache.org/tapestry">Tapestry</a><img class="outlink" src="images/out.png" alt="" /> Pages and HTML Templates in an <a class="wikipage" href="Wiki.jsp?page=AppFuse">AppFuse</a> project.
<dl>
<dt></dt><dd><i>This tutorial depends on <b>Part II:</b> <a class="wikipage" href="Wiki.jsp?page=CreateManager">Creating new Managers</a>.</i></dd>
</dl>
<h3 id='section-TapestryPages-AboutThisTutorial'>About this Tutorial</h3>
This tutorial will show you how to create Tapestry Pages and HTML Templates.  It'll also demonstrate writing a JUnit Test to test PersonForm.  The Page class we create will talk to the PersonManager we created in the <a class="wikipage" href="Wiki.jsp?page=CreateManager">Creating Managers</a> tutorial.  In most web frameworks, the controller logic is contain in an "Action" of some sort.  However, with Tapestry, they're commonly referred to as "Page".  The methods withing these pages are called listeners.  This tutorial is not going to teach you a whole lot about how Tapestry works, but it will get you up and running quickly with it.  If you want a more in-depth learning experience, I suggest you read <a class="external" href="http://howardlewisship.com/blog">Howard Lewis Ship's</a><img class="outlink" src="images/out.png" alt="" /> <a class="external" href="http://www.manning.com/lewisship/">Tapestry in Action</a><img class="outlink" src="images/out.png" alt="" />. I had it close by my side and used it frequently while integrating Tapestry into AppFuse.  Thanks for the help Howard!
<dl>
<dt></dt><dd><span style="color: blue"><i>I will tell you how I do stuff in the <b>Real World</b> in text like this.</i></span></dd>
</dl>
<p>Let's get started by creating a new Page and HTML Template in AppFuse's architecture.  If you haven't installed the Tapestry module at this point, do so by running <i>ant install-tapestry</i>.
</p>
<h4 id='section-TapestryPages-TableOfContents'>Table of Contents</h4>
<ul>
<li> <a class="footnoteref" href="#ref-TapestryPages-1">[1]</a> Create pageForm.html using XDoclet
</li>
<li> <a class="footnoteref" href="#ref-TapestryPages-2">[2]</a> Create PersonFormTest to test PersonForm
</li>
<li> <a class="footnoteref" href="#ref-TapestryPages-3">[3]</a> Create PersonForm
</li>
<li> <a class="footnoteref" href="#ref-TapestryPages-4">[4]</a> Run PersonFormTest
</li>
<li> <a class="footnoteref" href="#ref-TapestryPages-5">[5]</a> View the form in your browser
</li>
<li> <a class="footnoteref" href="#ref-TapestryPages-6">[6]</a> Create Canoo WebTests to test browser-like actions
</li>
</ul>
<h3 id='section-TapestryPages-CreatePageForm.htmlTemplateUsingXDoclet1'>Create pageForm.html Template using XDoclet <a class="footnote" name="ref-TapestryPages-1">[#1]</a></h3>
In this step, you'll generate a an HTML Template to display information from the Person object. It will contain Tapestry's syntax for rendering form elements - which is just HTML with "jwcid" attributes. The <a class="wikipage" href="Wiki.jsp?page=AppGen">AppGen</a> tool that's used to do this is based off a StrutsGen tool - which was originally written by <a class="external" href="http://www.blogscene.org/erik/">Erik Hatcher</a><img class="outlink" src="images/out.png" alt="" />.  It's basically just a couple of classes and a bunch of XDoclet templates.  All these files are located in extras/appgen.
<p>Here are the simple steps to generating the HTML Template and a properties file containing the labels for the form elements:
</p>
<ul>
<li> From the command-line, navigate to "extras/appgen"
</li>
<li> Execute <b>ant -Dobject.name=Person -Dappgen.type=pojo</b> to generate a bunch of files in <b>extras/appgen/build/gen</b>.  In fact, it'll generate all the files you need to complete this tutorial.  However, let's just grab the ones you need.
<ul>
<li> web/WEB-INF/classes/Person.properties (labels for your form elements) 
</li>
<li> web/pages/personForm.html (HTML Template file for viewing a single Person)
</li>
<li> web/pages/personForm.page (Page Specification for previous page)
</li>
<li> web/pages/personList.html (HTML Template file for viewing a list of People)
</li>
<li> web/pages/personList.page (Page Specification for previous page)
</li>
</ul>
</li>
<li> Copy the contents of Person.properties into web/WEB-INF/classes/ApplicationResources.properties.  These are all the keys you will need for titles/headings and form properties.  Here is an example of what you should add to ApplicationResources.properties:
</li>
</ul>
<div style="margin-left: 40px">
<pre>
# -- person form --
person.id=Id
person.firstName=First Name
person.lastName=Last Name

person.added=Person has been added successfully.
person.updated=Person has been updated successfully.
person.deleted=Person has been deleted successfully.

# -- person list page --
personList.title=Person List
personList.heading=Persons

# -- person detail page --
personDetail.title=Person Detail
personDetail.heading=Person Information
</pre>

</div>
<ul>
<li> Copy personForm.html and personForm.page to web/pages/personForm.html and web/pages/personForm.page.  Copy personList.html and personList.page to web/pages/personList.html and web/pages/personList.page.   
</li>
</ul>
<dl>
<dt></dt><dd> <i>The files in the "pages" directory will end up in "WEB-INF/pages" at deployment time. The container provides security for all files below WEB-INF.  This applies to client requests, but not to forwards from Tapestry's ApplicationServlet. Placing all HTML templates below WEB-INF ensures they are only accessed through Pages, and not directly by the client or each other. This allows security to be moved up into the Page, where it can be handled more efficiently, and out of the base presentation layer.</i></dd>
</dl>
<p>The web application security for AppFuse specifies that all *.html url-patterns should be protected (except for /signup.html and /passwordHint.html).  This guarantees that clients must go through a Page to get to a template (or at least the ones in <i>pages</i>). 
</p>
<span class="note"><b>NOTE:</b> If you want to customize the CSS for a particular page, you can add &lt;body id="pageName"/> to the top of the file (right after the &lt;/content> tag).  This will be slurped up by SiteMesh and put into the final page.  You can then customize your CSS on a page-by-page basis using something like the following: 
<pre>body#pageName element.class { background-color: blue } </pre>
</span>
<h3 id='section-TapestryPages-CreatePersonFormTestToTestPersonForm2'>Create PersonFormTest to test PersonForm <a class="footnote" name="ref-TapestryPages-2">[#2]</a></h3>
To create a JUnit Test for PersonForm, start by creating a PersonFormTest.java file in the test/web/**/action directory.
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#7f0055"><b>package&nbsp;</b></font><font color="#000000">org.appfuse.webapp.action;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">java.util.ResourceBundle;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">org.appfuse.model.Person;</font><br/>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">org.appfuse.service.PersonManager;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#7f0055"><b>public&nbsp;class&nbsp;</b></font><font color="#000000">PersonFormTest&nbsp;</font><font color="#7f0055"><b>extends&nbsp;</b></font><font color="#000000">BasePageTestCase&nbsp;</font><font color="#000000">{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>private&nbsp;</b></font><font color="#000000">PersonForm&nbsp;page;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>private&nbsp;</b></font><font color="#000000">PersonManager&nbsp;personManager;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>protected&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">setUp</font><font color="#000000">()&nbsp;</font><font color="#7f0055"><b>throws&nbsp;</b></font><font color="#000000">Exception&nbsp;</font><font color="#000000">{&nbsp;&nbsp;&nbsp;&nbsp;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>super</b></font><font color="#000000">.setUp</font><font color="#000000">()</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">page&nbsp;=&nbsp;</font><font color="#000000">(</font><font color="#000000">PersonForm</font><font color="#000000">)&nbsp;</font><font color="#000000">getPage</font><font color="#000000">(</font><font color="#000000">PersonForm.</font><font color="#7f0055"><b>class</b></font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f7f5f">//&nbsp;unfortunately&nbsp;this&nbsp;is&nbsp;a&nbsp;required&nbsp;step&nbsp;if&nbsp;you're&nbsp;calling&nbsp;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f7f5f">//&nbsp;getMessage&nbsp;in&nbsp;the&nbsp;page&nbsp;class</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">page.setBundle</font><font color="#000000">(</font><font color="#000000">ResourceBundle.getBundle</font><font color="#000000">(</font><font color="#000000">MESSAGES</font><font color="#000000">))</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">page.setValidationDelegate</font><font color="#000000">(</font><font color="#7f0055"><b>new&nbsp;</b></font><font color="#000000">Validator</font><font color="#000000">())</font><font color="#000000">;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f7f5f">//&nbsp;this&nbsp;manager&nbsp;can&nbsp;be&nbsp;mocked&nbsp;if&nbsp;you&nbsp;want&nbsp;a&nbsp;more&nbsp;&#34;pure&#34;&nbsp;unit&nbsp;test</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">personManager&nbsp;=&nbsp;</font><font color="#000000">(</font><font color="#000000">PersonManager</font><font color="#000000">)&nbsp;</font><font color="#000000">ctx.getBean</font><font color="#000000">(</font><font color="#2a00ff">&#34;personManager&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">page.setPersonManager</font><font color="#000000">(</font><font color="#000000">personManager</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f7f5f">//&nbsp;default&nbsp;request&nbsp;cycle</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">page.setRequestCycle</font><font color="#000000">(</font><font color="#000000">getCycle</font><font color="#000000">(</font><font color="#000000">request,&nbsp;response</font><font color="#000000">))</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>protected&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">tearDown</font><font color="#000000">()&nbsp;</font><font color="#7f0055"><b>throws&nbsp;</b></font><font color="#000000">Exception&nbsp;</font><font color="#000000">{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>super</b></font><font color="#000000">.tearDown</font><font color="#000000">()</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">page&nbsp;=&nbsp;</font><font color="#7f0055"><b>null</b></font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">testAdd</font><font color="#000000">()&nbsp;</font><font color="#7f0055"><b>throws&nbsp;</b></font><font color="#000000">Exception&nbsp;</font><font color="#000000">{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">Person&nbsp;person&nbsp;=&nbsp;</font><font color="#7f0055"><b>new&nbsp;</b></font><font color="#000000">Person</font><font color="#000000">()</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f7f5f">//&nbsp;set&nbsp;required&nbsp;fields</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">person.setFirstName</font><font color="#000000">(</font><font color="#2a00ff">&#34;firstName&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">person.setLastName</font><font color="#000000">(</font><font color="#2a00ff">&#34;lastName&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">page.setPerson</font><font color="#000000">(</font><font color="#000000">person</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">page.save</font><font color="#000000">(</font><font color="#000000">page.getRequestCycle</font><font color="#000000">())</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">assertFalse</font><font color="#000000">(</font><font color="#000000">page.hasErrors</font><font color="#000000">())</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">testEdit</font><font color="#000000">()&nbsp;</font><font color="#7f0055"><b>throws&nbsp;</b></font><font color="#000000">Exception&nbsp;</font><font color="#000000">{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">MockRequestCycle&nbsp;cycle&nbsp;=&nbsp;</font><font color="#000000">(</font><font color="#000000">MockRequestCycle</font><font color="#000000">)&nbsp;</font><font color="#000000">page.getRequestCycle</font><font color="#000000">()</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">cycle.addServiceParameter</font><font color="#000000">(</font><font color="#7f0055"><b>new&nbsp;</b></font><font color="#000000">Long</font><font color="#000000">(</font><font color="#990000">1</font><font color="#000000">))</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">page.edit</font><font color="#000000">(</font><font color="#000000">cycle</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">assertNotNull</font><font color="#000000">(</font><font color="#000000">page.getPerson</font><font color="#000000">())</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">assertFalse</font><font color="#000000">(</font><font color="#000000">page.hasErrors</font><font color="#000000">())</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">testSave</font><font color="#000000">()&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">assertNotNull</font><font color="#000000">(</font><font color="#000000">personManager</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">Person&nbsp;person&nbsp;=&nbsp;personManager.getPerson</font><font color="#000000">(</font><font color="#2a00ff">&#34;1&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f7f5f">//&nbsp;update&nbsp;fields</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">person.setFirstName</font><font color="#000000">(</font><font color="#2a00ff">&#34;firstName&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">person.setLastName</font><font color="#000000">(</font><font color="#2a00ff">&#34;lastName&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">page.setPerson</font><font color="#000000">(</font><font color="#000000">person</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">page.save</font><font color="#000000">(</font><font color="#000000">page.getRequestCycle</font><font color="#000000">())</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">assertFalse</font><font color="#000000">(</font><font color="#000000">page.hasErrors</font><font color="#000000">())</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">testRemove</font><font color="#000000">()&nbsp;</font><font color="#7f0055"><b>throws&nbsp;</b></font><font color="#000000">Exception&nbsp;</font><font color="#000000">{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">Person&nbsp;person&nbsp;=&nbsp;</font><font color="#7f0055"><b>new&nbsp;</b></font><font color="#000000">Person</font><font color="#000000">()</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">person.setId</font><font color="#000000">(</font><font color="#7f0055"><b>new&nbsp;</b></font><font color="#000000">Long</font><font color="#000000">(</font><font color="#990000">2</font><font color="#000000">))</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">page.setPerson</font><font color="#000000">(</font><font color="#000000">person</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">page.delete</font><font color="#000000">(</font><font color="#000000">page.getRequestCycle</font><font color="#000000">())</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">assertFalse</font><font color="#000000">(</font><font color="#000000">page.hasErrors</font><font color="#000000">())</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#000000">}</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>Nothing will compile at this point because you need to create the PersonForm that you're referring to in this test.
</p>
<h3 id='section-TapestryPages-CreatePersonForm3'>Create PersonForm <a class="footnote" name="ref-TapestryPages-3">[#3]</a></h3>
<p>In src/web/**/action, create a PersonForm.java file with the following contents:
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#7f0055"><b>package&nbsp;</b></font><font color="#000000">org.appfuse.webapp.action;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">org.apache.tapestry.IRequestCycle;</font><br/>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">org.apache.tapestry.engine.ILink;</font><br/>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">org.apache.tapestry.event.PageEvent;</font><br/>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">org.apache.tapestry.event.PageBeginRenderListener;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">org.appfuse.model.Person;</font><br/>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">org.appfuse.service.PersonManager;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#7f0055"><b>public&nbsp;abstract&nbsp;class&nbsp;</b></font><font color="#000000">PersonForm&nbsp;</font><font color="#7f0055"><b>extends&nbsp;</b></font><font color="#000000">BasePage&nbsp;</font><font color="#7f0055"><b>implements&nbsp;</b></font><font color="#000000">PageBeginRenderListener&nbsp;</font><font color="#000000">{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;abstract&nbsp;</b></font><font color="#000000">PersonManager&nbsp;getPersonManager</font><font color="#000000">()</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;abstract&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">setPerson</font><font color="#000000">(</font><font color="#000000">Person&nbsp;person</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;abstract&nbsp;</b></font><font color="#000000">Person&nbsp;getPerson</font><font color="#000000">()</font><font color="#000000">;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">pageBeginRender</font><font color="#000000">(</font><font color="#000000">PageEvent&nbsp;event</font><font color="#000000">)&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>if&nbsp;</b></font><font color="#000000">((</font><font color="#000000">getPerson</font><font color="#000000">()&nbsp;</font><font color="#000000">==&nbsp;</font><font color="#7f0055"><b>null</b></font><font color="#000000">)&nbsp;</font><font color="#000000">&amp;&amp;&nbsp;!event.getRequestCycle</font><font color="#000000">()</font><font color="#000000">.isRewinding</font><font color="#000000">())&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">setPerson</font><font color="#000000">(</font><font color="#7f0055"><b>new&nbsp;</b></font><font color="#000000">Person</font><font color="#000000">())</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}&nbsp;</font><font color="#7f0055"><b>else&nbsp;if&nbsp;</b></font><font color="#000000">(</font><font color="#000000">event.getRequestCycle</font><font color="#000000">()</font><font color="#000000">.isRewinding</font><font color="#000000">())&nbsp;{&nbsp;</font><font color="#3f7f5f">//&nbsp;add</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">setPerson</font><font color="#000000">(</font><font color="#7f0055"><b>new&nbsp;</b></font><font color="#000000">Person</font><font color="#000000">())</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#000000">ILink&nbsp;cancel</font><font color="#000000">(</font><font color="#000000">IRequestCycle&nbsp;cycle</font><font color="#000000">)&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">log.debug</font><font color="#000000">(</font><font color="#2a00ff">&#34;Entering&nbsp;'cancel'&nbsp;method&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>return&nbsp;</b></font><font color="#000000">getEngineService</font><font color="#000000">()</font><font color="#000000">.getLink</font><font color="#000000">(</font><font color="#000000">false,&nbsp;</font><font color="#2a00ff">&#34;persons&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#000000">ILink&nbsp;delete</font><font color="#000000">(</font><font color="#000000">IRequestCycle&nbsp;cycle</font><font color="#000000">)&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">log.debug</font><font color="#000000">(</font><font color="#2a00ff">&#34;entered&nbsp;'delete'&nbsp;method&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">getPersonManager</font><font color="#000000">()</font><font color="#000000">.removePerson</font><font color="#000000">(</font><font color="#000000">getPerson</font><font color="#000000">()</font><font color="#000000">.getPersonId</font><font color="#000000">()</font><font color="#000000">.toString</font><font color="#000000">())</font><font color="#000000">;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">PersonList&nbsp;nextPage&nbsp;=&nbsp;</font><font color="#000000">(</font><font color="#000000">PersonList</font><font color="#000000">)&nbsp;</font><font color="#000000">cycle.getPage</font><font color="#000000">(</font><font color="#2a00ff">&#34;persons&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">nextPage.setMessage</font><font color="#000000">(</font><font color="#000000">getText</font><font color="#000000">(</font><font color="#2a00ff">&#34;person.deleted&#34;</font><font color="#000000">))</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>return&nbsp;</b></font><font color="#000000">getEngineService</font><font color="#000000">()</font><font color="#000000">.getLink</font><font color="#000000">(</font><font color="#000000">false,&nbsp;nextPage.getPageName</font><font color="#000000">())</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#000000">ILink&nbsp;save</font><font color="#000000">(</font><font color="#000000">IRequestCycle&nbsp;cycle</font><font color="#000000">)&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>if&nbsp;</b></font><font color="#000000">(</font><font color="#000000">getDelegate</font><font color="#000000">()</font><font color="#000000">.getHasErrors</font><font color="#000000">())&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>return&nbsp;null</b></font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>boolean&nbsp;</b></font><font color="#000000">isNew&nbsp;=&nbsp;</font><font color="#000000">(</font><font color="#000000">getPerson</font><font color="#000000">()</font><font color="#000000">.getPersonId</font><font color="#000000">()&nbsp;</font><font color="#000000">==&nbsp;</font><font color="#7f0055"><b>null</b></font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">getPersonManager</font><font color="#000000">()</font><font color="#000000">.savePerson</font><font color="#000000">(</font><font color="#000000">getPerson</font><font color="#000000">())</font><font color="#000000">;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">String&nbsp;key&nbsp;=&nbsp;</font><font color="#000000">(</font><font color="#000000">isNew</font><font color="#000000">)&nbsp;</font><font color="#000000">?&nbsp;</font><font color="#2a00ff">&#34;person.added&#34;&nbsp;</font><font color="#000000">:&nbsp;</font><font color="#2a00ff">&#34;person.updated&#34;</font><font color="#000000">;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>if&nbsp;</b></font><font color="#000000">(</font><font color="#000000">isNew</font><font color="#000000">)&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">PersonList&nbsp;nextPage&nbsp;=&nbsp;</font><font color="#000000">(</font><font color="#000000">PersonList</font><font color="#000000">)&nbsp;</font><font color="#000000">cycle.getPage</font><font color="#000000">(</font><font color="#2a00ff">&#34;persons&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">nextPage.setMessage</font><font color="#000000">(</font><font color="#000000">getText</font><font color="#000000">(</font><font color="#000000">key</font><font color="#000000">))</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>return&nbsp;</b></font><font color="#000000">getEngineService</font><font color="#000000">()</font><font color="#000000">.getLink</font><font color="#000000">(</font><font color="#000000">false,&nbsp;nextPage.getPageName</font><font color="#000000">())</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}&nbsp;</font><font color="#7f0055"><b>else&nbsp;</b></font><font color="#000000">{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">setMessage</font><font color="#000000">(</font><font color="#000000">getText</font><font color="#000000">(</font><font color="#000000">key</font><font color="#000000">))</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>return&nbsp;null</b></font><font color="#000000">;&nbsp;</font><font color="#3f7f5f">//&nbsp;return&nbsp;to&nbsp;current&nbsp;page</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#000000">}</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>You'll notice a number of keys in this file - "person.deleted", "person.added" and "person.updated". These are all keys that need to be in your i18n bundle (ApplicationResources.properties).  You should've added these at the beginning of this tutorial.  If you want to customize these messages, to add the a person's name or something, simply add a {0} placeholder in the key's message and then use setMessage(format(key, stringtoreplace)) method. 
</p>
<p>You might notice that the code we're using to call the PersonManager is the same as the code we used in our PersonManagerTest.  Both PersonForm and PersonManagerTest are <i>clients</i> of PersonManagerImpl, so this makes perfect sense.
</p>
<p>Now you need to tell Tapestry that this page exists.  To do this, add a <b>page</b> entry in the web/WEB-INF/tapestry.application file.
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;page&nbsp;name=</font><font color="#2a00ff">&#34;personForm&#34;&nbsp;</font><font color="#000000">specification-path=</font><font color="#2a00ff">&#34;pages/personForm.page&#34;</font><font color="#000000">/&gt;</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>If you keep your HTML templates in the WEB-INF directory, the above step is unnecessary.  Hopefully a future version of Tapestry will allow you to set a global specification-path.
</p>
<dl>
<dt></dt><dd><i>The PersonForm returns the "MainMenu" page from the <tt>cancel()(</tt>, <tt>delete()</tt> and <tt>save()</tt> methods.  In the next tutorial, you will change this to be the PersonList.</i></dd>
</dl>
<h3 id='section-TapestryPages-RunThePersonFormTest4'>Run the PersonFormTest <a class="footnote" name="ref-TapestryPages-4">[#4]</a></h3>
If you look at our PersonFormTest, all the tests depend on having a record with id=1 in the database (and testRemove depends on id=2), so add those records to your sample data file (metadata/sql/sample-data.xml). I'd just add it at the bottom - order is not important since it (currently) does not relate to any other tables.
<pre>
  &lt;table name='person'&gt;
    &lt;column&gt;id&lt;/column&gt;
    &lt;column&gt;first_name&lt;/column&gt;
    &lt;column&gt;last_name&lt;/column&gt;
    &lt;row&gt;
      &lt;value&gt;1&lt;/value&gt;
      &lt;value&gt;Matt&lt;/value&gt;
      &lt;value&gt;Raible&lt;/value&gt;
    &lt;/row&gt;
    &lt;row&gt;
      &lt;value&gt;2&lt;/value&gt;
      &lt;value&gt;James&lt;/value&gt;
      &lt;value&gt;Davidson&lt;/value&gt;
    &lt;/row&gt;
  &lt;/table&gt;
</pre>

<p>DBUnit loads this file before we running any of the tests, so this record will be available to your Form test.
</p>
<p>Make sure are in the base directory of your project and all files are saved.  If you run <b>ant test-web -Dtestcase=PersonForm</b> - everything should work as planned.  
</p>
<span style="color:green">BUILD SUCCESSFUL<br />
Total time: 12 seconds</span>
<p></p>
<h3 id='section-TapestryPages-ViewTheFormInYourBrowser5'>View the form in your browser <a class="footnote" name="ref-TapestryPages-5">[#5]</a></h3>
Now if you execute <b>ant db-load deploy</b>, start Tomcat and point your browser to <a class="external" href="http://localhost:8080/appfuse/personForm.html">http://localhost:8080/appfuse/personForm.html</a><img class="outlink" src="images/out.png" alt="" />, you should see something like this:
<div style="border: 1px solid black; margin: 0 auto; height: 166px; width: 337px">
<img class="inline" src="attach/JSFBeans/personForm-final.png" alt="JSFBeans/personForm-final.png" />
</div>
<span class="note"><b>NOTE:</b> Tapestry will automatically put focus on the first required field of the form.  If you want to change this, see the <a class="external" href="http://jakarta.apache.org/site/mail2.html#Tapestry">mailing list archives</a><img class="outlink" src="images/out.png" alt="" />.</span>
<p>With Tapestry, the URLs are kinda ugly, but they hold a lot of information in them.  Unlike other frameworks, where you typically call methods in an Action, with Tapestry - you call <i>listeners</i> in a Page class.  To call the "edit" listener in the PersonForm class, add the following to web/pages/mainMenu.html.
</p>
<pre>
    &lt;a jwcid="@DirectLink" listener="ognl:requestCycle.getPage('personForm').listeners.edit" 
        parameters="ognl:new java.lang.Long(1)"&gt;Edit Person&lt;/a&gt;
</pre>

<p>Finally, to make this page more user friendly, you may want to add a message for your users at the top of the form, but this can easily be done by adding text (using &lt;span key="..."/&gt;) at the top of the personForm.html page.
</p>
<h3 id='section-TapestryPages-OptionalCreateACanooWebTestToTestBrowserLikeActions6'>[Optional] Create a Canoo WebTest to test browser-like actions <a class="footnote" name="ref-TapestryPages-6">[#6]</a></h3>
The final (optional) step in this tutorial is to create a <a class="external" href="http://webtest.canoo.com">Canoo WebTest</a><img class="outlink" src="images/out.png" alt="" /> to test the HTML Templates.  
<dl>
<dt></dt><dd><i>I say this step is optional, because you can run the same tests through your browser.</i></dd>
</dl>
<p>You can use the following steps to test the different actions for adding, editing and saving a user.
</p>
<ul>
<li> Add - <a class="external" href="http://localhost:8080/appfuse/personForm.html">http://localhost:8080/appfuse/personForm.html</a><img class="outlink" src="images/out.png" alt="" />.
</li>
<li> Edit - Use the link you created on the Main Menu (make sure and run <b>ant db-load</b> first).
</li>
<li> Delete - Use the edit link above and click on the Delete button.
</li>
<li> Save - Click the edit link on the Main Menu (run ant db-load first if you deleted already) and then click the Save button.
</li>
</ul>
<p>Canoo tests are pretty slick in that they're simply configured in an XML file.  To add tests for add, edit, save and delete, open <b>test/web/web-tests.xml</b> and add the following XML.  You'll notice that this fragment has a target named <i>PersonTests</i> that runs all the related tests.  
</p>
<dl>
<dt></dt><dd><i>I use CamelCase target names (vs. the traditional lowercase, dash-separated) because when you're typing </i>-Dtestcase=Name<i>, I've found that I'm used to doing CamelCase for my JUnit Tests.</i></dd>
</dl>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;!--&nbsp;runs&nbsp;person-related&nbsp;tests&nbsp;--&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;target&nbsp;name=</font><font color="#2a00ff">&#34;PersonTests&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">depends=</font><font color="#2a00ff">&#34;EditPerson,SavePerson,AddPerson,DeletePerson&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">description=</font><font color="#2a00ff">&#34;Call&nbsp;and&nbsp;executes&nbsp;all&nbsp;person&nbsp;test&nbsp;cases&nbsp;(targets)&#34;</font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;echo&gt;Successfully&nbsp;ran&nbsp;all&nbsp;Person&nbsp;HTML&nbsp;Template&nbsp;tests!&lt;/echo&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/target&gt;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;!--&nbsp;Verify&nbsp;the&nbsp;edit&nbsp;person&nbsp;screen&nbsp;displays&nbsp;without&nbsp;errors&nbsp;--&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;target&nbsp;name=</font><font color="#2a00ff">&#34;EditPerson&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">description=</font><font color="#2a00ff">&#34;Tests&nbsp;editing&nbsp;an&nbsp;existing&nbsp;Person's&nbsp;information&#34;</font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;webtest&nbsp;name=</font><font color="#2a00ff">&#34;editPerson&#34;</font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&amp;config;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;steps&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&amp;login;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;clicklink&nbsp;label=</font><font color="#2a00ff">&#34;Edit&nbsp;Person&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;verifytitle&nbsp;description=</font><font color="#2a00ff">&#34;we&nbsp;should&nbsp;see&nbsp;the&nbsp;personDetail&nbsp;title&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">text=</font><font color="#2a00ff">&#34;.*${personDetail.title}.*&#34;&nbsp;</font><font color="#000000">regex=</font><font color="#2a00ff">&#34;true&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/steps&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/webtest&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/target&gt;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;!--&nbsp;Edit&nbsp;a&nbsp;person&nbsp;and&nbsp;then&nbsp;save&nbsp;--&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;target&nbsp;name=</font><font color="#2a00ff">&#34;SavePerson&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">description=</font><font color="#2a00ff">&#34;Tests&nbsp;editing&nbsp;and&nbsp;saving&nbsp;a&nbsp;user&#34;</font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;webtest&nbsp;name=</font><font color="#2a00ff">&#34;savePerson&#34;</font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&amp;config;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;steps&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&amp;login;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;clicklink&nbsp;label=</font><font color="#2a00ff">&#34;Edit&nbsp;Person&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;verifytitle&nbsp;description=</font><font color="#2a00ff">&#34;we&nbsp;should&nbsp;see&nbsp;the&nbsp;personDetail&nbsp;title&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">text=</font><font color="#2a00ff">&#34;.*${personDetail.title}.*&#34;&nbsp;</font><font color="#000000">regex=</font><font color="#2a00ff">&#34;true&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;!--&nbsp;update&nbsp;some&nbsp;of&nbsp;the&nbsp;required&nbsp;fields&nbsp;--&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;setinputfield&nbsp;description=</font><font color="#2a00ff">&#34;set&nbsp;firstName&#34;&nbsp;</font><font color="#000000">name=</font><font color="#2a00ff">&#34;firstNameField&#34;&nbsp;</font><font color="#000000">value=</font><font color="#2a00ff">&#34;Canoo&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;setinputfield&nbsp;description=</font><font color="#2a00ff">&#34;set&nbsp;lastName&#34;&nbsp;</font><font color="#000000">name=</font><font color="#2a00ff">&#34;lastNameField&#34;&nbsp;</font><font color="#000000">value=</font><font color="#2a00ff">&#34;WebTest&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;clickbutton&nbsp;label=</font><font color="#2a00ff">&#34;${button.save}&#34;&nbsp;</font><font color="#000000">description=</font><font color="#2a00ff">&#34;Click&nbsp;Save&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;verifytitle&nbsp;description=</font><font color="#2a00ff">&#34;Page&nbsp;re-appears&nbsp;if&nbsp;save&nbsp;successful&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">text=</font><font color="#2a00ff">&#34;.*${personDetail.title}.*&#34;&nbsp;</font><font color="#000000">regex=</font><font color="#2a00ff">&#34;true&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;verifytext&nbsp;description=</font><font color="#2a00ff">&#34;verify&nbsp;success&nbsp;message&#34;&nbsp;</font><font color="#000000">text=</font><font color="#2a00ff">&#34;${person.updated}&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/steps&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/webtest&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/target&gt;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;!--&nbsp;Add&nbsp;a&nbsp;</font><font color="#7f0055"><b>new&nbsp;</b></font><font color="#000000">Person&nbsp;--&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;target&nbsp;name=</font><font color="#2a00ff">&#34;AddPerson&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">description=</font><font color="#2a00ff">&#34;Adds&nbsp;a&nbsp;new&nbsp;Person&#34;</font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;webtest&nbsp;name=</font><font color="#2a00ff">&#34;addPerson&#34;</font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&amp;config;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;steps&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&amp;login;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;invoke&nbsp;description=</font><font color="#2a00ff">&#34;View&nbsp;Person&nbsp;Form&#34;&nbsp;</font><font color="#000000">url=</font><font color="#2a00ff">&#34;/personForm.html&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;verifytitle&nbsp;description=</font><font color="#2a00ff">&#34;we&nbsp;should&nbsp;see&nbsp;the&nbsp;personDetail&nbsp;title&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">text=</font><font color="#2a00ff">&#34;.*${personDetail.title}.*&#34;&nbsp;</font><font color="#000000">regex=</font><font color="#2a00ff">&#34;true&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;!--&nbsp;enter&nbsp;required&nbsp;fields&nbsp;--&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;setinputfield&nbsp;description=</font><font color="#2a00ff">&#34;set&nbsp;firstName&#34;&nbsp;</font><font color="#000000">name=</font><font color="#2a00ff">&#34;firstNameField&#34;&nbsp;</font><font color="#000000">value=</font><font color="#2a00ff">&#34;Jack&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;setinputfield&nbsp;description=</font><font color="#2a00ff">&#34;set&nbsp;lastName&#34;&nbsp;</font><font color="#000000">name=</font><font color="#2a00ff">&#34;lastNameField&#34;&nbsp;</font><font color="#000000">value=</font><font color="#2a00ff">&#34;Raible&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;clickbutton&nbsp;label=</font><font color="#2a00ff">&#34;${button.save}&#34;&nbsp;</font><font color="#000000">description=</font><font color="#2a00ff">&#34;Click&nbsp;button&nbsp;'Save'&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;verifytitle&nbsp;description=</font><font color="#2a00ff">&#34;Main&nbsp;Menu&nbsp;appears&nbsp;if&nbsp;save&nbsp;successful&#34;&nbsp;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">text=</font><font color="#2a00ff">&#34;.*${mainMenu.title}.*&#34;&nbsp;</font><font color="#000000">regex=</font><font color="#2a00ff">&#34;true&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;verifytext&nbsp;description=</font><font color="#2a00ff">&#34;verify&nbsp;success&nbsp;message&#34;&nbsp;</font><font color="#000000">text=</font><font color="#2a00ff">&#34;${person.added}&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/steps&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/webtest&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/target&gt;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;!--&nbsp;Delete&nbsp;existing&nbsp;person&nbsp;--&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;target&nbsp;name=</font><font color="#2a00ff">&#34;DeletePerson&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">description=</font><font color="#2a00ff">&#34;Deletes&nbsp;existing&nbsp;Person&#34;</font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;webtest&nbsp;name=</font><font color="#2a00ff">&#34;deletePerson&#34;</font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&amp;config;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;steps&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&amp;login;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;clicklink&nbsp;label=</font><font color="#2a00ff">&#34;Edit&nbsp;Person&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;prepareDialogResponse&nbsp;description=</font><font color="#2a00ff">&#34;Confirm&nbsp;delete&#34;&nbsp;</font><font color="#000000">dialogType=</font><font color="#2a00ff">&#34;confirm&#34;&nbsp;</font><font color="#000000">response=</font><font color="#2a00ff">&#34;true&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;clickbutton&nbsp;label=</font><font color="#2a00ff">&#34;${button.delete}&#34;&nbsp;</font><font color="#000000">description=</font><font color="#2a00ff">&#34;Click&nbsp;button&nbsp;'Delete'&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;verifyNoDialogResponses/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;verifytitle&nbsp;description=</font><font color="#2a00ff">&#34;display&nbsp;Main&nbsp;Menu&#34;&nbsp;</font><font color="#000000">text=</font><font color="#2a00ff">&#34;.*${mainMenu.title}.*&#34;&nbsp;</font><font color="#000000">regex=</font><font color="#2a00ff">&#34;true&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;verifytext&nbsp;description=</font><font color="#2a00ff">&#34;verify&nbsp;success&nbsp;message&#34;&nbsp;</font><font color="#000000">text=</font><font color="#2a00ff">&#34;${person.deleted}&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/steps&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/webtest&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/target&gt;</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>After adding this, you should be able to run <b>ant test-canoo -Dtestcase=PersonTests</b> with Tomcat running or <b>ant test-html -Dtestcase=PersonTests</b> if you want Ant to start/stop Tomcat for you.  To include the PersonTests when all Canoo tests are run, add it as a dependency to the "run-all-tests" target.
</p>
<p>You'll notice that there's no logging in the client-side window by Canoo.  If you'd like to see what it's doing, you can add <a class="external" href="http://webtest-community.canoo.com/wiki/space/WebTest+FAQ">tweak the log4j settings</a><img class="outlink" src="images/out.png" alt="" /> in web/WEB-INF/classes/log4j.properties.
</p>
<p></p>
<span style="color:green">BUILD SUCCESSFUL<br />
Total time: 27 seconds</span>
<p></p>
<hr />
<p><i>Next Up:</i> <b>Part IV:</b> <a class="wikipage" href="Wiki.jsp?page=ValidationAndListTapestry">Adding Validation and List Screen</a> - Explains the validation logic on the personForm and how the firstName and lastName are required fields.  You'll also add a list screen to display all person records in the database.
</p>
<A NAME="Link_ValidationAndList">
<h1>ValidationAndList</h1>
</A>
<b>Part IV:</b> <a class="wikipage" href="Wiki.jsp?page=ValidationAndList">Adding Validation and List Screen</a> - Adding validation logic to the PersonForm so that firstName and lastName are required fields and adding a list screen to display all person records in the database.
<dl>
<dt></dt><dd><i>This tutorial depends on <b>Part III:</b> <a class="wikipage" href="Wiki.jsp?page=CreateActions">Creating Actions and JSPs</a>.</i></dd>
</dl>
<h3 id='section-ValidationAndList-AboutThisTutorial'>About this Tutorial</h3>
This tutorial will show you how to add Validation logic (client and server-side) to the PersonForm object using Struts' Validator. We'll also create a list screen using the <a class="external" href="http://displaytag.sf.net">Display Tag Library</a><img class="outlink" src="images/out.png" alt="" /> to display all the people in the database.
<dl>
<dt></dt><dd><span style="color: blue"><i>I will tell you how I do stuff in the <b>Real World</b> in text like this.</i></span></dd>
</dl>
<h4 id='section-ValidationAndList-TableOfContents'>Table of Contents</h4>
<ul>
<li> <a class="footnoteref" href="#ref-ValidationAndList-1">[1]</a> Add XDoclet Validator tags to Person.java
</li>
<li> <a class="footnoteref" href="#ref-ValidationAndList-2">[2]</a> View JSP with validation added and test
</li>
<li> <a class="footnoteref" href="#ref-ValidationAndList-3">[3]</a> Add <i>testGetPeople</i> methods to DAO and Manager Tests
</li>
<li> <a class="footnoteref" href="#ref-ValidationAndList-4">[4]</a> Add <i>getPeople</i> methods to PersonDao and Manager
</li>
<li> <a class="footnoteref" href="#ref-ValidationAndList-5">[5]</a> Add <i>testSearch</i> methods to Action Test
</li>
<li> <a class="footnoteref" href="#ref-ValidationAndList-6">[6]</a> Add <i>search </i> method to Action 
</li>
<li> <a class="footnoteref" href="#ref-ValidationAndList-7">[7]</a> Create personList.jsp and Canoo test
</li>
<li> <a class="footnoteref" href="#ref-ValidationAndList-8">[8]</a> Add link to menu
</li>
</ul>
<h3 id='section-ValidationAndList-AddXDocletValidatorTagsToPerson.java1'>Add XDoclet Validator tags to Person.java <a class="footnote" name="ref-ValidationAndList-1">[#1]</a></h3>
To use the Struts Validator, normally you have to write a validation.xml file by hand.  If you're not using AppFuse, you also have to configure the Validator Plugin and error keys in your ApplicationResources.properties.  For more information on this, see the <a class="external" href="http://www.reumann.net/struts/lesson3/step8.do">Validation Made Easy Tutorial</a><img class="outlink" src="images/out.png" alt="" /> (there's also a <a class="external" href="http://www.reumann.net/struts/main.do">rich set of tutorials</a><img class="outlink" src="images/out.png" alt="" /> for Struts itself).
<p>Thanks to XDoclet, it's much easier - you just need to add a couple of <i>@struts.validator</i> tags to the Person class.  Open it up (src/dao/**/model/Person.java) and modify the getFirstName() and getLastName() methods to include <i>@struts.validator type="required"</i> tags.
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">/**</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*&nbsp;@struts.validator&nbsp;type=&#34;required&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*&nbsp;@hibernate.property&nbsp;column=&#34;first_name&#34;&nbsp;length=&#34;50&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*/</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#000000">String&nbsp;getFirstName</font><font color="#000000">()&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>return&nbsp;this</b></font><font color="#000000">.firstName;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">/**</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*&nbsp;@struts.validator&nbsp;type=&#34;required&#34;&nbsp;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*&nbsp;@hibernate.property&nbsp;column=&#34;last_name&#34;&nbsp;length=&#34;50&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*/</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#000000">String&nbsp;getLastName</font><font color="#000000">()&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>return&nbsp;this</b></font><font color="#000000">.lastName;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>You can also add a <i>msgkey</i> attribute to this tag to override the default message key for this error.
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#000000">@struts.validator&nbsp;type=</font><font color="#2a00ff">&#34;required&#34;&nbsp;</font><font color="#000000">msgkey=</font><font color="#2a00ff">&#34;errors.required&#34;</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>The default key for type="required" is already <i>errors.required</i>, so I usually leave it to the default.  This key is defined in web/WEB-INF/classes/ApplicationResources_*.properties.  You'll notice that we put these tags on the <i>getters</i> of this class even though the <a class="external" href="http://xdoclet.sourceforge.net/tags/apache-tags.html#@struts.validator%20(0..*)">XDoclet documentation</a><img class="outlink" src="images/out.png" alt="" /> says to put them on the setters.  This is because we are generating our PersonForm.java - the template file (metadata/template/struts_form.xdt) takes care of putting these tags onto the setters in the generated file.
</p>
<p>Now if you save Person.java and run <b>ant clean webdoclet</b>, a validation.xml file will be generated in build/appfuse/WEB-INF/.  Its contents should have now have an entry for "personForm".  
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;form&nbsp;name=</font><font color="#2a00ff">&#34;personForm&#34;</font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;field&nbsp;property=</font><font color="#2a00ff">&#34;firstName&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">depends=</font><font color="#2a00ff">&#34;required&#34;</font><font color="#000000">&gt;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;arg0&nbsp;key=</font><font color="#2a00ff">&#34;personForm.firstName&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/field&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;field&nbsp;property=</font><font color="#2a00ff">&#34;lastName&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">depends=</font><font color="#2a00ff">&#34;required&#34;</font><font color="#000000">&gt;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;arg0&nbsp;key=</font><font color="#2a00ff">&#34;personForm.lastName&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/field&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/form&gt;</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>Client-side validation is enabled by default in personForm.jsp.  There is an &lt;html:javascript> JSP tag and script at the bottom of this page that enables it. The following should already exist (thanks to AppGen) - but you might need to uncomment it if you commented it out in the last tutorial. 
</p>
<pre>&lt;html:javascript formName="personForm" cdata="false"
    dynamicJavascript="true" staticJavascript="false"/&gt;
&lt;script type="text/javascript" 
    src="&lt;html:rewrite page="/scripts/validator.jsp"/&gt;"&gt;&lt;/script&gt;</pre>

<span class="note"><b>NOTE:</b> If you have nested objects with validation rules, those will be picked up and put into validation.xml.  This is because an @struts.validator tag gets added to the setter of the nested object when the form is generated (using metadata/templates/struts_form.xdt).  If you have many-to-many bi-directional relationships between objects, this can cause a problem.  There are two solutions to fix this.  The first is to remove the @struts.validator tag from struts_form.xdt and manually place it on the setter in your POJO.  The second is <a class="external" href="https://appfuse.dev.java.net/issues/show_bug.cgi?id=88">described here</a><img class="outlink" src="images/out.png" alt="" />.</span> 
<h3 id='section-ValidationAndList-ViewJSPWithValidationAddedAndTest2'>View JSP with validation added and test <a class="footnote" name="ref-ValidationAndList-2">[#2]</a></h3>
<p>Now that you have Validation configured for this form, whenever this form is used in an action-mapping with validate="true", these rules will be applied.  In the <a class="wikipage" href="Wiki.jsp?page=CreateActions">last tutorial</a>, we added the "savePerson" action-mapping for PersonAction.  The XDoclet tags for this action-mapping were:
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;</font><font color="#000000">*&nbsp;@struts.action&nbsp;name=</font><font color="#2a00ff">&#34;personForm&#34;&nbsp;</font><font color="#000000">path=</font><font color="#2a00ff">&#34;/savePerson&#34;&nbsp;</font><font color="#000000">scope=</font><font color="#2a00ff">&#34;request&#34;</font><br/>
<font color="#ffffff">&nbsp;</font><font color="#000000">*&nbsp;&nbsp;validate=</font><font color="#2a00ff">&#34;true&#34;&nbsp;</font><font color="#000000">parameter=</font><font color="#2a00ff">&#34;method&#34;&nbsp;</font><font color="#000000">input=</font><font color="#2a00ff">&#34;edit&#34;</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>So now, as long as your web/pages/personForm.jsp has &lt;html:form action="savePerson"&gt;, validation should kick in when we try to save this form.  Run <b>ant db-load deploy</b>, start Tomcat and go to <a class="external" href="http://localhost:8080/appfuse/editPerson.html?id=1">http://localhost:8080/appfuse/editPerson.html?id=1</a><img class="outlink" src="images/out.png" alt="" />.
</p>
<p>If you erase the values in the firstName and lastName fields and click the save button, you should get the following JavaScript alert.
</p>
<div style="margin: 0 auto; height: 128px; width: 318px">
<img class="inline" src="attach/ValidationAndList/validation-required.png" alt="validation-required.png" />
</div>
<p>To make sure things are <i>really</i> working as expected, you can turn off JavaScript and ensure the server-side validation is working.  This is easy in <a class="external" href="http://www.mozilla.org/products/firefox/">Firefox</a><img class="outlink" src="images/out.png" alt="" /> (my favorite browser), just go to Tools &rarr; Options &rarr; Web Features and uncheck "Enable JavaScript".  Now if you clear the fields and save the form, you should see the following:
</p>
<div style="border: 1px solid black; margin: 0 auto; height: 215px; width: 521px">
<img class="inline" src="attach/ValidationAndList/validation-required-nojs.png" alt="validation-required-nojs.png" />
</div>
<p>If you don't see these validation errors, there are a couple possibilities:
</p>
<ul>
<li> The form saves with a success message, but the firstName and lastName fields are now blank.
</li>
</ul>
<dl>
<dt></dt><dd><i>This is because the &lt;html:form&gt; in web/pages/personForm.jsp has action="editPerson" - make sure it has <b>action="savePerson"</b>.</i></dd>
</dl>
<ul>
<li> You click save, but a blank page appears.
</li>
</ul>
<dl>
<dt></dt><dd><i>The blank page indicates that the "input" attribute of you "savePerson" forward is incorrectly configured.  Make sure it relates to a local or global action-forward.  In this example, it should be <b>input="edit"</b>, which points to the .personDetail tile's definition.  From my experience, the input's value must be a forward, not a path to an action.</i></dd>
</dl>
 
If you only want server-side validation (no JavaScript), you can remove the <i>onsubmit</i> attribute of &lt;html:form&gt; (in web/pages/personForm.jsp) as well as the Validator JavaScript tags at the bottom of the page.
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#000000">&lt;html:javascript&nbsp;formName=</font><font color="#2a00ff">&#34;personForm&#34;&nbsp;</font><font color="#000000">cdata=</font><font color="#2a00ff">&#34;false&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">dynamicJavascript=</font><font color="#2a00ff">&#34;true&#34;&nbsp;</font><font color="#000000">staticJavascript=</font><font color="#2a00ff">&#34;false&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#000000">&lt;script&nbsp;type=</font><font color="#2a00ff">&#34;text/javascript&#34;&nbsp;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">src=</font><font color="#2a00ff">&#34;&lt;html:rewrite&nbsp;page=&#34;</font><font color="#000000">/scripts/validator.jsp</font><font color="#2a00ff">&#34;/&gt;&#34;</font><font color="#000000">&gt;&lt;/script&gt;</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<h3 id='section-ValidationAndList-AddTestGetPeopleMethodsToDAOAndManagerTests3'>Add testGetPeople methods to DAO and Manager Tests <a class="footnote" name="ref-ValidationAndList-3">[#3]</a></h3>
To create a List screen (also called a master screen), we need to create methods that will return all the rows from our <i>person</i> table.  Let's start by adding tests for these methods to our PersonDaoTest and PersonManagerTest classes.  I usually name this method <i>getEntities</i> (i.e. getUsers), but you could also use <i>getAll</i> or <i>search</i> - it's really just a matter of personal preference.
<p>Open test/dao/**/dao/PersonDaoTest.java and add a <i>testGetPeople</i> method:
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">testGetPeople</font><font color="#000000">()&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">person&nbsp;=&nbsp;</font><font color="#7f0055"><b>new&nbsp;</b></font><font color="#000000">Person</font><font color="#000000">()</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">List&nbsp;results&nbsp;=&nbsp;dao.getPeople</font><font color="#000000">(</font><font color="#000000">person</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">assertTrue</font><font color="#000000">(</font><font color="#000000">results.size</font><font color="#000000">()&nbsp;</font><font color="#000000">&gt;&nbsp;</font><font color="#990000">0</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>The reason I'm passing in a person object to the <i>getPeople</i> method is to allow for filtering (based on values in person) in the future. Adding this parameter in your getPeople() method signature is optional, but the rest of this tutorial assumes you have done this.
</p>
<p>Now open test/service/**/service/PersonManagerTest.java and add a <i>testGetPeople</i> method:
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">testGetPeople</font><font color="#000000">()&nbsp;</font><font color="#7f0055"><b>throws&nbsp;</b></font><font color="#000000">Exception&nbsp;</font><font color="#000000">{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">List&nbsp;results&nbsp;=&nbsp;</font><font color="#7f0055"><b>new&nbsp;</b></font><font color="#000000">ArrayList</font><font color="#000000">()</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">person&nbsp;=&nbsp;</font><font color="#7f0055"><b>new&nbsp;</b></font><font color="#000000">Person</font><font color="#000000">()</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">results.add</font><font color="#000000">(</font><font color="#000000">person</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f7f5f">//&nbsp;set&nbsp;expected&nbsp;behavior&nbsp;on&nbsp;dao</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">personDao.expects</font><font color="#000000">(</font><font color="#000000">once</font><font color="#000000">())</font><font color="#000000">.method</font><font color="#000000">(</font><font color="#2a00ff">&#34;getPeople&#34;</font><font color="#000000">)</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">.will</font><font color="#000000">(</font><font color="#000000">returnValue</font><font color="#000000">(</font><font color="#000000">results</font><font color="#000000">))</font><font color="#000000">;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">List&nbsp;people&nbsp;=&nbsp;personManager.getPeople</font><font color="#000000">(</font><font color="#7f0055"><b>null</b></font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">assertTrue</font><font color="#000000">(</font><font color="#000000">people.size</font><font color="#000000">()&nbsp;</font><font color="#000000">==&nbsp;</font><font color="#990000">1</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">personDao.verify</font><font color="#000000">()</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>In order for these tests to compile, you need to add the <i>getPeople()</i> method to the PersonDao and PersonManager interfaces, and their implementations.
</p>
<h3 id='section-ValidationAndList-AddGetPeopleMethodToDAOAndManager4'>Add getPeople() method to DAO and Manager <a class="footnote" name="ref-ValidationAndList-4">[#4]</a></h3>
Open src/dao/**/dao/PersonDao.java and add the getPeople() method signature:
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#000000">List&nbsp;getPeople</font><font color="#000000">(</font><font color="#000000">Person&nbsp;person</font><font color="#000000">)</font><font color="#000000">;</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>Now add the same method signature to src/service/**/service/<b>PersonManager.java</b>.  Save all your files and adjust the imports in your tests.  Next you need to implement the getPeople() method in your implementation classes.  Open src/dao/**/dao/hibernate/PersonDaoHibernate.java and add the following method:
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#000000">List&nbsp;getPeople</font><font color="#000000">(</font><font color="#000000">Person&nbsp;person</font><font color="#000000">)&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>return&nbsp;</b></font><font color="#000000">getHibernateTemplate</font><font color="#000000">()</font><font color="#000000">.find</font><font color="#000000">(</font><font color="#2a00ff">&#34;from&nbsp;Person&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p><div class="note" style="margin-left: 30px">
You'll notice here that nothing is being done with the <i>person</i> parameter.  This is just a placeholder for now - in the future you may want to filter on it's properties using <a class="external" href="http://www.hibernate.org/hib_docs/reference/en/html/queryhql.html">Hibernate's Query Language</a><img class="outlink" src="images/out.png" alt="" /> (HQL) or using <a class="external" href="http://www.hibernate.org/hib_docs/reference/en/html/querycriteria.html">Criteria Queries</a><img class="outlink" src="images/out.png" alt="" />.
</p>
<p><i>An example using a Criteria Query:</i>
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f7f5f">//&nbsp;filter&nbsp;on&nbsp;properties&nbsp;set&nbsp;in&nbsp;the&nbsp;person&nbsp;object</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">HibernateCallback&nbsp;callback&nbsp;=&nbsp;</font><font color="#7f0055"><b>new&nbsp;</b></font><font color="#000000">HibernateCallback</font><font color="#000000">()&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#000000">Object&nbsp;doInHibernate</font><font color="#000000">(</font><font color="#000000">Session&nbsp;session</font><font color="#000000">)&nbsp;</font><font color="#7f0055"><b>throws&nbsp;</b></font><font color="#000000">HibernateException&nbsp;</font><font color="#000000">{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">Example&nbsp;ex&nbsp;=&nbsp;Example.create</font><font color="#000000">(</font><font color="#000000">person</font><font color="#000000">)</font><font color="#000000">.ignoreCase</font><font color="#000000">()</font><font color="#000000">.ignoreZeroes</font><font color="#000000">()</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">.enableLike</font><font color="#000000">(</font><font color="#000000">MatchMode.ANYWHERE</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>return&nbsp;</b></font><font color="#000000">session.createCriteria</font><font color="#000000">(</font><font color="#000000">Person.</font><font color="#7f0055"><b>class</b></font><font color="#000000">)</font><font color="#000000">.add</font><font color="#000000">(</font><font color="#000000">ex</font><font color="#000000">)</font><font color="#000000">.list</font><font color="#000000">()</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>return&nbsp;</b></font><font color="#000000">(</font><font color="#000000">List</font><font color="#000000">)&nbsp;</font><font color="#000000">getHibernateTemplate</font><font color="#000000">()</font><font color="#000000">.execute</font><font color="#000000">(</font><font color="#000000">callback</font><font color="#000000">)</font><font color="#000000">;</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</div>
</p>
<p>Now implement the <i>getPeople()</i> method in src/service/**/impl/PersonManagerImpl.java:
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#000000">List&nbsp;getPeople</font><font color="#000000">(</font><font color="#000000">Person&nbsp;person</font><font color="#000000">)&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>return&nbsp;</b></font><font color="#000000">dao.getPeople</font><font color="#000000">(</font><font color="#000000">person</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>After saving all your changes, you should be able to run both tests by executing the following: 
</p>
<ul>
<li> <b>ant test-dao -Dtestcase=PersonDao</b> 
</li>
<li> <b>ant test-service -Dtestcase=PersonManager</b>
</li>
</ul>
<p>If everything works - <i>nice job!</i> Now you need to add this <i>retrieve all</i> functionality to the web tier.
</p>
<h3 id='section-ValidationAndList-AddTestSearchMethodToActionTest5'>Add testSearch() method to Action Test <a class="footnote" name="ref-ValidationAndList-5">[#5]</a></h3>
Open test/web/**/action/PersonActionTest.java and add the following method:
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">testSearch</font><font color="#000000">()&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">setRequestPathInfo</font><font color="#000000">(</font><font color="#2a00ff">&#34;/editPerson&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">addRequestParameter</font><font color="#000000">(</font><font color="#2a00ff">&#34;method&#34;</font><font color="#000000">,&nbsp;</font><font color="#2a00ff">&#34;Search&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">actionPerform</font><font color="#000000">()</font><font color="#000000">;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">verifyForward</font><font color="#000000">(</font><font color="#2a00ff">&#34;list&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">assertNotNull</font><font color="#000000">(</font><font color="#000000">getRequest</font><font color="#000000">()</font><font color="#000000">.getAttribute</font><font color="#000000">(</font><font color="#000000">Constants.PERSON_LIST</font><font color="#000000">))</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">verifyNoActionErrors</font><font color="#000000">()</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>This class will not compile until you add the PERSON_LIST variable to the src/dao/**/Constants.java file.
</p>
<dl>
<dt></dt><dd><span style="color: blue"><i>I usually copy a similar variable that already exists in this file - i.e. USER_LIST.</i></dd>
</dl>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">/**</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*&nbsp;The&nbsp;request&nbsp;scope&nbsp;attribute&nbsp;that&nbsp;holds&nbsp;the&nbsp;person&nbsp;list</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*/</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;static&nbsp;final&nbsp;</b></font><font color="#000000">String&nbsp;PERSON_LIST&nbsp;=&nbsp;</font><font color="#2a00ff">&#34;personList&#34;</font><font color="#000000">;</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>Now save all your changes. You won't be able to run <b>ant test-web -Dtestcase=PersonAction</b> yet since <i>PersonAction.search()</i> does not exist (yet). 
</p>
<h3 id='section-ValidationAndList-AddSearchMethodToAction6'>Add search method to Action <a class="footnote" name="ref-ValidationAndList-6">[#6]</a></h3>
Open src/web/**/action/PersonAction.java and add the following XDoclet tag at the top - to forward to our list screen.
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;</font><font color="#000000">*&nbsp;@struts.action-forward&nbsp;name=</font><font color="#2a00ff">&#34;list&#34;&nbsp;</font><font color="#000000">path=</font><font color="#2a00ff">&#34;/WEB-INF/pages/personList.jsp&#34;</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>Now add the search method to the body of the PersonAction class.
</p>
<dl>
<dt></dt><dd><span style="color: blue"><i>I used UserAction.search() as a template for this method.</i></dd>
</dl>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#000000">ActionForward&nbsp;search</font><font color="#000000">(</font><font color="#000000">ActionMapping&nbsp;mapping,&nbsp;ActionForm&nbsp;form,</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">HttpServletRequest&nbsp;request,</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">HttpServletResponse&nbsp;response</font><font color="#000000">)</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>throws&nbsp;</b></font><font color="#000000">Exception&nbsp;</font><font color="#000000">{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>if&nbsp;</b></font><font color="#000000">(</font><font color="#000000">log.isDebugEnabled</font><font color="#000000">())&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">log.debug</font><font color="#000000">(</font><font color="#2a00ff">&#34;Entering&nbsp;'search'&nbsp;method&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">PersonManager&nbsp;mgr&nbsp;=&nbsp;</font><font color="#000000">(</font><font color="#000000">PersonManager</font><font color="#000000">)&nbsp;</font><font color="#000000">getBean</font><font color="#000000">(</font><font color="#2a00ff">&#34;personManager&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">List&nbsp;people&nbsp;=&nbsp;mgr.getPeople</font><font color="#000000">(</font><font color="#7f0055"><b>null</b></font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">request.setAttribute</font><font color="#000000">(</font><font color="#000000">Constants.PERSON_LIST,&nbsp;people</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f7f5f">//&nbsp;return&nbsp;a&nbsp;forward&nbsp;to&nbsp;the&nbsp;person&nbsp;list&nbsp;definition</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>return&nbsp;</b></font><font color="#000000">mapping.findForward</font><font color="#000000">(</font><font color="#2a00ff">&#34;list&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>Run <b>ant test-web -Dtestcase=PersonAction</b>.
</p>
<p><b>Nice!</b>
<span style="color:green">BUILD SUCCESSFUL<br />
Total time: 1 minute 26 seconds</span>
</p>
<h3 id='section-ValidationAndList-CreatePersonList.jspAndCanooTest7'>Create personList.jsp and Canoo test <a class="footnote" name="ref-ValidationAndList-7">[#7]</a></h3>
Open the personList.jsp file in <i>web/pages</i>. You'll probably want to change the code to show the plural form of the items you're listing.  The generated name in this example is "persons" and it should probably be people.  At or near line 31, you should have the following line:
<pre>&lt;display:setProperty name="paging.banner.items_name" value="persons"/&gt;</pre>

<p>Change it to:
</p>
<pre>&lt;display:setProperty name="paging.banner.items_name" value="people"/&gt;</pre>

<p>Finally, add the title and heading keys (personList.title and personList.heading) to web/WEB-INF/classes/ApplicationResources.properties.  Open this file and add the following:
</p>
<pre>
# -- person list page --
personList.title=Person List
personList.heading=All People
</pre>

<p>As a reminder, the <tt>personList.title</tt> is what ends up in the brower's title bar (the &lt;title&gt; tag) and 
<tt>personList.heading</tt> will be put into an &lth1&gt; tag before any page content.  
</p>
<p>At this point, you should be able to run <b>ant clean deploy</b>, start Tomcat and view this page in your browser at <a class="external" href="http://localhost:8080/appfuse/editPerson.html?method=Search">http://localhost:8080/appfuse/editPerson.html?method=Search</a><img class="outlink" src="images/out.png" alt="" />.
</p>
<p>Now that we have a List Screen, let's change the pages that are displayed after adding and deleting a new Person.  In src/web/**/action/PersonAction.java, change the <i>mapping.findForward("mainMenu")</i> in the <i>save</i>, <i>delete</i> and <i>cancel</i> methods to be:
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>return&nbsp;</b></font><font color="#000000">mapping.findForward</font><font color="#000000">(</font><font color="#2a00ff">&#34;viewPeople&#34;</font><font color="#000000">)</font><font color="#000000">;</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>You will also need to change <i>verifyForward("mainMenu")</i> to be <i>verifyForward("viewPeople")</i> in the testRemove method of test/web/**/action/PersonActionTest.java.  Lastly, the Canoo tests "AddPerson" and "DeletePerson" need to be updated.  Open test/web/web-tests.xml and change the following line in the "AddPerson" target:
</p>
<pre>&lt;verifytitle description="Main Menu appears if save successful" 
    text=".*${mainMenu.title}.*" regex="true"/&gt;</pre>

<p>to: 
</p>
<pre>&lt;verifytitle description="Person List appears if save successful" 
    text=".*${personList.title}.*" regex="true"/&gt;</pre>

<p>Then in the "DeletePerson" target, change the following line:
</p>
<pre>&lt;verifytitle description="display Main Menu" 
    text=".*$(mainMenu.title}.*" regex="true"/&gt;
</pre>

<p>to:
</p>
<pre>&lt;verifytitle description="display Person List" text=".*${personList.title}.*" regex="true"/&gt;</pre>

<p>Finally, declare the viewPeople forward in metadata/web/global-forwards.xml after viewUsers as below:
</p>
<pre>&lt;forward name="viewPeople" path="/editPerson.html?method=Search"/&gt;</pre>

<p>The name "viewPeople" is used instead of "list" so that the search method will be executed, rather than simply forwarding to the personForm.jsp (which the "list" forward points to). 
</p>
<p>To test that displaying this page works, create a new JSP test in test/web/web-tests.xml:
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;!--&nbsp;Verify&nbsp;the&nbsp;people&nbsp;list&nbsp;screen&nbsp;displays&nbsp;without&nbsp;errors&nbsp;--&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;target&nbsp;name=</font><font color="#2a00ff">&#34;SearchPeople&#34;&nbsp;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">description=</font><font color="#2a00ff">&#34;Tests&nbsp;search&nbsp;for&nbsp;and&nbsp;displaying&nbsp;all&nbsp;people&#34;</font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;webtest&nbsp;name=</font><font color="#2a00ff">&#34;searchPeople&#34;</font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&amp;config;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;steps&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&amp;login;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;invoke&nbsp;description=</font><font color="#2a00ff">&#34;click&nbsp;View&nbsp;People&nbsp;link&#34;&nbsp;</font><font color="#000000">url=</font><font color="#2a00ff">&#34;/editPerson.html?method=Search&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;verifytitle&nbsp;description=</font><font color="#2a00ff">&#34;we&nbsp;should&nbsp;see&nbsp;the&nbsp;personList&nbsp;title&#34;&nbsp;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">text=</font><font color="#2a00ff">&#34;.*${personList.title}.*&#34;&nbsp;</font><font color="#000000">regex=</font><font color="#2a00ff">&#34;true&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/steps&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/webtest&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/target&gt;</font><br/>
<font color="#ffffff"></font><font color="#ffffff">
</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>You'll also want to add the "SearchPeople" target to the "PersonTests" target so it will be executed along with all the other person-related tests.
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;!--&nbsp;runs&nbsp;person-related&nbsp;tests&nbsp;--&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;target&nbsp;name=</font><font color="#2a00ff">&#34;PersonTests&#34;&nbsp;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">depends=</font><font color="#2a00ff">&#34;SearchPeople,EditPerson,SavePerson,AddPerson,DeletePerson&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">description=</font><font color="#2a00ff">&#34;Call&nbsp;and&nbsp;executes&nbsp;all&nbsp;person&nbsp;test&nbsp;cases&nbsp;(targets)&#34;</font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;echo&gt;Successfully&nbsp;ran&nbsp;all&nbsp;Person&nbsp;JSP&nbsp;tests!&lt;/echo&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/target&gt;</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>Now you can run <b>ant test-canoo -Dtestcase=SearchPeople</b> (or <i>ant test-jsp</i> if Tomcat isn't running) and hopefully it will result in "BUILD SUCCESSFUL".  If so - <i>nice work!</i>
</p>
<h3 id='section-ValidationAndList-AddLinkToMenu8'>Add link to menu <a class="footnote" name="ref-ValidationAndList-8">[#8]</a></h3>
The last step is to make the list, add, edit and delete functions visible to the user.  The simplest way is to add a new link to the list of links in web/pages/mainMenu.jsp:
<p></p>
<span class="note"><b>NOTE:</b> The other links in mainMenu.jsp don't use <html:link> so this JSP can be shared among the various web framework implementations in AppFuse (i.e. Spring MVC and WebWork).</span>
<p></p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;li&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;html:link&nbsp;forward=</font><font color="#2a00ff">&#34;viewPeople&#34;</font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;fmt:message&nbsp;key=</font><font color="#2a00ff">&#34;menu.viewPeople&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/html:link&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/li&gt;</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>Where <i>menu.viewPeople</i> is an entry in web/WEB-INF/classes/ApplicationResources.properties.
</p>
<pre>
menu.viewPeople=View People
</pre>

<p>The other (more likely) alternative is that you'll want to add it to the menu.  To do this, add the following to web/WEB-INF/menu-config.xml:
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#000000">&lt;Menu&nbsp;name=</font><font color="#2a00ff">&#34;PeopleMenu&#34;&nbsp;</font><font color="#000000">title=</font><font color="#2a00ff">&#34;menu.viewPeople&#34;&nbsp;</font><font color="#000000">forward=</font><font color="#2a00ff">&#34;viewPeople&#34;</font><font color="#000000">/&gt;</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>Make sure the above XML is inside the &lt;Menus&gt; tag, but not within another &lt;Menu&gt;.  Then add this new menu to web/pages/menu.jsp - which should now look as follows:
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#000000">&lt;%@&nbsp;include&nbsp;file=</font><font color="#2a00ff">&#34;/common/taglibs.jsp&#34;</font><font color="#000000">%&gt;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#000000">&lt;div&nbsp;id=</font><font color="#2a00ff">&#34;menu&#34;</font><font color="#000000">&gt;</font><br/>
<font color="#000000">&lt;menu:useMenuDisplayer&nbsp;name=</font><font color="#2a00ff">&#34;ListMenu&#34;&nbsp;</font><font color="#000000">permissions=</font><font color="#2a00ff">&#34;rolesAdapter&#34;</font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;menu:displayMenu&nbsp;name=</font><font color="#2a00ff">&#34;AdminMenu&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;menu:displayMenu&nbsp;name=</font><font color="#2a00ff">&#34;UserMenu&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;menu:displayMenu&nbsp;name=</font><font color="#2a00ff">&#34;PeopleMenu&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;menu:displayMenu&nbsp;name=</font><font color="#2a00ff">&#34;FileUpload&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;menu:displayMenu&nbsp;name=</font><font color="#2a00ff">&#34;FlushCache&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;menu:displayMenu&nbsp;name=</font><font color="#2a00ff">&#34;Clickstream&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#000000">&lt;/menu:useMenuDisplayer&gt;</font><br/>
<font color="#000000">&lt;/div&gt;</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>Now if you run <b>ant clean deploy</b> start Tomcat and go to <a class="external" href="http://localhost:8080/appfuse/mainMenu.html">http://localhost:8080/appfuse/mainMenu.html</a><img class="outlink" src="images/out.png" alt="" />, you should see something like the screenshot below.
</p>
<div style="border: 1px solid black; margin: 0px auto; width: 551px; height: 184px">
<img class="inline" src="attach/ValidationAndList/new-menu-item.png" alt="new-menu-item.png" />
</div>
<p>Notice that there is a new link on the left side (from mainMenu.jsp) and on the right in our menu (from menu.jsp).
</p>
<h3 id='section-ValidationAndList-ThatsIt'>That's it!</h3>
You've completed the full lifecycle of developing a set of master-detail pages with AppFuse and Struts - <b>Congratulations</b>!  Now the real test is if you can run all the tests in your app without failure.  To test, stop tomcat and run <b>ant clean test-all</b>.  This will run all the unit tests within your project.  As a reminder, it should be easy to setup and test AppFuse from scratch using <b>ant setup-db setup-tomcat test-all</b>.  Also, if you're looking for more robust examples - checkout <a class="wikipage" href="Wiki.jsp?page=StrutsResume">Struts Resume</a>.
<p><i><b>Happy Day!</b></i>
</p>
<div style="color: green">
BUILD SUCCESSFUL<br />
Total time: 2 minutes 31 seconds
</div>
<A NAME="Link_ValidationAndListJSF">
<h1>ValidationAndListJSF</h1>
</A>
<b>Part IV:</b> <a class="wikipage" href="Wiki.jsp?page=ValidationAndListJSF">Adding Validation and List Screen</a> - Explains validation logic that makes the firstName and lastName required fields.  Also shows how to add a list screen to display all person records in the database.
<dl>
<dt></dt><dd><i>This tutorial depends on <b>Part III:</b> <a class="wikipage" href="Wiki.jsp?page=JSFBeans">Creating JSF Pages and JSPs</a>.</i></dd>
</dl>
<h3 id='section-ValidationAndListJSF-AboutThisTutorial'>About this Tutorial</h3>
This tutorial will show you how to add Validation logic to the Person object using JSF's Validation framework. You'll also create a list screen using the <a class="external" href="http://displaytag.sf.net">Display Tag Library</a><img class="outlink" src="images/out.png" alt="" /> to display all the people in the database.
<dl>
<dt></dt><dd><span style="color: blue"><i>I will tell you how I do stuff in the <b>Real World</b> in text like this.</i></span></dd>
</dl>
<h4 id='section-ValidationAndListJSF-TableOfContents'>Table of Contents</h4>
<ul>
<li> <a class="footnoteref" href="#ref-ValidationAndListJSF-1">[1]</a> View validation settings in personForm.jsp
</li>
<li> <a class="footnoteref" href="#ref-ValidationAndListJSF-2">[2]</a> View JSP with validation added and test
</li>
<li> <a class="footnoteref" href="#ref-ValidationAndListJSF-3">[3]</a> Add <i>testGetPeople</i> methods to DAO and Manager Tests
</li>
<li> <a class="footnoteref" href="#ref-ValidationAndListJSF-4">[4]</a> Add <i>getPeople</i> methods to PersonDao and Manager
</li>
<li> <a class="footnoteref" href="#ref-ValidationAndListJSF-5">[5]</a> Create PersonListTest
</li>
<li> <a class="footnoteref" href="#ref-ValidationAndListJSF-6">[6]</a> Create PersonForm  
</li>
<li> <a class="footnoteref" href="#ref-ValidationAndListJSF-7">[7]</a> Create people.jsp and Canoo test
</li>
<li> <a class="footnoteref" href="#ref-ValidationAndListJSF-8">[8]</a> Add link to menu
</li>
</ul>
<h3 id='section-ValidationAndListJSF-ViewValidationLogicInPersonForm.page1'>View validation logic in personForm.page <a class="footnote" name="ref-ValidationAndListJSF-1">[#1]</a></h3>
Implementing validation with JSF is quite simple.  For server-side validation, all you need to do is add <i>required="true"</i> to your &lt;h:inputText> tags.  For client-side validation, you'll need to add a nested &lt;v:commonsValidator> tag.  Other validations (besides required) can be specified by nested validation tags in your inputText tags.
<p>The validation integration for the personForm.html page is already done by AppGen in the personForm.page.  If you open web/personForm.jsp, you should see the following JSP Tags.  I've highlighted the portions that are relevant to validation.
</p>
<p><pre>
    &lt;h:inputText id="firstName" value="#{personForm.person.firstName}" <span style="background-color: yellow">required="true"</span>&gt;
        <span style="background-color: yellow">&lt;v:commonsValidator type="required" arg="#{text&#91;'person.firstName'&#93;}"/&gt;</span>
    &lt;/h:inputText&gt;
</pre>
</p>
<p>The commonsValidator tag was found in David Geary's Core JSF book. AppFuse also contains a custom LabelRenderer for the &lt;h:outputLabel&gt; tag.  This render will add asterisks for required fields.
</p>
<p>There are a <a class="external" href="http://www.marinschek.com/myfaces/tiki/tiki-index.php?page=Features">number of different validators</a><img class="outlink" src="images/out.png" alt="" /> you can use, this example just shows a way to validate Strings are entered.  The userForm.jsp contains examples of validation e-mail and validating with regular expressions. All input fields generated by AppGen are required by default.  You can change this by modifying the extras/appgen/src/**/Form_jsp.xdt file.
</p>
<h3 id='section-ValidationAndListJSF-ViewJSPWithValidationAddedAndTest2'>View JSP with validation added and test <a class="footnote" name="ref-ValidationAndListJSF-2">[#2]</a></h3>
To test the current validation configuration for the person form, run <b>ant db-load deploy</b>, and start Tomcat.  Then go to <a class="external" href="http://localhost:8080/appfuse">http://localhost:8080/appfuse</a><img class="outlink" src="images/out.png" alt="" />, login and click on the "Edit Person" link on the Main Menu.
<p>If you erase the values in the firstName and lastName fields and click the save button, you should get the following JavaScript alert.
</p>
<div style="margin: 0 auto; height: 128px; width: 318px">
<img class="inline" src="attach/ValidationAndListJSF/validation-required.png" alt="validation-required.png" />
</div>
<p>JSF does not seem to allow injecting the field label into the error message for server-side validation errors.  For more information see <a class="external" href="http://nagoya.apache.org/eyebrowse/ReadMsg?listName=myfaces-user@incubator.apache.org&amp;amp;msgNo=451">this mailing list thread</a><img class="outlink" src="images/out.png" alt="" />. 
</p>
<p>To make sure things are <i>really</i> working as expected, you can turn off JavaScript and ensure the server-side validation is working.  This is easy in <a class="external" href="http://www.mozilla.org/products/firefox/">Mozilla Firefox</a><img class="outlink" src="images/out.png" alt="" /> (my favorite browser), just go to Tools &rarr; Options &rarr; Web Features and uncheck "Enable JavaScript".  Now if you clear the fields and save the form, you should see the following:
</p>
<div style="border: 1px solid black; margin: 0 auto; height: 215px; width: 462px">
<img class="inline" src="attach/ValidationAndListJSF/validation-required-nojs.png" alt="validation-required-nojs.png" />
</div>
<h3 id='section-ValidationAndListJSF-AddTestGetPeopleMethodsToDAOAndManagerTests3'>Add testGetPeople methods to DAO and Manager Tests <a class="footnote" name="ref-ValidationAndListJSF-3">[#3]</a></h3>
To create a List screen (also called a master screen), we need to create methods that will return all the rows from our <i>person</i> table.  Let's start by adding tests for these methods to our PersonDaoTest and PersonManagerTest classes.  I usually name this method <i>getEntities</i> (i.e. getUsers), but you could also use <i>getAll</i> or <i>search</i> - it's really just a matter of personal preference.
<p>Open test/dao/**/dao/PersonDaoTest.java and add a <i>testGetPeople</i> method:
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">testGetPeople</font><font color="#000000">()&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">person&nbsp;=&nbsp;</font><font color="#7f0055"><b>new&nbsp;</b></font><font color="#000000">Person</font><font color="#000000">()</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">List&nbsp;results&nbsp;=&nbsp;dao.getPeople</font><font color="#000000">(</font><font color="#000000">person</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">assertTrue</font><font color="#000000">(</font><font color="#000000">results.size</font><font color="#000000">()&nbsp;</font><font color="#000000">&gt;&nbsp;</font><font color="#990000">0</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>The reason I'm passing in a person object to the <i>getPeople</i> method is to allow for filtering (based on values in person) in the future. Adding this parameter in your getPeople() method signature is optional, but the rest of this tutorial assumes you have done this.
</p>
<p>Now open test/service/**/service/PersonManagerTest.java and add a <i>testGetPeople</i> method:
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">testGetPeople</font><font color="#000000">()&nbsp;</font><font color="#7f0055"><b>throws&nbsp;</b></font><font color="#000000">Exception&nbsp;</font><font color="#000000">{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">List&nbsp;results&nbsp;=&nbsp;</font><font color="#7f0055"><b>new&nbsp;</b></font><font color="#000000">ArrayList</font><font color="#000000">()</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">person&nbsp;=&nbsp;</font><font color="#7f0055"><b>new&nbsp;</b></font><font color="#000000">Person</font><font color="#000000">()</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">results.add</font><font color="#000000">(</font><font color="#000000">person</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f7f5f">//&nbsp;set&nbsp;expected&nbsp;behavior&nbsp;on&nbsp;dao</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">personDao.expects</font><font color="#000000">(</font><font color="#000000">once</font><font color="#000000">())</font><font color="#000000">.method</font><font color="#000000">(</font><font color="#2a00ff">&#34;getPeople&#34;</font><font color="#000000">)</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">.will</font><font color="#000000">(</font><font color="#000000">returnValue</font><font color="#000000">(</font><font color="#000000">results</font><font color="#000000">))</font><font color="#000000">;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">List&nbsp;people&nbsp;=&nbsp;personManager.getPeople</font><font color="#000000">(</font><font color="#7f0055"><b>null</b></font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">assertTrue</font><font color="#000000">(</font><font color="#000000">people.size</font><font color="#000000">()&nbsp;</font><font color="#000000">==&nbsp;</font><font color="#990000">1</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">personDao.verify</font><font color="#000000">()</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>In order for these tests to compile, you need to add the <i>getPeople()</i> method to the PersonDao and PersonManager interfaces, and their implementations.
</p>
<h3 id='section-ValidationAndListJSF-AddGetPeopleMethodToDAOAndManager4'>Add getPeople() method to DAO and Manager <a class="footnote" name="ref-ValidationAndListJSF-4">[#4]</a></h3>
Open src/dao/**/dao/PersonDao.java and add the getPeople() method signature:
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#000000">List&nbsp;getPeople</font><font color="#000000">(</font><font color="#000000">Person&nbsp;person</font><font color="#000000">)</font><font color="#000000">;</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>Now add the same method signature to src/service/**/service/<b>PersonManager.java</b>.  Save all your files and adjust the imports in your tests.  Next you need to implement the getPeople() method in your implementation classes.  Open src/dao/**/dao/hibernate/PersonDaoHibernate.java and add the following method:
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#000000">List&nbsp;getPeople</font><font color="#000000">(</font><font color="#000000">Person&nbsp;person</font><font color="#000000">)&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>return&nbsp;</b></font><font color="#000000">getHibernateTemplate</font><font color="#000000">()</font><font color="#000000">.find</font><font color="#000000">(</font><font color="#2a00ff">&#34;from&nbsp;Person&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p><div class="note" style="margin-left: 30px">
You'll notice here that nothing is being done with the <i>person</i> parameter.  This is just a placeholder for now - in the future you may want to filter on it's properties using <a class="external" href="http://www.hibernate.org/hib_docs/reference/en/html/queryhql.html">Hibernate's Query Language</a><img class="outlink" src="images/out.png" alt="" /> (HQL) or using <a class="external" href="http://www.hibernate.org/hib_docs/reference/en/html/querycriteria.html">Criteria Queries</a><img class="outlink" src="images/out.png" alt="" />.
</p>
<p><i>An example using a Criteria Query:</i>
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">Example&nbsp;example&nbsp;=&nbsp;Example.create</font><font color="#000000">(</font><font color="#000000">person</font><font color="#000000">)</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">.excludeZeroes</font><font color="#000000">()&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f7f5f">//&nbsp;exclude&nbsp;zero&nbsp;valued&nbsp;properties</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">.ignoreCase</font><font color="#000000">()</font><font color="#000000">;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f7f5f">//&nbsp;perform&nbsp;case&nbsp;insensitive&nbsp;string&nbsp;comparisons</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>try&nbsp;</b></font><font color="#000000">{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>return&nbsp;</b></font><font color="#000000">getSession</font><font color="#000000">()</font><font color="#000000">.createCriteria</font><font color="#000000">(</font><font color="#000000">Person.</font><font color="#7f0055"><b>class</b></font><font color="#000000">)</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">.add</font><font color="#000000">(</font><font color="#000000">example</font><font color="#000000">)</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">.list</font><font color="#000000">()</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}&nbsp;</font><font color="#7f0055"><b>catch&nbsp;</b></font><font color="#000000">(</font><font color="#000000">Exception&nbsp;e</font><font color="#000000">)&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>throw&nbsp;new&nbsp;</b></font><font color="#000000">DataAccessException</font><font color="#000000">(</font><font color="#000000">e.getMessage</font><font color="#000000">())</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>return&nbsp;new&nbsp;</b></font><font color="#000000">ArrayList</font><font color="#000000">()</font><font color="#000000">;</font><br/>
<font color="#ffffff"></font><font color="#ffffff">
</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</div>
</p>
<p>Now implement the <i>getPeople()</i> method in src/service/**/impl/PersonManagerImpl.java:
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#000000">List&nbsp;getPeople</font><font color="#000000">(</font><font color="#000000">Person&nbsp;person</font><font color="#000000">)&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>return&nbsp;</b></font><font color="#000000">dao.getPeople</font><font color="#000000">(</font><font color="#000000">person</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>After saving all your changes, you should be able to run both tests by executing the following: 
</p>
<ul>
<li> <b>ant test-dao -Dtestcase=PersonDao</b> 
</li>
<li> <b>ant test-service -Dtestcase=PersonManager</b>
</li>
</ul>
<p>If everything works - <i>nice job!</i> Now you need to add this <i>retrieve all</i> functionality to the web tier.
</p>
<h3 id='section-ValidationAndListJSF-CreatePersonListTest5'>Create PersonListTest <a class="footnote" name="ref-ValidationAndListJSF-5">[#5]</a></h3>
In the last couple of tutorials, you've been working with the PersonForm to interact with your form JSP.  Now you need to create a new Managed Bean that'll simply handle getting and displaying a list of people in the database.  
<p>To begin, create test/web/**/action/PersonListTest.java add a test method for searching. 
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#7f0055"><b>package&nbsp;</b></font><font color="#000000">org.appfuse.webapp.action;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#7f0055"><b>public&nbsp;class&nbsp;</b></font><font color="#000000">PersonListTest&nbsp;</font><font color="#7f0055"><b>extends&nbsp;</b></font><font color="#000000">BasePageTestCase&nbsp;</font><font color="#000000">{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>private&nbsp;</b></font><font color="#000000">PersonList&nbsp;bean;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>protected&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">setUp</font><font color="#000000">()&nbsp;</font><font color="#7f0055"><b>throws&nbsp;</b></font><font color="#000000">Exception&nbsp;</font><font color="#000000">{&nbsp;&nbsp;&nbsp;&nbsp;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>super</b></font><font color="#000000">.setUp</font><font color="#000000">()</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">bean&nbsp;=&nbsp;</font><font color="#000000">(</font><font color="#000000">PersonList</font><font color="#000000">)&nbsp;</font><font color="#000000">getManagedBean</font><font color="#000000">(</font><font color="#2a00ff">&#34;personList&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>protected&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">tearDown</font><font color="#000000">()&nbsp;</font><font color="#7f0055"><b>throws&nbsp;</b></font><font color="#000000">Exception&nbsp;</font><font color="#000000">{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>super</b></font><font color="#000000">.tearDown</font><font color="#000000">()</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">bean&nbsp;=&nbsp;</font><font color="#7f0055"><b>null</b></font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">testSearch</font><font color="#000000">()&nbsp;</font><font color="#7f0055"><b>throws&nbsp;</b></font><font color="#000000">Exception&nbsp;</font><font color="#000000">{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">assertTrue</font><font color="#000000">(</font><font color="#000000">bean.getPeople</font><font color="#000000">()</font><font color="#000000">.size</font><font color="#000000">()&nbsp;</font><font color="#000000">&gt;=&nbsp;</font><font color="#990000">1</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">assertFalse</font><font color="#000000">(</font><font color="#000000">bean.hasErrors</font><font color="#000000">())</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#000000">}</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>This class will not compile until you create the PersonList class. 
</p>
<h3 id='section-ValidationAndListJSF-CreatePersonList6'>Create PersonList <a class="footnote" name="ref-ValidationAndListJSF-6">[#6]</a></h3>
Create src/web/**/action/PersonList.java.  It should read as follows: 
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#7f0055"><b>package&nbsp;</b></font><font color="#000000">org.appfuse.webapp.action;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">java.io.Serializable;</font><br/>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">java.util.List;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">org.appfuse.service.PersonManager;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#7f0055"><b>public&nbsp;class&nbsp;</b></font><font color="#000000">PersonList&nbsp;</font><font color="#7f0055"><b>extends&nbsp;</b></font><font color="#000000">BasePage&nbsp;</font><font color="#7f0055"><b>implements&nbsp;</b></font><font color="#000000">Serializable&nbsp;</font><font color="#000000">{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>private&nbsp;</b></font><font color="#000000">PersonManager&nbsp;personManager;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">setPersonManager</font><font color="#000000">(</font><font color="#000000">PersonManager&nbsp;manager</font><font color="#000000">)&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>this</b></font><font color="#000000">.personManager&nbsp;=&nbsp;manager;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#000000">List&nbsp;getPeople</font><font color="#000000">()&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>return&nbsp;</b></font><font color="#000000">personManager.getPeople</font><font color="#000000">(</font><font color="#7f0055"><b>null</b></font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#000000">}</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>Now you need to add the managed-bean definition for the PersonList class. Open web/WEB-INF/faces-config.xml and add the following managed-bean definition:
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;managed-bean&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;managed-bean-name&gt;personList&lt;/managed-bean-name&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;managed-bean-</font><font color="#7f0055"><b>class</b></font><font color="#000000">&gt;org.appfuse.webapp.action.PersonList&lt;/managed-bean-</font><font color="#7f0055"><b>class</b></font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;managed-bean-scope&gt;request&lt;/managed-bean-scope&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;managed-property&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;property-name&gt;personManager&lt;/property-name&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;value&gt;#</font><font color="#000000">{</font><font color="#000000">personManager</font><font color="#000000">}</font><font color="#000000">&lt;/value&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/managed-property&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/managed-bean&gt;</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>If you run <b>ant test-web -Dtestcase=PersonList</b>, the test should pass.  
</p>
<p><b>Nice!</b>
<span style="color:green">BUILD SUCCESSFUL<br />
Total time: 14 seconds</span>
</p>
<h3 id='section-ValidationAndListJSF-CreatePeople.jspAndCanooTest7'>Create people.jsp and Canoo test <a class="footnote" name="ref-ValidationAndListJSF-7">[#7]</a></h3>
There should already be a persons.jsp file in your <i>web</i> directory.  If not, you can create it using AppGen. From the command-line, navigate to extras/appgen and run <b>ant -Dobject.name=Person -Dappgen.type=pojo</b>.  This will generate a Persons.jsp file in <b>extras/appgen/build/gen/web</b>.  
<p>Copy PersonList.jsp to <i>web</i> and rename it to <b>people.jsp</b>. Open it for for editing. There are two references to "personList.persons".  Change those to be "personList.people".
</p>
<p><pre>
&lt;h:dataTable var="person" value="<span style="background-color: yellow">#{personList.people}</span>" style="display:none"/&gt;
    
&lt;display:table name="<span style="background-color: yellow">${personList.people}</span>" cellspacing="0" cellpadding="0"
    id="persons" pagesize="25" styleClass="list" 
    export="true" requestURI=""&gt;
</pre>
</p>
<p>You can also change the table's "id" and the associated JavaScript that refers to it.  This change is not as important as the previous one.
</p>
<p>You should already have the title and heading keys (personList.title and personList.heading) for the personList.html page in web/WEB-INF/classes/ApplicationResources.properties.  You should've added these keys in the previous tutorial.
</p>
<p>Now you need to add the navigation-rules for this page (near the top of web/WEB-INF/faces-config.xml):
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;navigation-rule&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;from-view-id&gt;/people.jsp&lt;/from-view-id&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;navigation-</font><font color="#7f0055"><b>case</b></font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;from-outcome&gt;add&lt;/from-outcome&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;to-view-id&gt;/personForm.jsp&lt;/to-view-id&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/navigation-</font><font color="#7f0055"><b>case</b></font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;navigation-</font><font color="#7f0055"><b>case</b></font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;from-outcome&gt;edit&lt;/from-outcome&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;to-view-id&gt;/personForm.jsp&lt;/to-view-id&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/navigation-</font><font color="#7f0055"><b>case</b></font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/navigation-rule&gt;</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>At this point, you should be able to run <b>ant clean deploy</b>, start Tomcat and view this page in your browser at <a class="external" href="http://localhost:8080/appfuse/people.html">http://localhost:8080/appfuse/people.html</a><img class="outlink" src="images/out.png" alt="" />.
</p>
<p>Now that you have a List Screen, let's change the pages that are displayed after adding and deleting a new Person.  In the faces-config.xml file, change the references for the personForm.jsp from "mainMenu" to "people".
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;navigation-rule&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;from-view-id&gt;/personForm.jsp&lt;/from-view-id&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;navigation-</font><font color="#7f0055"><b>case</b></font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;from-outcome&gt;cancel&lt;/from-outcome&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;to-view-id&gt;/people.jsp&lt;/to-view-id&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;redirect/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/navigation-</font><font color="#7f0055"><b>case</b></font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;navigation-</font><font color="#7f0055"><b>case</b></font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;from-outcome&gt;list&lt;/from-outcome&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;to-view-id&gt;/people.jsp&lt;/to-view-id&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;redirect/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/navigation-</font><font color="#7f0055"><b>case</b></font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/navigation-rule&gt;</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>In the last tutorial, the Canoo tests verify that the user sees the Main Menu after saving/editing a person.  Since you've changed that navigation-rule you need to update the tests. Open test/web/web-tests.xml and change any "mainMenu" references in the "PersonsTests" to be go to the people list.
</p>
<pre>&lt;verifytitle description="display Main Menu" text=".*${mainMenu.title}.*" regex="true"/&gt;</pre>

<p>Should become:
</p>
<pre>&lt;verifytitle description="Person List appears if save successful" text=".*${personList.title}.*" regex="true"/&gt;</pre>

<p>You will also need to change the Canoo tests to use the list screen for editing, rather than the Main Menu's "Edit Person" link. Change the &lt;clicklink> in "EditPerson", "SavePerson" and "DeletePerson" from
</p>
<pre>&lt;clicklink label="Edit Person"/&gt;</pre>

<p>to: 
</p>
<pre>             
&lt;invoke description="View People" url="/people.html"/&gt;
&lt;clicklink description="edit first record in list" label="1"/&gt;
</pre>

<p>To test that displaying this page works, create a new HTML test in test/web/web-tests.xml:
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;!--&nbsp;Verify&nbsp;the&nbsp;people&nbsp;list&nbsp;screen&nbsp;displays&nbsp;without&nbsp;errors&nbsp;--&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;target&nbsp;name=</font><font color="#2a00ff">&#34;SearchPeople&#34;&nbsp;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">description=</font><font color="#2a00ff">&#34;Tests&nbsp;search&nbsp;for&nbsp;and&nbsp;displaying&nbsp;all&nbsp;people&#34;</font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;webtest&nbsp;name=</font><font color="#2a00ff">&#34;searchPeople&#34;</font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&amp;config;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;steps&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&amp;login;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;invoke&nbsp;description=</font><font color="#2a00ff">&#34;click&nbsp;View&nbsp;People&nbsp;link&#34;&nbsp;</font><font color="#000000">url=</font><font color="#2a00ff">&#34;/people.html&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;verifytitle&nbsp;description=</font><font color="#2a00ff">&#34;we&nbsp;should&nbsp;see&nbsp;the&nbsp;personList&nbsp;title&#34;&nbsp;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">text=</font><font color="#2a00ff">&#34;.*${personList.title}.*&#34;&nbsp;</font><font color="#000000">regex=</font><font color="#2a00ff">&#34;true&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/steps&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/webtest&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/target&gt;</font><br/>
<font color="#ffffff"></font><font color="#ffffff">
</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>You'll also want to add the "SearchPeople" target to the "PersonTests" target so it will be executed along with all the other person-related tests.
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;!--&nbsp;runs&nbsp;person-related&nbsp;tests&nbsp;--&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;target&nbsp;name=</font><font color="#2a00ff">&#34;PersonTests&#34;&nbsp;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">depends=</font><font color="#2a00ff">&#34;SearchPeople,EditPerson,SavePerson,AddPerson,DeletePerson&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">description=</font><font color="#2a00ff">&#34;Call&nbsp;and&nbsp;executes&nbsp;all&nbsp;person&nbsp;test&nbsp;cases&nbsp;(targets)&#34;</font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;echo&gt;Successfully&nbsp;ran&nbsp;all&nbsp;Person&nbsp;JSP&nbsp;tests!&lt;/echo&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/target&gt;</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>Now you can run <b>ant test-canoo -Dtestcase=SearchPeople</b> (or <i>ant test-jsp</i> if Tomcat isn't running) and hopefully it will result in "BUILD SUCCESSFUL".  If so - <i>nice work!</i>
</p>
<h3 id='section-ValidationAndListJSF-AddLinkToMenu8'>Add link to menu <a class="footnote" name="ref-ValidationAndListJSF-8">[#8]</a></h3>
The last step is to make the list, add, edit and delete functions visible to the user.  The simplest way is to add a new link to the list of links in web/pages/mainMenu.html:
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;li&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;a&nbsp;href=</font><font color="#2a00ff">&#34;people.html&#34;</font><font color="#000000">&gt;&lt;fmt:message&nbsp;key=</font><font color="#2a00ff">&#34;menu.viewPeople&#34;</font><font color="#000000">/&gt;&lt;/a&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/li&gt;</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>Where <i>menu.viewPeople</i> is an entry in web/WEB-INF/classes/ApplicationResources.properties.
</p>
<pre>
menu.viewPeople=View People
</pre>

<p>The other (more likely) alternative is that you'll want to add it to the menu.  To do this, add the following to web/WEB-INF/menu-config.xml:
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#000000">&lt;Menu&nbsp;name=</font><font color="#2a00ff">&#34;PeopleMenu&#34;&nbsp;</font><font color="#000000">title=</font><font color="#2a00ff">&#34;menu.viewPeople&#34;&nbsp;</font><font color="#000000">page=</font><font color="#2a00ff">&#34;/people.html&#34;</font><font color="#000000">/&gt;&nbsp;</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>Make sure the above XML is inside the &lt;Menus&gt; tag, but not within another &lt;Menu&gt;.  Then add this new menu to web/pages/menu.jsp - which should now look as follows:
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#ffffff"></font><br/>
<font color="#000000">&lt;%@&nbsp;include&nbsp;file=</font><font color="#2a00ff">&#34;/common/taglibs.jsp&#34;</font><font color="#000000">%&gt;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#000000">&lt;div&nbsp;id=</font><font color="#2a00ff">&#34;menu&#34;</font><font color="#000000">&gt;</font><br/>
<font color="#000000">&lt;menu:useMenuDisplayer&nbsp;name=</font><font color="#2a00ff">&#34;ListMenu&#34;&nbsp;</font><font color="#000000">permissions=</font><font color="#2a00ff">&#34;rolesAdapter&#34;</font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;menu:displayMenu&nbsp;name=</font><font color="#2a00ff">&#34;AdminMenu&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;menu:displayMenu&nbsp;name=</font><font color="#2a00ff">&#34;UserMenu&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;menu:displayMenu&nbsp;name=</font><font color="#2a00ff">&#34;PeopleMenu&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;menu:displayMenu&nbsp;name=</font><font color="#2a00ff">&#34;FileUpload&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;menu:displayMenu&nbsp;name=</font><font color="#2a00ff">&#34;FlushCache&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;menu:displayMenu&nbsp;name=</font><font color="#2a00ff">&#34;Clickstream&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#000000">&lt;/menu:useMenuDisplayer&gt;</font><br/>
<font color="#000000">&lt;/div&gt;</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>Now if you run <b>ant clean deploy</b> start Tomcat and go to <a class="external" href="http://localhost:8080/appfuse/mainMenu.html">http://localhost:8080/appfuse/mainMenu.html</a><img class="outlink" src="images/out.png" alt="" />, you should see something like the screenshot below.
</p>
<div style="border: 1px solid black; margin: 0px auto; width: 551px; height: 184px">
<img class="inline" src="attach/ValidationAndList/new-menu-item.png" alt="ValidationAndList/new-menu-item.png" />
</div>
<p>Notice that there is a new link on the left side (from mainMenu.jsp) and on the right in our menu (from menu.jsp).
</p>
<h3 id='section-ValidationAndListJSF-ThatsIt'>That's it!</h3>
You've completed the full lifecycle of developing a set of master-detail pages with AppFuse and JSF - <b>Congratulations</b>!  Now the real test is if you can run all the tests in your app without failure.  To test, stop tomcat and run <b>ant clean test-all</b>.  This will run all the unit tests within your project.  As a reminder, it should be easy to setup and test AppFuse from scratch using <b>ant setup</b>.  
<p><i><b>Happy Day!</b></i>
</p>
<div style="color: green">
<p>BUILD SUCCESSFUL<br />
Total time: 2 minutes 40 seconds
</div>
</p>
<A NAME="Link_ValidationAndListSpring">
<h1>ValidationAndListSpring</h1>
</A>
<b>Part V:</b> <a class="wikipage" href="Wiki.jsp?page=ValidationAndListSpring">Adding Validation and List Screen</a> - Adding validation logic to the Person object so that firstName and lastName are required fields and adding a list screen to display all person records in the database.
<dl>
<dt></dt><dd><i>This tutorial depends on <b>Part III:</b> <a class="wikipage" href="Wiki.jsp?page=SpringControllers">Creating Controllers and JSPs</a>.</i></dd>
</dl>
<h3 id='section-ValidationAndListSpring-AboutThisTutorial'>About this Tutorial</h3>
This tutorial will show you how to add Validation logic (client and server-side) to the Person object using Commons Validator. We'll also create a list screen using the <a class="external" href="http://displaytag.sf.net">Display Tag Library</a><img class="outlink" src="images/out.png" alt="" /> to display all the people in the database.
<dl>
<dt></dt><dd><span style="color: blue"><i>I will tell you how I do stuff in the <b>Real World</b> in text like this.</i></span></dd>
</dl>
<h4 id='section-ValidationAndListSpring-TableOfContents'>Table of Contents</h4>
<ul>
<li> <a class="footnoteref" href="#ref-ValidationAndListSpring-1">[1]</a> Add XDoclet Validator tags to Person.java
</li>
<li> <a class="footnoteref" href="#ref-ValidationAndListSpring-2">[2]</a> View JSP with validation added and test
</li>
<li> <a class="footnoteref" href="#ref-ValidationAndListSpring-3">[3]</a> Add <i>testGetPeople</i> methods to DAO and Manager Tests
</li>
<li> <a class="footnoteref" href="#ref-ValidationAndListSpring-4">[4]</a> Add <i>getPeople</i> methods to PersonDao and Manager
</li>
<li> <a class="footnoteref" href="#ref-ValidationAndListSpring-5">[5]</a> Create PersonControllerTest 
</li>
<li> <a class="footnoteref" href="#ref-ValidationAndListSpring-6">[6]</a> Create PersonController
</li>
<li> <a class="footnoteref" href="#ref-ValidationAndListSpring-7">[7]</a> Create personList.jsp and Canoo test
</li>
<li> <a class="footnoteref" href="#ref-ValidationAndListSpring-8">[8]</a> Add link to menu
</li>
</ul>
<h3 id='section-ValidationAndListSpring-AddXDocletValidatorToPerson.java1'>Add XDoclet Validator to Person.java <a class="footnote" name="ref-ValidationAndListSpring-1">[#1]</a></h3>
To use Commons Validator with Spring MVC, normally you have to write a validation.xml file by hand.  However, thanks to XDoclet, it's much easier - you just need to add a couple of <i>@spring.validator</i> tags to our POJO (Person.java).  Let's open it up (src/dao/**/dao/Person.java) and modify your setFirstName and setLastName methods to resemble the following:
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">/**</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*&nbsp;@spring.validator&nbsp;type=&#34;required&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*/</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">setFirstName</font><font color="#000000">(</font><font color="#000000">String&nbsp;firstName</font><font color="#000000">)&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>this</b></font><font color="#000000">.firstName&nbsp;=&nbsp;firstName;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">/**</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*&nbsp;@spring.validator&nbsp;type=&#34;required&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*/</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">setLastName</font><font color="#000000">(</font><font color="#000000">String&nbsp;lastName</font><font color="#000000">)&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>this</b></font><font color="#000000">.lastName&nbsp;=&nbsp;lastName;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>I should mention that you can also add a <i>msgkey</i> attribute to this tag to override the default message key for this error.
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#000000">@spring.validator&nbsp;type=</font><font color="#2a00ff">&#34;required&#34;&nbsp;</font><font color="#000000">msgkey=</font><font color="#2a00ff">&#34;errors.required&#34;</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>The default key for type="required" is already <i>errors.required</i>, so I usually leave it to the default.  This key is defined in web/WEB-INF/classes/ApplicationResources_*.properties. 
</p>
<p>Now if you save Person.java and run <b>ant clean webdoclet</b>, a validation.xml file will be generated in build/appfuse/WEB-INF/.  It's contents should have now have an entry for "person".  
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;form&nbsp;name=</font><font color="#2a00ff">&#34;person&#34;</font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;field&nbsp;property=</font><font color="#2a00ff">&#34;firstName&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">depends=</font><font color="#2a00ff">&#34;required&#34;</font><font color="#000000">&gt;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;arg0&nbsp;key=</font><font color="#2a00ff">&#34;person.firstName&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/field&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;field&nbsp;property=</font><font color="#2a00ff">&#34;lastName&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">depends=</font><font color="#2a00ff">&#34;required&#34;</font><font color="#000000">&gt;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;arg0&nbsp;key=</font><font color="#2a00ff">&#34;person.lastName&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/field&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/form&gt;</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>To enable validation in personForm.jsp, you'll need to make sure your personForm.jsp has the following at the bottom:
</p>
<pre>&lt;html:javascript formName="person" cdata="false"
      dynamicJavascript="true" staticJavascript="false"/&gt;
&lt;script type="text/javascript" 
      src="&lt;c:url value="/scripts/validator.jsp"/&gt;"&gt;&lt;/script&gt;</pre>

<p>You'd also need to uncomment the "validator" property we commented out earlier.  Make sure the "personFormController" &lt;bean&gt; in web/WEB-INF/action-servlet.xml has the following XML:
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;bean&nbsp;id=</font><font color="#2a00ff">&#34;personFormController&#34;&nbsp;</font><font color="#7f0055"><b>class</b></font><font color="#000000">=</font><font color="#2a00ff">&#34;org.appfuse.webapp.action.PersonFormController&#34;</font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;property&nbsp;name=</font><font color="#2a00ff">&#34;commandName&#34;</font><font color="#000000">&gt;&lt;value&gt;person&lt;/value&gt;&lt;/property&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;property&nbsp;name=</font><font color="#2a00ff">&#34;commandClass&#34;</font><font color="#000000">&gt;&lt;value&gt;org.appfuse.model.Person&lt;/value&gt;&lt;/property&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;property&nbsp;name=</font><font color="#2a00ff">&#34;validator&#34;</font><font color="#000000">&gt;&lt;ref&nbsp;bean=</font><font color="#2a00ff">&#34;beanValidator&#34;</font><font color="#000000">/&gt;&lt;/property&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;property&nbsp;name=</font><font color="#2a00ff">&#34;formView&#34;</font><font color="#000000">&gt;&lt;value&gt;personForm&lt;/value&gt;&lt;/property&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;property&nbsp;name=</font><font color="#2a00ff">&#34;successView&#34;</font><font color="#000000">&gt;&lt;value&gt;mainMenu.html&lt;/value&gt;&lt;/property&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;property&nbsp;name=</font><font color="#2a00ff">&#34;personManager&#34;</font><font color="#000000">&gt;&lt;ref&nbsp;bean=</font><font color="#2a00ff">&#34;personManager&#34;</font><font color="#000000">/&gt;&lt;/property&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/bean&gt;</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<h3 id='section-ValidationAndListSpring-ViewJSPWithValidationAddedAndTest2'>View JSP with validation added and test <a class="footnote" name="ref-ValidationAndListSpring-2">[#2]</a></h3>
<p>Now that we have Validation configured for this form, let's make sure it works.  Run <b>ant db-load deploy</b>, start Tomcat and go to <a class="external" href="http://localhost:8080/appfuse/editPerson.html?id=1">http://localhost:8080/appfuse/editPerson.html?id=1</a><img class="outlink" src="images/out.png" alt="" />.  One thing you might notice is that the "First Name" and "Last Name" labels now have asterisks next to them - indicating required fields.  This is achieved with a LabelTag that looks up the validation rules from Commons Validator.
</p>
<p>If you erase the values in the firstName and lastName fields and click the save button, you should get the following JavaScript alert.
</p>
<div style="margin: 0 auto; height: 128px; width: 318px">
<img class="inline" src="attach/ValidationAndList/validation-required.png" alt="ValidationAndList/validation-required.png" />
</div>
<p>To make sure things are <i>really</i> working as expected, you can turn off JavaScript and ensure the server-side validation is working.  This is easy in <a class="external" href="http://www.mozilla.org/products/firebird/">Mozilla Firebird</a><img class="outlink" src="images/out.png" alt="" /> (my favorite browser), just go to Tools &rarr; Options &rarr; Web Features and uncheck "Enable JavaScript".  Now if you clear the fields and save the form, you should see the following:
</p>
<div style="border: 1px solid black; margin: 0 auto; height: 215px; width: 521px">
<img class="inline" src="attach/ValidationAndList/validation-required-nojs.png" alt="ValidationAndList/validation-required-nojs.png" />
</div>
<p></p>
<p>If you only want server-side validation (no JavaScript), you can remove the <i>onsubmit</i> attribute of &lt;html:form&gt; (in web/pages/personForm.jsp) as well as the Validator JavaScript tags at the bottom of the page.
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#000000">&lt;html:javascript&nbsp;formName=</font><font color="#2a00ff">&#34;personForm&#34;&nbsp;</font><font color="#000000">cdata=</font><font color="#2a00ff">&#34;false&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">dynamicJavascript=</font><font color="#2a00ff">&#34;true&#34;&nbsp;</font><font color="#000000">staticJavascript=</font><font color="#2a00ff">&#34;false&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#000000">&lt;script&nbsp;type=</font><font color="#2a00ff">&#34;text/javascript&#34;&nbsp;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">src=</font><font color="#2a00ff">&#34;&lt;html:rewrite&nbsp;page=&#34;</font><font color="#000000">/scripts/validator.jsp</font><font color="#2a00ff">&#34;/&gt;&#34;</font><font color="#000000">&gt;&lt;/script&gt;</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<h3 id='section-ValidationAndListSpring-AddTestGetPeopleMethodsToDAOAndManagerTests3'>Add testGetPeople methods to DAO and Manager Tests <a class="footnote" name="ref-ValidationAndListSpring-3">[#3]</a></h3>
To create a List screen (also called a master screen), we need to create methods that will return all the rows from our <i>person</i> table.  Let's start by adding tests for these methods to our PersonDaoTest and PersonManagerTest classes.  I usually name this method <i>getEntities</i> (i.e. getUsers), but you could also use <i>getAll</i> or <i>search</i> - it's really just a matter of personal preference.
<p>Open test/dao/**/dao/PersonDaoTest.java and add a <i>testGetPeople</i> method:
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">testGetPeople</font><font color="#000000">()&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">person&nbsp;=&nbsp;</font><font color="#7f0055"><b>new&nbsp;</b></font><font color="#000000">Person</font><font color="#000000">()</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">List&nbsp;results&nbsp;=&nbsp;dao.getPeople</font><font color="#000000">(</font><font color="#000000">person</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">assertTrue</font><font color="#000000">(</font><font color="#000000">results.size</font><font color="#000000">()&nbsp;</font><font color="#000000">&gt;&nbsp;</font><font color="#990000">0</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>The reason I'm passing in a person object to the <i>getPeople</i> method is to allow for filtering (based on values in person) in the future. Adding this parameter in your getPeople() method signature is optional, but the rest of this tutorial assumes you have done this.
</p>
<p>Now open test/service/**/service/PersonManagerTest.java and add a <i>testGetPeople</i> method:
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">testGetPeople</font><font color="#000000">()&nbsp;</font><font color="#7f0055"><b>throws&nbsp;</b></font><font color="#000000">Exception&nbsp;</font><font color="#000000">{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">List&nbsp;results&nbsp;=&nbsp;</font><font color="#7f0055"><b>new&nbsp;</b></font><font color="#000000">ArrayList</font><font color="#000000">()</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">person&nbsp;=&nbsp;</font><font color="#7f0055"><b>new&nbsp;</b></font><font color="#000000">Person</font><font color="#000000">()</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">results.add</font><font color="#000000">(</font><font color="#000000">person</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f7f5f">//&nbsp;set&nbsp;expected&nbsp;behavior&nbsp;on&nbsp;dao</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">personDao.expects</font><font color="#000000">(</font><font color="#000000">once</font><font color="#000000">())</font><font color="#000000">.method</font><font color="#000000">(</font><font color="#2a00ff">&#34;getPeople&#34;</font><font color="#000000">)</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">.will</font><font color="#000000">(</font><font color="#000000">returnValue</font><font color="#000000">(</font><font color="#000000">results</font><font color="#000000">))</font><font color="#000000">;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">List&nbsp;people&nbsp;=&nbsp;personManager.getPeople</font><font color="#000000">(</font><font color="#7f0055"><b>null</b></font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">assertTrue</font><font color="#000000">(</font><font color="#000000">people.size</font><font color="#000000">()&nbsp;</font><font color="#000000">==&nbsp;</font><font color="#990000">1</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">personDao.verify</font><font color="#000000">()</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>In order for these tests to compile, you need to add the <i>getPeople()</i> method to the PersonDao and PersonManager interfaces, and their implementations.
</p>
<h3 id='section-ValidationAndListSpring-AddGetPeopleMethodToDAOAndManager4'>Add getPeople() method to DAO and Manager <a class="footnote" name="ref-ValidationAndListSpring-4">[#4]</a></h3>
Open src/dao/**/dao/PersonDao.java and add the getPeople() method signature:
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#000000">List&nbsp;getPeople</font><font color="#000000">(</font><font color="#000000">Person&nbsp;person</font><font color="#000000">)</font><font color="#000000">;</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>Now add the same method signature to src/service/**/service/<b>PersonManager.java</b>.  Save all your files and adjust the imports in your tests.  Next you need to implement the getPeople() method in your implementation classes.  Open src/dao/**/dao/hibernate/PersonDaoHibernate.java and add the following method:
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#000000">List&nbsp;getPeople</font><font color="#000000">(</font><font color="#000000">Person&nbsp;person</font><font color="#000000">)&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>return&nbsp;</b></font><font color="#000000">getHibernateTemplate</font><font color="#000000">()</font><font color="#000000">.find</font><font color="#000000">(</font><font color="#2a00ff">&#34;from&nbsp;Person&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p><div class="note" style="margin-left: 30px">
You'll notice here that nothing is being done with the <i>person</i> parameter.  This is just a placeholder for now - in the future you may want to filter on it's properties using <a class="external" href="http://www.hibernate.org/hib_docs/reference/en/html/queryhql.html">Hibernate's Query Language</a><img class="outlink" src="images/out.png" alt="" /> (HQL) or using <a class="external" href="http://www.hibernate.org/hib_docs/reference/en/html/querycriteria.html">Criteria Queries</a><img class="outlink" src="images/out.png" alt="" />.
</p>
<p><i>An example using a Criteria Query:</i>
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">Example&nbsp;example&nbsp;=&nbsp;Example.create</font><font color="#000000">(</font><font color="#000000">person</font><font color="#000000">)</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">.excludeZeroes</font><font color="#000000">()&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f7f5f">//&nbsp;exclude&nbsp;zero&nbsp;valued&nbsp;properties</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">.ignoreCase</font><font color="#000000">()</font><font color="#000000">;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f7f5f">//&nbsp;perform&nbsp;case&nbsp;insensitive&nbsp;string&nbsp;comparisons</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>try&nbsp;</b></font><font color="#000000">{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>return&nbsp;</b></font><font color="#000000">getSession</font><font color="#000000">()</font><font color="#000000">.createCriteria</font><font color="#000000">(</font><font color="#000000">Person.</font><font color="#7f0055"><b>class</b></font><font color="#000000">)</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">.add</font><font color="#000000">(</font><font color="#000000">example</font><font color="#000000">)</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">.list</font><font color="#000000">()</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}&nbsp;</font><font color="#7f0055"><b>catch&nbsp;</b></font><font color="#000000">(</font><font color="#000000">Exception&nbsp;e</font><font color="#000000">)&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>throw&nbsp;new&nbsp;</b></font><font color="#000000">DataAccessException</font><font color="#000000">(</font><font color="#000000">e.getMessage</font><font color="#000000">())</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>return&nbsp;new&nbsp;</b></font><font color="#000000">ArrayList</font><font color="#000000">()</font><font color="#000000">;</font><br/>
<font color="#ffffff"></font><font color="#ffffff">
</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</div>
</p>
<p>Now implement the <i>getPeople()</i> method in src/service/**/impl/PersonManagerImpl.java:
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#000000">List&nbsp;getPeople</font><font color="#000000">(</font><font color="#000000">Person&nbsp;person</font><font color="#000000">)&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>return&nbsp;</b></font><font color="#000000">dao.getPeople</font><font color="#000000">(</font><font color="#000000">person</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>After saving all your changes, you should be able to run both tests by executing the following: 
</p>
<ul>
<li> <b>ant test-dao -Dtestcase=PersonDao</b> 
</li>
<li> <b>ant test-service -Dtestcase=PersonManager</b>
</li>
</ul>
<p>If everything works - <i>nice job!</i> Now you need to add this <i>retrieve all</i> functionality to the web tier.
</p>
<h3 id='section-ValidationAndListSpring-CreatePersonControllerTest5'>Create PersonControllerTest <a class="footnote" name="ref-ValidationAndListSpring-5">[#5]</a></h3>
In the last couple of tutorials, we've been working with the PersonFormController to interact with our HTML form.  Now we need to create a new Controller that'll simply handle getting and displaying a list of people in the database.  
<dl>
<dt></dt><dd><i>You could also use a <a class="external" href="http://www.springframework.org/docs/api/org/springframework/web/servlet/mvc/multiaction/MultiActionController.html">MultiActionController</a><img class="outlink" src="images/out.png" alt="" /> to handle all your List screens.</i></dd>
</dl>
<p>To begin, create test/web/**/action/PersonControllerTest.java (extends BaseControllerTestCase) and add the following method:
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#7f0055"><b>package&nbsp;</b></font><font color="#000000">org.appfuse.webapp.action;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">java.util.Map;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">javax.servlet.http.HttpServletRequest;</font><br/>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">javax.servlet.http.HttpServletResponse;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">org.appfuse.Constants;</font><br/>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">org.springframework.web.servlet.ModelAndView;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#7f0055"><b>public&nbsp;class&nbsp;</b></font><font color="#000000">PersonControllerTest&nbsp;</font><font color="#7f0055"><b>extends&nbsp;</b></font><font color="#000000">BaseControllerTestCase&nbsp;</font><font color="#000000">{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">testHandleRequest</font><font color="#000000">()&nbsp;</font><font color="#7f0055"><b>throws&nbsp;</b></font><font color="#000000">Exception&nbsp;</font><font color="#000000">{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">PersonController&nbsp;c&nbsp;=&nbsp;</font><font color="#000000">(</font><font color="#000000">PersonController</font><font color="#000000">)&nbsp;</font><font color="#000000">ctx.getBean</font><font color="#000000">(</font><font color="#2a00ff">&#34;personController&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">ModelAndView&nbsp;mav&nbsp;=&nbsp;c.handleRequest</font><font color="#000000">((</font><font color="#000000">HttpServletRequest</font><font color="#000000">)&nbsp;</font><font color="#000000">null,</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">(</font><font color="#000000">HttpServletResponse</font><font color="#000000">)&nbsp;</font><font color="#7f0055"><b>null</b></font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">Map&nbsp;m&nbsp;=&nbsp;mav.getModel</font><font color="#000000">()</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">assertNotNull</font><font color="#000000">(</font><font color="#000000">m.get</font><font color="#000000">(</font><font color="#000000">Constants.PERSON_LIST</font><font color="#000000">))</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">assertEquals</font><font color="#000000">(</font><font color="#000000">mav.getViewName</font><font color="#000000">()</font><font color="#000000">,&nbsp;</font><font color="#2a00ff">&#34;personList&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#000000">}</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>This class will not compile until you (1) create the PersonController class and (2) add the PERSON_LIST variable to the src/dao/**/Constants.java file.  Some folks have suggested that this class be named <i>PersonControllerList</i> - the name choice is up to you.  I prefer Controller and FormController because it tells me one implements <a class="external" href="http://www.springframework.org/docs/api/org/springframework/web/servlet/mvc/Controller.html">Controller</a><img class="outlink" src="images/out.png" alt="" /> while the latter extends <a class="external" href="http://www.springframework.org/docs/api/org/springframework/web/servlet/mvc/SimpleFormController.html">SimpleFormController</a><img class="outlink" src="images/out.png" alt="" />.
</p>
<dl>
<dt></dt><dd><span style="color: blue"><i>I usually copy a similar variable that already exists in this file - i.e. USER_LIST.</i></dd>
</dl>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">/**</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*&nbsp;The&nbsp;request&nbsp;scope&nbsp;attribute&nbsp;that&nbsp;holds&nbsp;the&nbsp;person&nbsp;list</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*/</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;static&nbsp;final&nbsp;</b></font><font color="#000000">String&nbsp;PERSON_LIST&nbsp;=&nbsp;</font><font color="#2a00ff">&#34;personList&#34;</font><font color="#000000">;</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>Now save all your changes. You won't be able to run <b>ant test-web -Dtestcase=PersonController</b> yet since <i>PersonController</i> does not exist (yet). Let's add it.
</p>
<h3 id='section-ValidationAndListSpring-CreatePersonController6'>Create PersonController <a class="footnote" name="ref-ValidationAndListSpring-6">[#6]</a></h3>
Create src/web/**/action/PersonController.java.  It should implement <tt>org.springframework.web.servlet.mvc.Controller</tt> and read as follows: 
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#7f0055"><b>package&nbsp;</b></font><font color="#000000">org.appfuse.webapp.action;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">javax.servlet.http.HttpServletRequest;</font><br/>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">javax.servlet.http.HttpServletResponse;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">org.apache.commons.logging.Log;</font><br/>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">org.apache.commons.logging.LogFactory;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">org.appfuse.Constants;</font><br/>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">org.appfuse.model.Person;</font><br/>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">org.appfuse.service.PersonManager;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">org.springframework.web.servlet.ModelAndView;</font><br/>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">org.springframework.web.servlet.mvc.Controller;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#7f0055"><b>public&nbsp;class&nbsp;</b></font><font color="#000000">PersonController&nbsp;</font><font color="#7f0055"><b>implements&nbsp;</b></font><font color="#000000">Controller&nbsp;</font><font color="#000000">{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>private&nbsp;final&nbsp;</b></font><font color="#000000">Log&nbsp;log&nbsp;=&nbsp;LogFactory.getLog</font><font color="#000000">(</font><font color="#000000">PersonController.</font><font color="#7f0055"><b>class</b></font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>private&nbsp;</b></font><font color="#000000">PersonManager&nbsp;mgr&nbsp;=&nbsp;</font><font color="#7f0055"><b>null</b></font><font color="#000000">;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">setPersonManager</font><font color="#000000">(</font><font color="#000000">PersonManager&nbsp;personManager</font><font color="#000000">)&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>this</b></font><font color="#000000">.mgr&nbsp;=&nbsp;personManager;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#000000">ModelAndView&nbsp;handleRequest</font><font color="#000000">(</font><font color="#000000">HttpServletRequest&nbsp;request,</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">HttpServletResponse&nbsp;response</font><font color="#000000">)</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>throws&nbsp;</b></font><font color="#000000">Exception&nbsp;</font><font color="#000000">{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>if&nbsp;</b></font><font color="#000000">(</font><font color="#000000">log.isDebugEnabled</font><font color="#000000">())&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">log.debug</font><font color="#000000">(</font><font color="#2a00ff">&#34;entering&nbsp;'handleRequest'&nbsp;method...&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>return&nbsp;new&nbsp;</b></font><font color="#000000">ModelAndView</font><font color="#000000">(</font><font color="#2a00ff">&#34;personList&#34;</font><font color="#000000">,&nbsp;Constants.PERSON_LIST,</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">mgr.getPeople</font><font color="#000000">(</font><font color="#7f0055"><b>new&nbsp;</b></font><font color="#000000">Person</font><font color="#000000">()))</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#000000">}</font><br/>
<font color="#ffffff"></font><font color="#ffffff">
</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>Now add a definition to web/WEB-INF/action-servlet.xml for this Controller. 
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;bean&nbsp;id=</font><font color="#2a00ff">&#34;personController&#34;&nbsp;</font><font color="#7f0055"><b>class</b></font><font color="#000000">=</font><font color="#2a00ff">&#34;org.appfuse.webapp.action.PersonController&#34;</font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;property&nbsp;name=</font><font color="#2a00ff">&#34;personManager&#34;</font><font color="#000000">&gt;&lt;ref&nbsp;bean=</font><font color="#2a00ff">&#34;personManager&#34;</font><font color="#000000">/&gt;&lt;/property&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/bean&gt;</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>Now if you run <b>ant test-web -Dtestcase=PersonController</b>, the test should pass.  Next, create a URL mapping for this controller.  To do this, search for the "urlMapping" bean in web/WEB-INF/action-servlet.xml and add the following line to the "mappings" property:
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;prop&nbsp;key=</font><font color="#2a00ff">&#34;/people.html&#34;</font><font color="#000000">&gt;personController&lt;/prop&gt;</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<h3 id='section-ValidationAndListSpring-CreatePersonList.jspAndCanooTest7'>Create personList.jsp and Canoo test <a class="footnote" name="ref-ValidationAndListSpring-7">[#7]</a></h3>
Open the personList.jsp file in the <i>web/pages</i> folder of your project. One thing you'll probably want to change is the plural form of the items you're listing.  The generated name in this example is "persons" and it should probably be people.  At or near line 31, you should have the following line:
<pre>&lt;display:setProperty name="paging.banner.items_name" value="persons"/&gt;</pre>

<p>Change it to:
</p>
<pre>&lt;display:setProperty name="paging.banner.items_name" value="people"/&gt;</pre>

<p>Finally, add the title and heading keys (personList.title and personList.heading) to web/WEB-INF/classes/ApplicationResources.properties.  Open this file and add the following:
</p>
<pre>
# -- person list page --
personList.title=Person List
personList.heading=All People
</pre>

<p>As a reminder, the <tt>personList.title</tt> is what ends up in the brower's title bar (the &lt;title&gt; tag) and 
<tt>personList.heading</tt> will be put into an &lth1&gt; tag before any page content.  At this point, you could be able to run "ant deploy", start Tomcat and <a class="external" href="http://localhost:8080/appfuse/people.html">open the list screen in your browser</a><img class="outlink" src="images/out.png" alt="" />.  
</p>
<p>Now that we have a List Screen, let's change the pages that are displayed after adding and deleting a new Person.  In web/WEB-INF/action-servlet.xml, change the personFormController's successView property to be "people.html". 
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;property&nbsp;name=</font><font color="#2a00ff">&#34;successView&#34;</font><font color="#000000">&gt;&lt;value&gt;people.html&lt;/value&gt;&lt;/property&gt;</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>You will also need to update the Canoo tests "AddPerson" and "DeletePerson".  Open test/web/web-tests.xml and change the following line in the "AddPerson" target:
</p>
<pre>&lt;verifytitle description="Main Menu appears if save successful" 
    text=".*${mainMenu.title}.*" regex="true"/&gt;</pre>

<p>to: 
</p>
<pre>&lt;verifytitle description="Person List appears if save successful" 
    text=".*${personList.title}.*" regex="true"/&gt;</pre>

<p>Then in the "DeletePerson" target, change the following line:
</p>
<pre>&lt;verifytitle description="display Main Menu" text=".*$(mainMenu.title}.*" regex="true"/&gt;
</pre>

<p>to:
</p>
<pre>&lt;verifytitle description="display Person List" text=".*${personList.title}.*" regex="true"/&gt;</pre>
 
<p>To test that displaying this page works, you can create a new JSP test in test/web/web-tests.xml:
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;!--&nbsp;Verify&nbsp;the&nbsp;people&nbsp;list&nbsp;screen&nbsp;displays&nbsp;without&nbsp;errors&nbsp;--&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;target&nbsp;name=</font><font color="#2a00ff">&#34;SearchPeople&#34;&nbsp;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">description=</font><font color="#2a00ff">&#34;Tests&nbsp;search&nbsp;for&nbsp;and&nbsp;displaying&nbsp;all&nbsp;people&#34;</font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;webtest&nbsp;name=</font><font color="#2a00ff">&#34;searchPeople&#34;</font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&amp;config;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;steps&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&amp;login;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;invoke&nbsp;description=</font><font color="#2a00ff">&#34;click&nbsp;View&nbsp;People&nbsp;link&#34;&nbsp;</font><font color="#000000">url=</font><font color="#2a00ff">&#34;/people.html&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;verifytitle&nbsp;description=</font><font color="#2a00ff">&#34;we&nbsp;should&nbsp;see&nbsp;the&nbsp;personList&nbsp;title&#34;&nbsp;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">text=</font><font color="#2a00ff">&#34;.*${personList.title}.*&#34;&nbsp;</font><font color="#000000">regex=</font><font color="#2a00ff">&#34;true&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/steps&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/webtest&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/target&gt;</font><br/>
<font color="#ffffff"></font><font color="#ffffff">
</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>You'll also want to add the "SearchPeople" target to the "PersonTests" target so it will be executed along with all the other person-related tests.
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;!--&nbsp;runs&nbsp;person-related&nbsp;tests&nbsp;--&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;target&nbsp;name=</font><font color="#2a00ff">&#34;PersonTests&#34;&nbsp;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">depends=</font><font color="#2a00ff">&#34;SearchPeople,EditPerson,SavePerson,AddPerson,DeletePerson&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">description=</font><font color="#2a00ff">&#34;Call&nbsp;and&nbsp;executes&nbsp;all&nbsp;person&nbsp;test&nbsp;cases&nbsp;(targets)&#34;</font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;echo&gt;Successfully&nbsp;ran&nbsp;all&nbsp;Person&nbsp;JSP&nbsp;tests!&lt;/echo&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/target&gt;</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>Now you can run <b>ant deploy test-canoo -Dtestcase=SearchPeople</b> (or <i>ant test-jsp</i> if Tomcat isn't running) and hopefully it will result in "BUILD SUCCESSFUL".  If so - <i>nice work!</i>
</p>
<h3 id='section-ValidationAndListSpring-AddLinkToMenu8'>Add link to menu <a class="footnote" name="ref-ValidationAndListSpring-8">[#8]</a></h3>
The last step is to make the list, add, edit and delete functions visible to the user.  The simplest way is to add a new link to the list of links in web/pages/mainMenu.jsp:
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;li&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;a&nbsp;href=</font><font color="#2a00ff">&#34;&lt;c:url&nbsp;value=&#34;</font><font color="#000000">/people.html</font><font color="#2a00ff">&#34;/&gt;&#34;</font><font color="#000000">&gt;&lt;fmt:message&nbsp;key=</font><font color="#2a00ff">&#34;menu.viewPeople&#34;</font><font color="#000000">/&gt;&lt;/a&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/li&gt;</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>Where <i>menu.viewPeople</i> is an entry in web/WEB-INF/classes/ApplicationResources.properties.
</p>
<pre>
menu.viewPeople=View People
</pre>

<p>The other (more likely) alternative is that you'll want to add it to the menu.  To do this, add the following to web/WEB-INF/menu-config.xml:
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#000000">&lt;Menu&nbsp;name=</font><font color="#2a00ff">&#34;PeopleMenu&#34;&nbsp;</font><font color="#000000">title=</font><font color="#2a00ff">&#34;menu.viewPeople&#34;&nbsp;</font><font color="#000000">page=</font><font color="#2a00ff">&#34;/people.html&#34;</font><font color="#000000">/&gt;</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>Make sure the above XML is inside the &lt;Menus&gt; tag, but not within another &lt;Menu&gt;.  Then add this new menu to web/pages/menu.jsp - which should now looks as follows:
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#000000">&lt;%@&nbsp;include&nbsp;file=</font><font color="#2a00ff">&#34;/common/taglibs.jsp&#34;</font><font color="#000000">%&gt;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#000000">&lt;div&nbsp;id=</font><font color="#2a00ff">&#34;menu&#34;</font><font color="#000000">&gt;</font><br/>
<font color="#000000">&lt;menu:useMenuDisplayer&nbsp;name=</font><font color="#2a00ff">&#34;ListMenu&#34;&nbsp;</font><font color="#000000">permissions=</font><font color="#2a00ff">&#34;rolesAdapter&#34;</font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;menu:displayMenu&nbsp;name=</font><font color="#2a00ff">&#34;AdminMenu&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;menu:displayMenu&nbsp;name=</font><font color="#2a00ff">&#34;UserMenu&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;menu:displayMenu&nbsp;name=</font><font color="#2a00ff">&#34;PeopleMenu&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;menu:displayMenu&nbsp;name=</font><font color="#2a00ff">&#34;FileUpload&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;menu:displayMenu&nbsp;name=</font><font color="#2a00ff">&#34;FlushCache&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;menu:displayMenu&nbsp;name=</font><font color="#2a00ff">&#34;Clickstream&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#000000">&lt;/menu:useMenuDisplayer&gt;</font><br/>
<font color="#000000">&lt;/div&gt;</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>Now if you run <b>ant clean deploy</b>, start Tomcat and go to <a class="external" href="http://localhost:8080/appfuse/mainMenu.html">http://localhost:8080/appfuse/mainMenu.html</a><img class="outlink" src="images/out.png" alt="" />, you should see something like the screenshot below.
</p>
<div style="border: 1px solid black; margin: 0px auto; width: 551px; height: 184px">
<img class="inline" src="attach/ValidationAndList/new-menu-item.png" alt="ValidationAndList/new-menu-item.png" />
</div>
<p>Notice that there is a new link on the left side (from mainMenu.jsp) and on the right in our menu (from menu.jsp).
</p>
<h3 id='section-ValidationAndListSpring-ThatsIt'>That's it!</h3>
You've completed the full lifecycle of developing a set of master-detail pages with AppFuse and Spring's MVC framework - <b>Congratulations</b>!  Now the real test is if you can run all the tests in your app without failure.  To test, stop tomcat and run <b>ant clean test-all</b>.  This will run all the unit tests within your project.  As a reminder, it should be easy to setup and test AppFuse from scratch using <b>ant setup-db setup-tomcat test-all</b>.  Also, if you're looking for more robust examples - checkout <a class="wikipage" href="Wiki.jsp?page=StrutsResume">Struts Resume</a>.
<p><i><b>Happy Day!</b></i>
</p>
<div style="color: green">
BUILD SUCCESSFUL<br />
Total time: 4 minutes 21 seconds
</div>
<A NAME="Link_ValidationAndListTapestry">
<h1>ValidationAndListTapestry</h1>
</A>
<b>Part IV:</b> <a class="wikipage" href="Wiki.jsp?page=ValidationAndListTapestry">Adding Validation and List Screen</a> - Explains validation logic that makes the firstName and lastName required fields.  Also shows how to add a list screen to display all person records in the database.
<dl>
<dt></dt><dd><i>This tutorial depends on <b>Part III:</b> <a class="wikipage" href="Wiki.jsp?page=TapestryPages">Creating Tapestry Pages and HTML Templates</a>.</i></dd>
</dl>
<h3 id='section-ValidationAndListTapestry-AboutThisTutorial'>About this Tutorial</h3>
This tutorial will show you how to add Validation logic to the Person object using Tapestry's Validation framework. You'll also create a list screen using the <a class="external" href="http://jakarta.apache.org/tapestry/doc/ComponentReference/contrib.Table.html">contrib:Table component</a><img class="outlink" src="images/out.png" alt="" /> to display all the people in the database.
<dl>
<dt></dt><dd><span style="color: blue"><i>I will tell you how I do stuff in the <b>Real World</b> in text like this.</i></span></dd>
</dl>
<h4 id='section-ValidationAndListTapestry-TableOfContents'>Table of Contents</h4>
<ul>
<li> <a class="footnoteref" href="#ref-ValidationAndListTapestry-1">[1]</a> View validation logic in personForm.page
</li>
<li> <a class="footnoteref" href="#ref-ValidationAndListTapestry-2">[2]</a> View HTML with validation added and test
</li>
<li> <a class="footnoteref" href="#ref-ValidationAndListTapestry-3">[3]</a> Add <i>testGetPeople</i> methods to DAO and Manager Tests
</li>
<li> <a class="footnoteref" href="#ref-ValidationAndListTapestry-4">[4]</a> Add <i>getPeople</i> methods to PersonDao and Manager
</li>
<li> <a class="footnoteref" href="#ref-ValidationAndListTapestry-5">[5]</a> Create PersonListTest
</li>
<li> <a class="footnoteref" href="#ref-ValidationAndListTapestry-6">[6]</a> Create PersonForm  
</li>
<li> <a class="footnoteref" href="#ref-ValidationAndListTapestry-7">[7]</a> Create personList.html and Canoo test
</li>
<li> <a class="footnoteref" href="#ref-ValidationAndListTapestry-8">[8]</a> Add link to menu
</li>
</ul>
<h3 id='section-ValidationAndListTapestry-ViewValidationLogicInPersonForm.page1'>View validation logic in personForm.page <a class="footnote" name="ref-ValidationAndListTapestry-1">[#1]</a></h3>
Implementing validation with Tapestry is quite simple.  All you need to do is configure a "validators" property on your <a class="external" href="http://jakarta.apache.org/tapestry/doc/ComponentReference/TextField.html">TextField</a><img class="outlink" src="images/out.png" alt="" /> components. The validation integration for the personForm.html page is already done by AppGen in the personForm.page.  If you open web/pages/personForm.page, you should see the following XML. 
<pre>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE page-specification PUBLIC 
    "-//Apache Software Foundation//Tapestry Specification 4.0//EN" 
    "http://jakarta.apache.org/tapestry/dtd/Tapestry_4_0.dtd"&gt;

&lt;page-specification class="org.appfuse.webapp.action.PersonForm"&gt;
    &lt;inject property="engineService" object="engine-service:page"/&gt;
    &lt;inject property="request" object="service:tapestry.globals.HttpServletRequest"/&gt;
    &lt;inject property="response" object="service:tapestry.globals.HttpServletResponse"/&gt;
    &lt;inject property="personManager" type="spring" object="personManager"/&gt;

    &lt;bean name="delegate" class="org.appfuse.webapp.action.Validator"/&gt;
    &lt;property name="message" persist="flash"/&gt;

    &lt;component id="personForm" type="Form"&gt;
        &lt;binding name="delegate" value="ognl:beans.delegate"/&gt;
        &lt;binding name="clientValidationEnabled" value="true"/&gt;
    &lt;/component&gt;

    &lt;component id="firstNameField" type="TextField"&gt;
        &lt;binding name="value" value="person.firstName"/&gt;
        &lt;binding name="validators" value="validators:required"/&gt;
        &lt;binding name="displayName" value="message:person.firstName"/&gt;
    &lt;/component&gt;
    &lt;component id="lastNameField" type="TextField"&gt;
        &lt;binding name="value" value="person.lastName"/&gt;
        &lt;binding name="validators" value="validators:required"/&gt;
        &lt;binding name="displayName" value="message:person.lastName"/&gt;
    &lt;/component&gt;

&lt;/page-specification&gt;</pre>

<p>The validation delegate (indicated with &lt;bean name="delegate"&gt;) is an extended version of Tapestry's ValidationDelegate.  This one marks fields required with an asterisk based on your .page file. It also highlights the field with appropriate messages when validation fails (if JavaScript doesn't catch it first).
</p>
<p>There are a <a class="external" href="http://jakarta.apache.org/tapestry/UsersGuide/validation.html">number of different validators</a><img class="outlink" src="images/out.png" alt="" /> you can use, this example just shows a way to validate Strings are entered.  The userForm.page has examples of an EmailValidator and a PatternValidator. All input fields generated by AppGen are required by default.  You can change this by modifying the extras/appgen/src/**/*_page.xdt files.
</p>
<p>It's important to note that Tapestry does <b>not</b> automatically validate and return you to the form (when errors occur).  You have to manually check for errors in your listener method:
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>if&nbsp;</b></font><font color="#000000">(</font><font color="#000000">getDelegate</font><font color="#000000">()</font><font color="#000000">.getHasErrors</font><font color="#000000">())&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>return</b></font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<h3 id='section-ValidationAndListTapestry-ViewHTMLWithValidationAddedAndTest2'>View HTML with validation added and test <a class="footnote" name="ref-ValidationAndListTapestry-2">[#2]</a></h3>
Since validation is configured in the page-specification file (a.k.a. personForm.page), whenever a field specifies a "validators" property.  For those fields that don't have validation, make sure and use the @Label component for its label.  Below is a non-validated field example from web/pages/userForm.html.
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;tr&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;th&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;label&nbsp;jwcid=</font><font color="#2a00ff">&#34;@Label&#34;&nbsp;</font><font color="#7f0055"><b>for</b></font><font color="#000000">=</font><font color="#2a00ff">&#34;phoneNumber&#34;&nbsp;</font><font color="#000000">key=</font><font color="#2a00ff">&#34;user.phoneNumber&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/th&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;td&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;input&nbsp;jwcid=</font><font color="#2a00ff">&#34;phoneNumberField&#34;&nbsp;</font><font color="#000000">type=</font><font color="#2a00ff">&#34;text&#34;&nbsp;</font><font color="#000000">id=</font><font color="#2a00ff">&#34;phoneNumber&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/td&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/tr&gt;</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>To test the current validation configuration for the person form, run <b>ant db-load deploy</b>, and start Tomcat.  Then go to <a class="external" href="http://localhost:8080/appfuse">http://localhost:8080/appfuse</a><img class="outlink" src="images/out.png" alt="" />, login and click on the "Edit Person" link on the Main Menu.
</p>
<p>If you erase the values in the firstName and lastName fields and click the save button, you should get the following JavaScript alert.
</p>
<div style="margin: 0 auto; height: 128px; width: 318px">
<img class="inline" src="attach/ValidationAndListTapestry/validation-required.png" alt="validation-required.png" />
</div>
<p>You can see that Tapestry will only display the first validation error, rather than all of them.  If you'd like to change this, I'd search the mailing list archives because I'm not aware of it being an option.
</p>
<p>To make sure things are <i>really</i> working as expected, you can turn off JavaScript and ensure the server-side validation is working.  This is easy in <a class="external" href="http://www.mozilla.org/products/firefox/">Mozilla Firefox</a><img class="outlink" src="images/out.png" alt="" /> (my favorite browser), just go to Tools &rarr; Options &rarr; Web Features and uncheck "Enable JavaScript".  Now if you clear the fields and save the form, you should see the following:
</p>
<div style="border: 1px solid black; margin: 0 auto; height: 215px; width: 571px">
<img class="inline" src="attach/ValidationAndListTapestry/validation-required-nojs.png" alt="validation-required-nojs.png" />
</div>
<h3 id='section-ValidationAndListTapestry-AddTestGetPeopleMethodsToDAOAndManagerTests3'>Add testGetPeople methods to DAO and Manager Tests <a class="footnote" name="ref-ValidationAndListTapestry-3">[#3]</a></h3>
To create a List screen (also called a master screen), we need to create methods that will return all the rows from our <i>person</i> table.  Let's start by adding tests for these methods to our PersonDaoTest and PersonManagerTest classes.  I usually name this method <i>getEntities</i> (i.e. getUsers), but you could also use <i>getAll</i> or <i>search</i> - it's really just a matter of personal preference.
<p>Open test/dao/**/dao/PersonDaoTest.java and add a <i>testGetPeople</i> method:
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">testGetPeople</font><font color="#000000">()&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">person&nbsp;=&nbsp;</font><font color="#7f0055"><b>new&nbsp;</b></font><font color="#000000">Person</font><font color="#000000">()</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">List&nbsp;results&nbsp;=&nbsp;dao.getPeople</font><font color="#000000">(</font><font color="#000000">person</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">assertTrue</font><font color="#000000">(</font><font color="#000000">results.size</font><font color="#000000">()&nbsp;</font><font color="#000000">&gt;&nbsp;</font><font color="#990000">0</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>The reason I'm passing in a person object to the <i>getPeople</i> method is to allow for filtering (based on values in person) in the future. Adding this parameter in your getPeople() method signature is optional, but the rest of this tutorial assumes you have done this.
</p>
<p>Now open test/service/**/service/PersonManagerTest.java and add a <i>testGetPeople</i> method:
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">testGetPeople</font><font color="#000000">()&nbsp;</font><font color="#7f0055"><b>throws&nbsp;</b></font><font color="#000000">Exception&nbsp;</font><font color="#000000">{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">List&nbsp;results&nbsp;=&nbsp;</font><font color="#7f0055"><b>new&nbsp;</b></font><font color="#000000">ArrayList</font><font color="#000000">()</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">person&nbsp;=&nbsp;</font><font color="#7f0055"><b>new&nbsp;</b></font><font color="#000000">Person</font><font color="#000000">()</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">results.add</font><font color="#000000">(</font><font color="#000000">person</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f7f5f">//&nbsp;set&nbsp;expected&nbsp;behavior&nbsp;on&nbsp;dao</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">personDao.expects</font><font color="#000000">(</font><font color="#000000">once</font><font color="#000000">())</font><font color="#000000">.method</font><font color="#000000">(</font><font color="#2a00ff">&#34;getPeople&#34;</font><font color="#000000">)</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">.will</font><font color="#000000">(</font><font color="#000000">returnValue</font><font color="#000000">(</font><font color="#000000">results</font><font color="#000000">))</font><font color="#000000">;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">List&nbsp;people&nbsp;=&nbsp;personManager.getPeople</font><font color="#000000">(</font><font color="#7f0055"><b>null</b></font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">assertTrue</font><font color="#000000">(</font><font color="#000000">people.size</font><font color="#000000">()&nbsp;</font><font color="#000000">==&nbsp;</font><font color="#990000">1</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">personDao.verify</font><font color="#000000">()</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>In order for these tests to compile, you need to add the <i>getPeople()</i> method to the PersonDao and PersonManager interfaces, and their implementations.
</p>
<h3 id='section-ValidationAndListTapestry-AddGetPeopleMethodToDAOAndManager4'>Add getPeople() method to DAO and Manager <a class="footnote" name="ref-ValidationAndListTapestry-4">[#4]</a></h3>
Open src/dao/**/dao/PersonDao.java and add the getPeople() method signature:
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#000000">List&nbsp;getPeople</font><font color="#000000">(</font><font color="#000000">Person&nbsp;person</font><font color="#000000">)</font><font color="#000000">;</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>Now add the same method signature to src/service/**/service/<b>PersonManager.java</b>.  Save all your files and adjust the imports in your tests.  Next you need to implement the getPeople() method in your implementation classes.  Open src/dao/**/dao/hibernate/PersonDaoHibernate.java and add the following method:
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#000000">List&nbsp;getPeople</font><font color="#000000">(</font><font color="#000000">Person&nbsp;person</font><font color="#000000">)&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>return&nbsp;</b></font><font color="#000000">getHibernateTemplate</font><font color="#000000">()</font><font color="#000000">.find</font><font color="#000000">(</font><font color="#2a00ff">&#34;from&nbsp;Person&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p><div class="note" style="margin-left: 30px">
You'll notice here that nothing is being done with the <i>person</i> parameter.  This is just a placeholder for now - in the future you may want to filter on it's properties using <a class="external" href="http://www.hibernate.org/hib_docs/reference/en/html/queryhql.html">Hibernate's Query Language</a><img class="outlink" src="images/out.png" alt="" /> (HQL) or using <a class="external" href="http://www.hibernate.org/hib_docs/reference/en/html/querycriteria.html">Criteria Queries</a><img class="outlink" src="images/out.png" alt="" />.
</p>
<p><i>An example using a Criteria Query:</i>
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">Example&nbsp;example&nbsp;=&nbsp;Example.create</font><font color="#000000">(</font><font color="#000000">person</font><font color="#000000">)</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">.excludeZeroes</font><font color="#000000">()&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f7f5f">//&nbsp;exclude&nbsp;zero&nbsp;valued&nbsp;properties</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">.ignoreCase</font><font color="#000000">()</font><font color="#000000">;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f7f5f">//&nbsp;perform&nbsp;case&nbsp;insensitive&nbsp;string&nbsp;comparisons</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>try&nbsp;</b></font><font color="#000000">{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>return&nbsp;</b></font><font color="#000000">getSession</font><font color="#000000">()</font><font color="#000000">.createCriteria</font><font color="#000000">(</font><font color="#000000">Person.</font><font color="#7f0055"><b>class</b></font><font color="#000000">)</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">.add</font><font color="#000000">(</font><font color="#000000">example</font><font color="#000000">)</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">.list</font><font color="#000000">()</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}&nbsp;</font><font color="#7f0055"><b>catch&nbsp;</b></font><font color="#000000">(</font><font color="#000000">Exception&nbsp;e</font><font color="#000000">)&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>throw&nbsp;new&nbsp;</b></font><font color="#000000">DataAccessException</font><font color="#000000">(</font><font color="#000000">e.getMessage</font><font color="#000000">())</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>return&nbsp;new&nbsp;</b></font><font color="#000000">ArrayList</font><font color="#000000">()</font><font color="#000000">;</font><br/>
<font color="#ffffff"></font><font color="#ffffff">
</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</div>
</p>
<p>Now implement the <i>getPeople()</i> method in src/service/**/impl/PersonManagerImpl.java:
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#000000">List&nbsp;getPeople</font><font color="#000000">(</font><font color="#000000">Person&nbsp;person</font><font color="#000000">)&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>return&nbsp;</b></font><font color="#000000">dao.getPeople</font><font color="#000000">(</font><font color="#000000">person</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>After saving all your changes, you should be able to run both tests by executing the following: 
</p>
<ul>
<li> <b>ant test-dao -Dtestcase=PersonDao</b> 
</li>
<li> <b>ant test-service -Dtestcase=PersonManager</b>
</li>
</ul>
<p>If everything works - <i>nice job!</i> Now you need to add this <i>retrieve all</i> functionality to the web tier.
</p>
<h3 id='section-ValidationAndListTapestry-CreatePersonListTest5'>Create PersonListTest <a class="footnote" name="ref-ValidationAndListTapestry-5">[#5]</a></h3>
In the last couple of tutorials, you've been working with the PersonForm to interact with your HTML form.  Now you need to create a new Page class that'll simply handle getting and displaying a list of people in the database.  
<p>To begin, create test/web/**/action/PersonListTest.java and add test methods for editing and searching.  The <tt>edit()</tt> method is a listener method that's invoked when you click to edit a row.  This is pretty much the same as the <tt>edit()</tt> method on PersonForm.  The one on PersonForm was mainly added for demonstration purposes. AppGen will won't generate an "edit" listener on the form class if you use it to generate your page classes.
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#7f0055"><b>package&nbsp;</b></font><font color="#000000">org.appfuse.webapp.action;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">org.apache.tapestry.engine.RequestCycle;</font><br/>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">org.appfuse.service.Manager;</font><br/>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">org.appfuse.model.Person;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">java.util.HashMap;</font><br/>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">java.util.Map;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#7f0055"><b>public&nbsp;class&nbsp;</b></font><font color="#000000">PersonListTest&nbsp;</font><font color="#7f0055"><b>extends&nbsp;</b></font><font color="#000000">BasePageTestCase&nbsp;</font><font color="#000000">{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>private&nbsp;</b></font><font color="#000000">PersonList&nbsp;page;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>protected&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">onSetUp</font><font color="#000000">()&nbsp;</font><font color="#7f0055"><b>throws&nbsp;</b></font><font color="#000000">Exception&nbsp;</font><font color="#000000">{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>super</b></font><font color="#000000">.onSetUp</font><font color="#000000">()</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f7f5f">//&nbsp;these&nbsp;can&nbsp;be&nbsp;mocked&nbsp;if&nbsp;you&nbsp;want&nbsp;a&nbsp;more&nbsp;&#34;pure&#34;&nbsp;unit&nbsp;test</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">Map&nbsp;map&nbsp;=&nbsp;</font><font color="#7f0055"><b>new&nbsp;</b></font><font color="#000000">HashMap</font><font color="#000000">()</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">map.put</font><font color="#000000">(</font><font color="#2a00ff">&#34;personManager&#34;</font><font color="#000000">,&nbsp;</font><font color="#000000">(</font><font color="#000000">Manager</font><font color="#000000">)&nbsp;</font><font color="#000000">applicationContext.getBean</font><font color="#000000">(</font><font color="#2a00ff">&#34;personManager&#34;</font><font color="#000000">))</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">page&nbsp;=&nbsp;</font><font color="#000000">(</font><font color="#000000">PersonList</font><font color="#000000">)&nbsp;</font><font color="#000000">getPage</font><font color="#000000">(</font><font color="#000000">PersonList.class,&nbsp;map</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>protected&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">onTearDownAfterTransaction</font><font color="#000000">()&nbsp;</font><font color="#7f0055"><b>throws&nbsp;</b></font><font color="#000000">Exception&nbsp;</font><font color="#000000">{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>super</b></font><font color="#000000">.onTearDown</font><font color="#000000">()</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">page&nbsp;=&nbsp;</font><font color="#7f0055"><b>null</b></font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">testEdit</font><font color="#000000">()&nbsp;</font><font color="#7f0055"><b>throws&nbsp;</b></font><font color="#000000">Exception&nbsp;</font><font color="#000000">{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">RequestCycle&nbsp;cycle&nbsp;=&nbsp;</font><font color="#7f0055"><b>new&nbsp;</b></font><font color="#000000">MockRequestCycle</font><font color="#000000">()</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">cycle.setServiceParameters</font><font color="#000000">(</font><font color="#7f0055"><b>new&nbsp;</b></font><font color="#000000">Object</font><font color="#000000">[]&nbsp;{</font><font color="#7f0055"><b>new&nbsp;</b></font><font color="#000000">Long</font><font color="#000000">(</font><font color="#2a00ff">&#34;1&#34;</font><font color="#000000">)})</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">page.edit</font><font color="#000000">(</font><font color="#000000">cycle</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">assertFalse</font><font color="#000000">(</font><font color="#000000">page.hasErrors</font><font color="#000000">())</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">testSearch</font><font color="#000000">()&nbsp;</font><font color="#7f0055"><b>throws&nbsp;</b></font><font color="#000000">Exception&nbsp;</font><font color="#000000">{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">assertTrue</font><font color="#000000">(</font><font color="#000000">page.getPersons</font><font color="#000000">()</font><font color="#000000">.size</font><font color="#000000">()&nbsp;</font><font color="#000000">&gt;=&nbsp;</font><font color="#990000">1</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#000000">}</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>This class will not compile until you create the PersonList class. 
</p>
<h3 id='section-ValidationAndListTapestry-CreatePersonList6'>Create PersonList <a class="footnote" name="ref-ValidationAndListTapestry-6">[#6]</a></h3>
Create src/web/**/action/PersonList.java.  It should implement <a class="external" href="http://jakarta.apache.org/tapestry/tapestry/apidocs/org/apache/tapestry/event/PageBeginRenderListener.html">PageBeginRenderListener</a><img class="outlink" src="images/out.png" alt="" /> and read as follows: 
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#7f0055"><b>package&nbsp;</b></font><font color="#000000">org.appfuse.webapp.action;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">java.util.List;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">org.apache.tapestry.IRequestCycle;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">org.appfuse.model.Person;</font><br/>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">org.appfuse.service.PersonManager;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#7f0055"><b>public&nbsp;abstract&nbsp;class&nbsp;</b></font><font color="#000000">PersonList&nbsp;</font><font color="#7f0055"><b>extends&nbsp;</b></font><font color="#000000">BasePage&nbsp;</font><font color="#000000">{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;abstract&nbsp;</b></font><font color="#000000">PersonManager&nbsp;getPersonManager</font><font color="#000000">()</font><font color="#000000">;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#000000">List&nbsp;getPersons</font><font color="#000000">()&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>return&nbsp;</b></font><font color="#000000">getPersonManager</font><font color="#000000">()</font><font color="#000000">.getPeople</font><font color="#000000">()</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">edit</font><font color="#000000">(</font><font color="#000000">IRequestCycle&nbsp;cycle</font><font color="#000000">)&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">Object</font><font color="#000000">[]&nbsp;</font><font color="#000000">parameters&nbsp;=&nbsp;cycle.getListenerParameters</font><font color="#000000">()</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">Long&nbsp;personId&nbsp;=&nbsp;</font><font color="#000000">(</font><font color="#000000">Long</font><font color="#000000">)&nbsp;</font><font color="#000000">parameters</font><font color="#000000">[</font><font color="#990000">0</font><font color="#000000">]</font><font color="#000000">;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>if&nbsp;</b></font><font color="#000000">(</font><font color="#000000">log.isDebugEnabled</font><font color="#000000">())&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">log.debug</font><font color="#000000">(</font><font color="#2a00ff">&#34;fetching&nbsp;person&nbsp;with&nbsp;personId:&nbsp;&#34;&nbsp;</font><font color="#000000">+&nbsp;personId</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">Person&nbsp;person&nbsp;=&nbsp;getPersonManager</font><font color="#000000">()</font><font color="#000000">.getPerson</font><font color="#000000">(</font><font color="#000000">personId</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">PersonForm&nbsp;nextPage&nbsp;=&nbsp;</font><font color="#000000">(</font><font color="#000000">PersonForm</font><font color="#000000">)&nbsp;</font><font color="#000000">cycle.getPage</font><font color="#000000">(</font><font color="#2a00ff">&#34;personForm&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">nextPage.setPerson</font><font color="#000000">(</font><font color="#000000">person</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">cycle.activate</font><font color="#000000">(</font><font color="#000000">nextPage</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#000000">}</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>Now if you run <b>ant test-web -Dtestcase=PersonList</b>, the test should pass.  
</p>
<p><b>Nice!</b>
<span style="color:green">BUILD SUCCESSFUL<br />
Total time: 10 seconds</span>
</p>
<h3 id='section-ValidationAndListTapestry-CreatePersonList.htmlAndCanooTest7'>Create personList.html and Canoo test <a class="footnote" name="ref-ValidationAndListTapestry-7">[#7]</a></h3>
There should already be a personList.html file in <i>web/pages</i>.  If not, you can create it using AppGen. From the command-line, navigate to extras/appgen and run <b>ant -Dobject.name=Person -Dappgen.type=pojo</b>.  This will generate both a personList.html and a personList.page in <b>extras/appgen/build/gen/web/pages</b>.  
<p>Copy personList.html and personList.page to <i>web/pages</i> and rename them <b>people.html</b> and <b>people.page</b>. Open them both for for editing. In personList.html, there should be a &lt;table&gt; with a "source" attribute of "ognl:persons".  Change this to "ognl:people":
</p>
<pre>source="ognl:people"</pre>

<p>This is necessary so OGNL (Tapestry's expression language) will call <tt>getPeople()</tt> on your PersonList class.  There's also a "columns" attribute in this table that needs a bit of tweaking.
</p>
<pre>columns="person.id:id,person.firstName:firstName,person.lastName:lastName,"</pre>

<p>The last comma is unecessary (but doesn't seem to effect anything).  Remove it so you don't ask yourself why it's there later.  
</p>
<p>You should already have the title and heading keys (personList.title and personList.heading) for the personList.html page in web/WEB-INF/classes/ApplicationResources.properties.  You should've added these keys in the previous tutorial. The column names automatically resolve to i18n messages based on their identifier (with the . in them). 
</p>
<p>Now add the page entry to web/WEB-INF/tapestry.application so that Tapestry knows where your pages and their specifications reside.
</p>
<pre>&lt;page name="people" specification-path="pages/people.page"/&gt;</pre>

<p>At this point, you should be able to run <b>ant clean deploy</b>, start Tomcat and view this page in your browser at <a class="external" href="http://localhost:8080/appfuse/people.html">http://localhost:8080/appfuse/people.html</a><img class="outlink" src="images/out.png" alt="" />.
</p>
<p>Now that you have a List Screen, let's change the pages that are displayed after adding and deleting a new Person.  In the src/web/org/**/action/PersonForm.java class, change the references to MainMenu/mainMenu to be PersonList/people. 
</p>
<p>In the last tutorial, the Canoo tests verify that the user sees the Main Menu after saving/editing a person.  Since you've changed that logic, and now you're activating the PersonList, you need to update the tests. Open test/web/web-tests.xml and change any "mainMenu" references in the "PersonsTests" to be go to the people list.
</p>
<pre>&lt;verifyTitle description="display Main Menu" text=".*${mainMenu.title}.*" regex="true"/&gt;</pre>

<p>Should become:
</p>
<pre>{{{&lt;verifyTitle description="Person List appears if save successful" text=".*${personList.title}.*" regex="true"/&gt;</pre>
}}}
<p>You will also need to change the Canoo tests to use the list screen for editing, rather than the Main Menu's "Edit Person" link. Change the &lt;clicklink> in "EditPerson", "SavePerson" and "DeletePerson" from
</p>
<p></p>
<pre>&lt;clicklink label="Edit Person"/&gt;</pre>

<p>to: 
</p>
<pre>&lt;invoke description="View People" url="/people.html"/&gt;
&lt;clicklink description="edit first record in list" label="1"/&gt;
</pre>

<p>To test that displaying this page works, create a new HTML test in test/web/web-tests.xml:
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;!--&nbsp;Verify&nbsp;the&nbsp;people&nbsp;list&nbsp;screen&nbsp;displays&nbsp;without&nbsp;errors&nbsp;--&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;target&nbsp;name=</font><font color="#2a00ff">&#34;SearchPeople&#34;&nbsp;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">description=</font><font color="#2a00ff">&#34;Tests&nbsp;search&nbsp;for&nbsp;and&nbsp;displaying&nbsp;all&nbsp;people&#34;</font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;webtest&nbsp;name=</font><font color="#2a00ff">&#34;searchPeople&#34;</font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&amp;config;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;steps&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&amp;login;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;invoke&nbsp;description=</font><font color="#2a00ff">&#34;click&nbsp;View&nbsp;People&nbsp;link&#34;&nbsp;</font><font color="#000000">url=</font><font color="#2a00ff">&#34;/people.html&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;verifytitle&nbsp;description=</font><font color="#2a00ff">&#34;we&nbsp;should&nbsp;see&nbsp;the&nbsp;personList&nbsp;title&#34;&nbsp;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">text=</font><font color="#2a00ff">&#34;.*${personList.title}.*&#34;&nbsp;</font><font color="#000000">regex=</font><font color="#2a00ff">&#34;true&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/steps&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/webtest&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/target&gt;</font><br/>
<font color="#ffffff"></font><font color="#ffffff">
</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>You'll also want to add the "SearchPeople" target to the "PersonTests" target so it will be executed along with all the other person-related tests.
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;!--&nbsp;runs&nbsp;person-related&nbsp;tests&nbsp;--&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;target&nbsp;name=</font><font color="#2a00ff">&#34;PersonTests&#34;&nbsp;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">depends=</font><font color="#2a00ff">&#34;SearchPeople,EditPerson,SavePerson,AddPerson,DeletePerson&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">description=</font><font color="#2a00ff">&#34;Call&nbsp;and&nbsp;executes&nbsp;all&nbsp;person&nbsp;test&nbsp;cases&nbsp;(targets)&#34;</font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;echo&gt;Successfully&nbsp;ran&nbsp;all&nbsp;Person&nbsp;JSP&nbsp;tests!&lt;/echo&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/target&gt;</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>Now you can run <b>ant test-canoo -Dtestcase=SearchPeople</b> (or <i>ant test-html</i> if Tomcat isn't running) and hopefully it will result in "BUILD SUCCESSFUL".  If so - <i>nice work!</i>
</p>
<h3 id='section-ValidationAndListTapestry-AddLinkToMenu8'>Add link to menu <a class="footnote" name="ref-ValidationAndListTapestry-8">[#8]</a></h3>
The last step is to make the list, add, edit and delete functions visible to the user.  The simplest way is to add a new link to the list of links in web/pages/mainMenu.html:
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;li&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;a&nbsp;href=</font><font color="#2a00ff">&#34;people.html&#34;</font><font color="#000000">&gt;&lt;span&nbsp;key=</font><font color="#2a00ff">&#34;menu.viewPeople&#34;</font><font color="#000000">/&gt;&lt;/a&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/li&gt;</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>Where <i>menu.viewPeople</i> is an entry in web/WEB-INF/classes/ApplicationResources.properties.
</p>
<pre>
menu.viewPeople=View People
</pre>

<p>The other (more likely) alternative is that you'll want to add it to the menu.  To do this, add the following to web/WEB-INF/menu-config.xml:
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#000000">&lt;Menu&nbsp;name=</font><font color="#2a00ff">&#34;PeopleMenu&#34;&nbsp;</font><font color="#000000">title=</font><font color="#2a00ff">&#34;menu.viewPeople&#34;&nbsp;</font><font color="#000000">page=</font><font color="#2a00ff">&#34;/people.html&#34;</font><font color="#000000">/&gt;</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>Make sure the above XML is inside the &lt;Menus&gt; tag, but not within another &lt;Menu&gt;.  Then add this new menu to web/pages/menu.jsp - which should now look as follows:
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#000000">&lt;%@&nbsp;include&nbsp;file=</font><font color="#2a00ff">&#34;/common/taglibs.jsp&#34;</font><font color="#000000">%&gt;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#000000">&lt;div&nbsp;id=</font><font color="#2a00ff">&#34;menu&#34;</font><font color="#000000">&gt;</font><br/>
<font color="#000000">&lt;menu:useMenuDisplayer&nbsp;name=</font><font color="#2a00ff">&#34;ListMenu&#34;&nbsp;</font><font color="#000000">permissions=</font><font color="#2a00ff">&#34;rolesAdapter&#34;</font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;menu:displayMenu&nbsp;name=</font><font color="#2a00ff">&#34;AdminMenu&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;menu:displayMenu&nbsp;name=</font><font color="#2a00ff">&#34;UserMenu&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;menu:displayMenu&nbsp;name=</font><font color="#2a00ff">&#34;PeopleMenu&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;menu:displayMenu&nbsp;name=</font><font color="#2a00ff">&#34;FileUpload&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;menu:displayMenu&nbsp;name=</font><font color="#2a00ff">&#34;FlushCache&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;menu:displayMenu&nbsp;name=</font><font color="#2a00ff">&#34;Clickstream&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#000000">&lt;/menu:useMenuDisplayer&gt;</font><br/>
<font color="#000000">&lt;/div&gt;</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>Now if you run <b>ant clean deploy</b> start Tomcat and go to <a class="external" href="http://localhost:8080/appfuse/mainMenu.html">http://localhost:8080/appfuse/mainMenu.html</a><img class="outlink" src="images/out.png" alt="" />, you should see something like the screenshot below.
</p>
<div style="border: 1px solid black; margin: 0px auto; width: 551px; height: 184px">
<img class="inline" src="attach/ValidationAndList/new-menu-item.png" alt="ValidationAndList/new-menu-item.png" />
</div>
<p>Notice that there is a new link on the left side (from mainMenu.html) and on the right in our menu (from menu.jsp).
</p>
<h3 id='section-ValidationAndListTapestry-ThatsIt'>That's it!</h3>
You've completed the full lifecycle of developing a set of master-detail pages with AppFuse and Tapestry - <b>Congratulations</b>!  Now the real test is if you can run all the tests in your app without failure.  To test, stop tomcat and run <b>ant clean test-all</b>.  This will run all the unit tests within your project.  As a reminder, it should be easy to setup and test AppFuse from scratch using <b>ant setup-db setup-tomcat test-all</b>.  
<p><i><b>Happy Day!</b></i>
</p>
<div style="color: green">
BUILD SUCCESSFUL<br />
Total time: 2 minutes 15 seconds
</div>
<A NAME="Link_ValidationAndListWebWork">
<h1>ValidationAndListWebWork</h1>
</A>
<b>Part IV:</b> <a class="wikipage" href="Wiki.jsp?page=ValidationAndListWebWork">Adding Validation and List Screen</a> - Adding validation logic to the Person object so that firstName and lastName are required fields and adding a list screen to display all person records in the database.
<dl>
<dt></dt><dd><i>This tutorial depends on <b>Part III:</b> <a class="wikipage" href="Wiki.jsp?page=WebWorkActions">Creating WebWork Actions and JSPs</a>.</i></dd>
</dl>
<h3 id='section-ValidationAndListWebWork-AboutThisTutorial'>About this Tutorial</h3>
This tutorial will show you how to add Validation logic to the Person object using WebWork's Validation framework. You'll also create a list screen using the <a class="external" href="http://displaytag.sf.net">Display Tag Library</a><img class="outlink" src="images/out.png" alt="" /> to display all the people in the database.
<dl>
<dt></dt><dd><span style="color: blue"><i>I will tell you how I do stuff in the <b>Real World</b> in text like this.</i></span></dd>
</dl>
<h4 id='section-ValidationAndListWebWork-TableOfContents'>Table of Contents</h4>
<ul>
<li> <a class="footnoteref" href="#ref-ValidationAndListWebWork-1">[1]</a> Create a Person-validation.xml file with validation rules
</li>
<li> <a class="footnoteref" href="#ref-ValidationAndListWebWork-2">[2]</a> View JSP with validation added and test
</li>
<li> <a class="footnoteref" href="#ref-ValidationAndListWebWork-3">[3]</a> Add <i>testGetPeople</i> methods to DAO and Manager Tests
</li>
<li> <a class="footnoteref" href="#ref-ValidationAndListWebWork-4">[4]</a> Add <i>getPeople</i> methods to PersonDao and Manager
</li>
<li> <a class="footnoteref" href="#ref-ValidationAndListWebWork-5">[5]</a> Add <i>testSearch</i> methods to Action Test
</li>
<li> <a class="footnoteref" href="#ref-ValidationAndListWebWork-6">[6]</a> Add <i>search </i> method to Action 
</li>
<li> <a class="footnoteref" href="#ref-ValidationAndListWebWork-7">[7]</a> Create personList.jsp and Canoo test
</li>
<li> <a class="footnoteref" href="#ref-ValidationAndListWebWork-8">[8]</a> Add link to menu
</li>
</ul>
<h3 id='section-ValidationAndListWebWork-CreateAPersonValidation.xmlFileWithValidationRules1'>Create a Person-validation.xml file with validation rules <a class="footnote" name="ref-ValidationAndListWebWork-1">[#1]</a></h3>
To implement validation in WebWork's validation framework, there are a couple things you need to do.  The first is create a validation.xml file, the second is add a validation interceptor reference to the action you want to validate. More detailed information on WebWork's validation can be found in <a class="external" href="http://wiki.opensymphony.com/display/WW/Validation">WebWork's Validation documentation</a><img class="outlink" src="images/out.png" alt="" />.
<p>WebWork allows two types of validation - per-action and model-based.  Since you likely want the same rules applied for the person object across different actions, this tutorial will use model-based.
</p>
<p>Create a new file named Person-validation.xml in the src/dao/**/model directory.  It should contain the following XML:
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#000000">&lt;!DOCTYPE&nbsp;validators&nbsp;PUBLIC&nbsp;</font><font color="#2a00ff">&#34;-//OpenSymphony&nbsp;Group//XWork&nbsp;Validator&nbsp;1.0.2//EN&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#2a00ff">&#34;http://www.opensymphony.com/xwork/xwork-validator-1.0.2.dtd&#34;</font><font color="#000000">&gt;</font><br/>
<font color="#000000">&lt;validators&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;field&nbsp;name=</font><font color="#2a00ff">&#34;person.firstName&#34;</font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;field-validator&nbsp;type=</font><font color="#2a00ff">&#34;requiredstring&#34;</font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;message&nbsp;key=</font><font color="#2a00ff">&#34;errors.required&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/field-validator&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/field&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;field&nbsp;name=</font><font color="#2a00ff">&#34;person.lastName&#34;</font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;field-validator&nbsp;type=</font><font color="#2a00ff">&#34;requiredstring&#34;</font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;message&nbsp;key=</font><font color="#2a00ff">&#34;errors.required&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/field-validator&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/field&gt;</font><br/>
<font color="#000000">&lt;/validators&gt;</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>The "errors.message" key in ApplicationResources_*.properties (listed below) will use the field's "name" attribute to do internationalization.  You can also give the &lt;message> element a body if you don't need i18n.
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#000000">errors.required=$</font><font color="#000000">{</font><font color="#000000">getText</font><font color="#000000">(</font><font color="#000000">fieldName</font><font color="#000000">)}&nbsp;</font><font color="#000000">is&nbsp;a&nbsp;required&nbsp;field.</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>Now you need to configure PersonAction to know about <a class="external" href="http://wiki.opensymphony.com/display/WW/Visitor+validation">visitor validation</a><img class="outlink" src="images/out.png" alt="" />.  To do this, create a PersonAction-validation.xml file in the same directory as PersonAction.  Fill it with the following XML:
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#000000">&lt;!DOCTYPE&nbsp;validators&nbsp;PUBLIC&nbsp;</font><font color="#2a00ff">&#34;-//OpenSymphony&nbsp;Group//XWork&nbsp;Validator&nbsp;1.0.2//EN&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#2a00ff">&#34;http://www.opensymphony.com/xwork/xwork-validator-1.0.2.dtd&#34;</font><font color="#000000">&gt;</font><br/>
<font color="#000000">&lt;validators&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;field&nbsp;name=</font><font color="#2a00ff">&#34;person&#34;</font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;field-validator&nbsp;type=</font><font color="#2a00ff">&#34;visitor&#34;</font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;param&nbsp;name=</font><font color="#2a00ff">&#34;appendPrefix&#34;</font><font color="#000000">&gt;</font><font color="#7f0055"><b>false</b></font><font color="#000000">&lt;/param&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;message/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/field-validator&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/field&gt;</font><br/>
<font color="#000000">&lt;/validators&gt;</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>Unfortunately, WebWork doesn't have a transparent mechanism for reading from the Person-validation.xml file and marking fields as required on the UI.  AppFuse's Struts and Spring versions use a LabelTag that makes this possible, but they also both use Commons Validator.  It is my hope to someday provide this same functionality for WebWork.  In the meantime, the JSP tags "required" attribute has nothing to with the validation rules you specify.  Rather, they simply add an asterisk to the label with no further functionality.
</p>
<p><div class="note">
<b>NOTE:</b> Client-side validation of model-based validation rules <a class="external" href="http://jira.opensymphony.com/browse/XW-227">doesn't work</a><img class="outlink" src="images/out.png" alt="" /> with the SpringObjectFactory that AppFuse uses.  Furthermore, I believe that WebWork's client-side validation needs some additional features, namely: <a class="external" href="http://jira.opensymphony.com/browse/WW-648">allow cancelling</a><img class="outlink" src="images/out.png" alt="" /> and <a class="external" href="http://jira.opensymphony.com/browse/WW-647">showing all errors in one dialog</a><img class="outlink" src="images/out.png" alt="" />.  Because of this, only server-side validation works in WebWork+AppFuse. If you'd like, you can <a class="external" href="http://raibledesigns.com/page/rd?anchor=webwork_s_validation_and_springobjectfactory">read more</a><img class="outlink" src="images/out.png" alt="" /> about my frustrations with client-side validation.<br /><br />As a workaround, you can use per-action validation.  Just copy the Person-validation.xml file to the "webapp.action" package and rename it to PersonAction-validation.xml.
</div>
</p>
<p>WebWork's validation interceptor is enabled by default, so you don't need to configure anything for validation to work.
</p>
<h3 id='section-ValidationAndListWebWork-ViewJSPWithValidationAddedAndTest2'>View JSP with validation added and test <a class="footnote" name="ref-ValidationAndListWebWork-2">[#2]</a></h3>
<p>After saving all your files and deploying, validation should kick in when you try to save this form.  To test, run <b>ant db-load deploy</b>, start Tomcat and go to <a class="external" href="http://localhost:8080/appfuse/editPerson.html?id=1">http://localhost:8080/appfuse/editPerson.html?id=1</a><img class="outlink" src="images/out.png" alt="" />.
</p>
<p>If you erase the values in the firstName and lastName fields and click the save button, you should see the following:
</p>
<div style="border: 1px solid black; margin: 0 auto; height: 215px; width: 521px">
<img class="inline" src="attach/ValidationAndList/validation-required-nojs.png" alt="ValidationAndList/validation-required-nojs.png" />
</div>
<h3 id='section-ValidationAndListWebWork-AddTestGetPeopleMethodsToDAOAndManagerTests3'>Add testGetPeople methods to DAO and Manager Tests <a class="footnote" name="ref-ValidationAndListWebWork-3">[#3]</a></h3>
To create a List screen (also called a master screen), we need to create methods that will return all the rows from our <i>person</i> table.  Let's start by adding tests for these methods to our PersonDaoTest and PersonManagerTest classes.  I usually name this method <i>getEntities</i> (i.e. getUsers), but you could also use <i>getAll</i> or <i>search</i> - it's really just a matter of personal preference.
<p>Open test/dao/**/dao/PersonDaoTest.java and add a <i>testGetPeople</i> method:
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">testGetPeople</font><font color="#000000">()&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">person&nbsp;=&nbsp;</font><font color="#7f0055"><b>new&nbsp;</b></font><font color="#000000">Person</font><font color="#000000">()</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">List&nbsp;results&nbsp;=&nbsp;dao.getPeople</font><font color="#000000">(</font><font color="#000000">person</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">assertTrue</font><font color="#000000">(</font><font color="#000000">results.size</font><font color="#000000">()&nbsp;</font><font color="#000000">&gt;&nbsp;</font><font color="#990000">0</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>The reason I'm passing in a person object to the <i>getPeople</i> method is to allow for filtering (based on values in person) in the future. Adding this parameter in your getPeople() method signature is optional, but the rest of this tutorial assumes you have done this.
</p>
<p>Now open test/service/**/service/PersonManagerTest.java and add a <i>testGetPeople</i> method:
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">testGetPeople</font><font color="#000000">()&nbsp;</font><font color="#7f0055"><b>throws&nbsp;</b></font><font color="#000000">Exception&nbsp;</font><font color="#000000">{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">List&nbsp;results&nbsp;=&nbsp;</font><font color="#7f0055"><b>new&nbsp;</b></font><font color="#000000">ArrayList</font><font color="#000000">()</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">person&nbsp;=&nbsp;</font><font color="#7f0055"><b>new&nbsp;</b></font><font color="#000000">Person</font><font color="#000000">()</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">results.add</font><font color="#000000">(</font><font color="#000000">person</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f7f5f">//&nbsp;set&nbsp;expected&nbsp;behavior&nbsp;on&nbsp;dao</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">personDao.expects</font><font color="#000000">(</font><font color="#000000">once</font><font color="#000000">())</font><font color="#000000">.method</font><font color="#000000">(</font><font color="#2a00ff">&#34;getPeople&#34;</font><font color="#000000">)</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">.will</font><font color="#000000">(</font><font color="#000000">returnValue</font><font color="#000000">(</font><font color="#000000">results</font><font color="#000000">))</font><font color="#000000">;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">List&nbsp;people&nbsp;=&nbsp;personManager.getPeople</font><font color="#000000">(</font><font color="#7f0055"><b>null</b></font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">assertTrue</font><font color="#000000">(</font><font color="#000000">people.size</font><font color="#000000">()&nbsp;</font><font color="#000000">==&nbsp;</font><font color="#990000">1</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">personDao.verify</font><font color="#000000">()</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>In order for these tests to compile, you need to add the <i>getPeople()</i> method to the PersonDao and PersonManager interfaces, and their implementations.
</p>
<h3 id='section-ValidationAndListWebWork-AddGetPeopleMethodToDAOAndManager4'>Add getPeople() method to DAO and Manager <a class="footnote" name="ref-ValidationAndListWebWork-4">[#4]</a></h3>
Open src/dao/**/dao/PersonDao.java and add the getPeople() method signature:
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#000000">List&nbsp;getPeople</font><font color="#000000">(</font><font color="#000000">Person&nbsp;person</font><font color="#000000">)</font><font color="#000000">;</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>Now add the same method signature to src/service/**/service/<b>PersonManager.java</b>.  Save all your files and adjust the imports in your tests.  Next you need to implement the getPeople() method in your implementation classes.  Open src/dao/**/dao/hibernate/PersonDaoHibernate.java and add the following method:
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#000000">List&nbsp;getPeople</font><font color="#000000">(</font><font color="#000000">Person&nbsp;person</font><font color="#000000">)&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>return&nbsp;</b></font><font color="#000000">getHibernateTemplate</font><font color="#000000">()</font><font color="#000000">.find</font><font color="#000000">(</font><font color="#2a00ff">&#34;from&nbsp;Person&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p><div class="note" style="margin-left: 30px">
You'll notice here that nothing is being done with the <i>person</i> parameter.  This is just a placeholder for now - in the future you may want to filter on it's properties using <a class="external" href="http://www.hibernate.org/hib_docs/reference/en/html/queryhql.html">Hibernate's Query Language</a><img class="outlink" src="images/out.png" alt="" /> (HQL) or using <a class="external" href="http://www.hibernate.org/hib_docs/reference/en/html/querycriteria.html">Criteria Queries</a><img class="outlink" src="images/out.png" alt="" />.
</p>
<p><i>An example using a Criteria Query:</i>
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">Example&nbsp;example&nbsp;=&nbsp;Example.create</font><font color="#000000">(</font><font color="#000000">person</font><font color="#000000">)</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">.excludeZeroes</font><font color="#000000">()&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f7f5f">//&nbsp;exclude&nbsp;zero&nbsp;valued&nbsp;properties</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">.ignoreCase</font><font color="#000000">()</font><font color="#000000">;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f7f5f">//&nbsp;perform&nbsp;case&nbsp;insensitive&nbsp;string&nbsp;comparisons</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>try&nbsp;</b></font><font color="#000000">{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>return&nbsp;</b></font><font color="#000000">getSession</font><font color="#000000">()</font><font color="#000000">.createCriteria</font><font color="#000000">(</font><font color="#000000">Person.</font><font color="#7f0055"><b>class</b></font><font color="#000000">)</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">.add</font><font color="#000000">(</font><font color="#000000">example</font><font color="#000000">)</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">.list</font><font color="#000000">()</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}&nbsp;</font><font color="#7f0055"><b>catch&nbsp;</b></font><font color="#000000">(</font><font color="#000000">Exception&nbsp;e</font><font color="#000000">)&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>throw&nbsp;new&nbsp;</b></font><font color="#000000">DataAccessException</font><font color="#000000">(</font><font color="#000000">e.getMessage</font><font color="#000000">())</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>return&nbsp;new&nbsp;</b></font><font color="#000000">ArrayList</font><font color="#000000">()</font><font color="#000000">;</font><br/>
<font color="#ffffff"></font><font color="#ffffff">
</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</div>
</p>
<p>Now implement the <i>getPeople()</i> method in src/service/**/impl/PersonManagerImpl.java:
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#000000">List&nbsp;getPeople</font><font color="#000000">(</font><font color="#000000">Person&nbsp;person</font><font color="#000000">)&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>return&nbsp;</b></font><font color="#000000">dao.getPeople</font><font color="#000000">(</font><font color="#000000">person</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>After saving all your changes, you should be able to run both tests by executing the following: 
</p>
<ul>
<li> <b>ant test-dao -Dtestcase=PersonDao</b> 
</li>
<li> <b>ant test-service -Dtestcase=PersonManager</b>
</li>
</ul>
<p>If everything works - <i>nice job!</i> Now you need to add this <i>retrieve all</i> functionality to the web tier.
</p>
<h3 id='section-ValidationAndListWebWork-AddTestSearchMethodToActionTest5'>Add testSearch() method to Action Test <a class="footnote" name="ref-ValidationAndListWebWork-5">[#5]</a></h3>
Open test/web/**/action/PersonActionTest.java and add the following method:
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">testSearch</font><font color="#000000">()&nbsp;</font><font color="#7f0055"><b>throws&nbsp;</b></font><font color="#000000">Exception&nbsp;</font><font color="#000000">{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">assertNull</font><font color="#000000">(</font><font color="#000000">action.getPeople</font><font color="#000000">())</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">assertEquals</font><font color="#000000">(</font><font color="#000000">action.list</font><font color="#000000">()</font><font color="#000000">,&nbsp;</font><font color="#2a00ff">&#34;success&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">assertNotNull</font><font color="#000000">(</font><font color="#000000">action.getPeople</font><font color="#000000">())</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">assertFalse</font><font color="#000000">(</font><font color="#000000">action.hasActionErrors</font><font color="#000000">())</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>This class will not compile since the <tt>getPeople()</tt> and <tt>list()</tt> methods doesn't yet exist in PersonAction.
</p>
<h3 id='section-ValidationAndListWebWork-AddListAndGetPeopleMethodToAction6'>Add list() and getPeople() method to Action <a class="footnote" name="ref-ValidationAndListWebWork-6">[#6]</a></h3>
Open src/web/**/action/PersonAction.java and add the list() method to the body of the PersonAction class.  While you're at it, add a "people" class variable and a <tt>getPeople()</tt> method to expose it to the UI.
<dl>
<dt></dt><dd><span style="color: blue"><i>I used UserAction.search() as a template for this method.</i></dd>
</dl>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>private&nbsp;</b></font><font color="#000000">List&nbsp;people;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#000000">List&nbsp;getPeople</font><font color="#000000">()&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>return&nbsp;</b></font><font color="#000000">people;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#000000">String&nbsp;list</font><font color="#000000">()&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">people&nbsp;=&nbsp;personManager.getPeople</font><font color="#000000">(</font><font color="#7f0055"><b>new&nbsp;</b></font><font color="#000000">Person</font><font color="#000000">())</font><font color="#000000">;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>return&nbsp;</b></font><font color="#000000">SUCCESS;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff"></font><font color="#ffffff">
</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>You can test this works by running <b>ant test-web -Dtestcase=PersonAction</b>.
</p>
<p><b>Nice!</b>
<span style="color:green">BUILD SUCCESSFUL<br />
Total time: 10 seconds</span>
</p>
<h3 id='section-ValidationAndListWebWork-CreatePersonList.jspAndCanooTest7'>Create personList.jsp and Canoo test <a class="footnote" name="ref-ValidationAndListWebWork-7">[#7]</a></h3>
Open the personList.jsp file in <i>web/pages</i>.  At the top of the file is a &lt;ww:set&gt; tags that tries to expose the "people" from PersonAction.  However, by default, the generated name is just the plural of the object name.  So you'll need to change the referenced value from "persons" to "people".
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#000000">&lt;ww:set&nbsp;name=</font><font color="#2a00ff">&#34;personList&#34;&nbsp;</font><font color="#000000">value=</font><font color="#2a00ff">&#34;people&#34;&nbsp;</font><font color="#000000">scope=</font><font color="#2a00ff">&#34;request&#34;</font><font color="#000000">/&gt;</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>Another thing you'll probably want to change is the displayed plural form of the items you're listing.  The generated name in this example is "persons" and it should be "people".  At or near line 30, you should have the following line:
</p>
<pre>&lt;display:setProperty name="paging.banner.items_name" value="persons"/&gt;</pre>

<p>Change it to:
</p>
<pre>&lt;display:setProperty name="paging.banner.items_name" value="people"/&gt;</pre>

<p>Finally, add the title and heading keys (personList.title and personList.heading) to web/WEB-INF/classes/ApplicationResources.properties.  Open this file and add the following:
</p>
<pre>
# -- person list page --
personList.title=Person List
personList.heading=All People
</pre>

<p>As a reminder, the <tt>personList.title</tt> is what ends up in the brower's title bar (the &lt;title&gt; tag) and 
<tt>personList.heading</tt> will be put into an &lth1&gt; tag before any page content.  
</p>
<p>To expose the <tt>list()</tt> method as a URL, add a new "people" action to web/WEB-INF/classes/xwork.xml:
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;action&nbsp;name=</font><font color="#2a00ff">&#34;people&#34;&nbsp;</font><font color="#7f0055"><b>class</b></font><font color="#000000">=</font><font color="#2a00ff">&#34;personAction&#34;&nbsp;</font><font color="#000000">method=</font><font color="#2a00ff">&#34;list&#34;</font><font color="#000000">&gt;&nbsp;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;result&nbsp;name=</font><font color="#2a00ff">&#34;success&#34;</font><font color="#000000">&gt;/WEB-INF/pages/personList.jsp&lt;/result&gt;&nbsp;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/action&gt;</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>At this point, you should be able to run <b>ant clean deploy</b>, start Tomcat and view this page in your browser at <a class="external" href="http://localhost:8080/appfuse/people.html">http://localhost:8080/appfuse/people.html</a><img class="outlink" src="images/out.png" alt="" />.
</p>
<p>Now that you have a List Screen, let's change the pages that are displayed after adding and deleting a new Person.  In web/WEB-INF/classes/xwork.xml, change the savePersons's "input" and "success" results to be "people.html".
</p>
<p>You will also need to change the Canoo tests "AddPerson" and "DeletePerson".  Open test/web/web-tests.xml and change the following line in the "AddPerson" target:
</p>
<pre>&lt;verifytitle description="Main Menu appears if save successful" 
    text=".*${mainMenu.title}.*" regex="true"/&gt;</pre>

<p>to: 
</p>
<pre>&lt;verifytitle description="Person List appears if save successful" 
    text=".*${personList.title}.*" regex="true"/&gt;</pre>

<p>Then in the "DeletePerson" target, change the following line:
</p>
<pre>&lt;verifytitle description="display Main Menu" 
    text=".*$(mainMenu.title}.*" regex="true"/&gt;
</pre>

<p>to:
</p>
<pre>&lt;verifytitle description="display Person List" text=".*${personList.title}.*" regex="true"/&gt;</pre>

<p>To test that displaying this page works, create a new JSP test in test/web/web-tests.xml:
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;!--&nbsp;Verify&nbsp;the&nbsp;people&nbsp;list&nbsp;screen&nbsp;displays&nbsp;without&nbsp;errors&nbsp;--&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;target&nbsp;name=</font><font color="#2a00ff">&#34;SearchPeople&#34;&nbsp;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">description=</font><font color="#2a00ff">&#34;Tests&nbsp;search&nbsp;for&nbsp;and&nbsp;displaying&nbsp;all&nbsp;people&#34;</font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;webtest&nbsp;name=</font><font color="#2a00ff">&#34;searchPeople&#34;</font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&amp;config;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;steps&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&amp;login;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;invoke&nbsp;description=</font><font color="#2a00ff">&#34;click&nbsp;View&nbsp;People&nbsp;link&#34;&nbsp;</font><font color="#000000">url=</font><font color="#2a00ff">&#34;/people.html&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;verifytitle&nbsp;description=</font><font color="#2a00ff">&#34;we&nbsp;should&nbsp;see&nbsp;the&nbsp;personList&nbsp;title&#34;&nbsp;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">text=</font><font color="#2a00ff">&#34;.*${personList.title}.*&#34;&nbsp;</font><font color="#000000">regex=</font><font color="#2a00ff">&#34;true&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/steps&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/webtest&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/target&gt;</font><br/>
<font color="#ffffff"></font><font color="#ffffff">
</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>You'll also want to add the "SearchPeople" target to the "PersonTests" target so it will be executed along with all the other person-related tests.
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;!--&nbsp;runs&nbsp;person-related&nbsp;tests&nbsp;--&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;target&nbsp;name=</font><font color="#2a00ff">&#34;PersonTests&#34;&nbsp;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">depends=</font><font color="#2a00ff">&#34;SearchPeople,EditPerson,SavePerson,AddPerson,DeletePerson&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">description=</font><font color="#2a00ff">&#34;Call&nbsp;and&nbsp;executes&nbsp;all&nbsp;person&nbsp;test&nbsp;cases&nbsp;(targets)&#34;</font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;echo&gt;Successfully&nbsp;ran&nbsp;all&nbsp;Person&nbsp;JSP&nbsp;tests!&lt;/echo&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/target&gt;</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>Now you can run <b>ant test-canoo -Dtestcase=SearchPeople</b> (or <i>ant test-jsp</i> if Tomcat isn't running) and hopefully it will result in "BUILD SUCCESSFUL".  If so - <i>nice work!</i>
</p>
<h3 id='section-ValidationAndListWebWork-AddLinkToMenu8'>Add link to menu <a class="footnote" name="ref-ValidationAndListWebWork-8">[#8]</a></h3>
The last step is to make the list, add, edit and delete functions visible to the user.  The simplest way is to add a new link to the list of links in web/pages/mainMenu.jsp:
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;li&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;a&nbsp;href=</font><font color="#2a00ff">&#34;&lt;c:url&nbsp;value=&#34;</font><font color="#000000">/people.html</font><font color="#2a00ff">&#34;/&gt;&#34;</font><font color="#000000">&gt;&lt;fmt:message&nbsp;key=</font><font color="#2a00ff">&#34;menu.viewPeople&#34;</font><font color="#000000">/&gt;&lt;/a&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/li&gt;</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>Where <i>menu.viewPeople</i> is an entry in web/WEB-INF/classes/ApplicationResources.properties.
</p>
<pre>
menu.viewPeople=View People
</pre>

<p>The other (more likely) alternative is that you'll want to add it to the menu.  To do this, add the following to web/WEB-INF/menu-config.xml:
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#000000">&lt;Menu&nbsp;name=</font><font color="#2a00ff">&#34;PeopleMenu&#34;&nbsp;</font><font color="#000000">title=</font><font color="#2a00ff">&#34;menu.viewPeople&#34;&nbsp;</font><font color="#000000">page=</font><font color="#2a00ff">&#34;/people.html&#34;</font><font color="#000000">/&gt;</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>Make sure the above XML is inside the &lt;Menus&gt; tag, but not within another &lt;Menu&gt;.  Then add this new menu to web/pages/menu.jsp - which should now look as follows:
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#000000">&lt;%@&nbsp;include&nbsp;file=</font><font color="#2a00ff">&#34;/common/taglibs.jsp&#34;</font><font color="#000000">%&gt;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#000000">&lt;div&nbsp;id=</font><font color="#2a00ff">&#34;menu&#34;</font><font color="#000000">&gt;</font><br/>
<font color="#000000">&lt;menu:useMenuDisplayer&nbsp;name=</font><font color="#2a00ff">&#34;ListMenu&#34;&nbsp;</font><font color="#000000">permissions=</font><font color="#2a00ff">&#34;rolesAdapter&#34;</font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;menu:displayMenu&nbsp;name=</font><font color="#2a00ff">&#34;AdminMenu&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;menu:displayMenu&nbsp;name=</font><font color="#2a00ff">&#34;UserMenu&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;menu:displayMenu&nbsp;name=</font><font color="#2a00ff">&#34;PeopleMenu&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;menu:displayMenu&nbsp;name=</font><font color="#2a00ff">&#34;FileUpload&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;menu:displayMenu&nbsp;name=</font><font color="#2a00ff">&#34;FlushCache&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;menu:displayMenu&nbsp;name=</font><font color="#2a00ff">&#34;Clickstream&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#000000">&lt;/menu:useMenuDisplayer&gt;</font><br/>
<font color="#000000">&lt;/div&gt;</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>Now if you run <b>ant clean deploy</b> start Tomcat and go to <a class="external" href="http://localhost:8080/appfuse/mainMenu.html">http://localhost:8080/appfuse/mainMenu.html</a><img class="outlink" src="images/out.png" alt="" />, you should see something like the screenshot below.
</p>
<div style="border: 1px solid black; margin: 0px auto; width: 551px; height: 184px">
<img class="inline" src="attach/ValidationAndList/new-menu-item.png" alt="ValidationAndList/new-menu-item.png" />
</div>
<p>Notice that there is a new link on the left side (from mainMenu.jsp) and on the right in our menu (from menu.jsp).
</p>
<h3 id='section-ValidationAndListWebWork-ThatsIt'>That's it!</h3>
You've completed the full lifecycle of developing a set of master-detail pages with AppFuse and WebWork - <b>Congratulations</b>!  Now the real test is if you can run all the tests in your app without failure.  To test, stop tomcat and run <b>ant clean test-all</b>.  This will run all the unit tests within your project.  As a reminder, it should be easy to setup and test AppFuse from scratch using <b>ant setup-db setup-tomcat test-all</b>.  Also, if you're looking for more robust examples - checkout <a class="wikipage" href="Wiki.jsp?page=StrutsResume">Struts Resume</a>.
<p><i><b>Happy Day!</b></i>
</p>
<div style="color: green">
BUILD SUCCESSFUL<br />
Total time: 4 minutes 15 seconds
</div>
<A NAME="Link_WebWorkActions">
<h1>WebWorkActions</h1>
</A>
<b>Part III:</b> <a class="wikipage" href="Wiki.jsp?page=WebWorkActions">Creating Actions and JSPs</a> - A HowTo for creating <a class="external" href="http://www.opensymphony.com/webwork">WebWork</a><img class="outlink" src="images/out.png" alt="" /> Actions and JSPs in an <a class="wikipage" href="Wiki.jsp?page=AppFuse">AppFuse</a> project.
<dl>
<dt></dt><dd><i>This tutorial depends on <b>Part II:</b> <a class="wikipage" href="Wiki.jsp?page=CreateManager">Creating new Managers</a>.</i></dd>
</dl>
<h3 id='section-WebWorkActions-AboutThisTutorial'>About this Tutorial</h3>
This tutorial will show you how to create WebWork Actions and JSPs.  It'll also demonstrate writing a JUnit Test to test PersonAction.  The Action we create will talk to the PersonManager we created in the <a class="wikipage" href="Wiki.jsp?page=CreateManager">Creating Managers</a> tutorial.  
<dl>
<dt></dt><dd><span style="color: blue"><i>I will tell you how I do stuff in the <b>Real World</b> in text like this.</i></span></dd>
</dl>
<p>Let's get started by creating a new Action and JSP in AppFuse's architecture.  If you haven't installed the WebWork module at this point, do so by running <i>ant install-webwork</i>.
</p>
<h4 id='section-WebWorkActions-TableOfContents'>Table of Contents</h4>
<ul>
<li> <a class="footnoteref" href="#ref-WebWorkActions-1">[1]</a> Create skeleton JSPs using XDoclet
</li>
<li> <a class="footnoteref" href="#ref-WebWorkActions-2">[2]</a> Create PersonActionTest to test PersonAction
</li>
<li> <a class="footnoteref" href="#ref-WebWorkActions-3">[3]</a> Create PersonAction
</li>
<li> <a class="footnoteref" href="#ref-WebWorkActions-4">[4]</a> Run PersonActionTest
</li>
<li> <a class="footnoteref" href="#ref-WebWorkActions-5">[5]</a> Clean up the JSP to make it presentable 
</li>
<li> <a class="footnoteref" href="#ref-WebWorkActions-6">[6]</a> Create Canoo WebTests to test browser-like actions
</li>
</ul>
<h3 id='section-WebWorkActions-CreateASkeletonJSPUsingXDoclet1'>Create a skeleton JSP using XDoclet <a class="footnote" name="ref-WebWorkActions-1">[#1]</a></h3>
In this step, you'll generate a JSP page to display information from the Person object.  It will contain WebWork's JSP tags that render table rows for each property in Person.java.  The <a class="wikipage" href="Wiki.jsp?page=AppGen">AppGen</a> tool that's used to do this is based off a StrutsGen tool - which was originally written by <a class="external" href="http://www.blogscene.org/erik/">Erik Hatcher</a><img class="outlink" src="images/out.png" alt="" />.  It's basically just a couple of classes and a bunch of XDoclet templates.  All these files are located in extras/appgen.
<p>Here are the simple steps to generating the JSP and a properties file containing the labels for the form elements:
</p>
<ul>
<li> From the command-line, navigate to "extras/appgen"
</li>
<li> Execute <b>ant -Dobject.name=Person -Dappgen.type=pojo</b> to generate a bunch of files in extras/appgen/build/gen.  In fact, it'll generate all the files you need to complete this tutorial.  However, let's just grab the ones you need.
<ul>
<li> web/WEB-INF/classes/Person.properties (labels for your form elements) 
</li>
<li> web/pages/personForm.jsp (JSP file for viewing a single Person)
</li>
<li> web/pages/personList.jsp (JSP file for viewing a list of People)
</li>
</ul>
</li>
<li> Copy the contents of Person.properties into web/WEB-INF/classes/ApplicationResources.properties.  These are all the keys you will need for titles/headings and form properties.  Here is an example of what you should add to ApplicationResources.properties:
</li>
</ul>
<div style="margin-left: 40px">
<pre>
# -- person form --
person.id=Id
person.firstName=First Name
person.lastName=Last Name

person.added=Person has been added successfully.
person.updated=Person has been updated successfully.
person.deleted=Person has been deleted successfully.

# -- person list page --
personList.title=Person List
personList.heading=Persons

# -- person detail page --
personDetail.title=Person Detail
personDetail.heading=Person Information
</pre>

</div>
<ul>
<li> Copy personForm.jsp to web/pages/personForm.jsp.  Copy personList.jsp to web/pages/personList.jsp.   
</li>
</ul>
<dl>
<dt></dt><dd> <i>The files in the "pages" directory will end up in "WEB-INF/pages" at deployment time. The container provides security for all files below WEB-INF.  This applies to client requests, but not to forwards from the ServletDispatcher. Placing all JSPs below WEB-INF ensures they are only accessed through Actions, and not directly by the client or each other. This allows security to be moved up into the Actions, where it can be handled more efficiently, and out of the base presentation layer.</i></dd>
</dl>
<p>The web application security for AppFuse specifies that all *.html url-patterns should be protected (except for /signup.html and /passwordHint.html).  This guarantees that clients must go through an Action to get to a JSP (or at least the ones in <i>pages</i>).  
</p>
<span class="note"><b>NOTE:</b> If you want to customize the CSS for a particular page, you can add &lt;body id="pageName"/> to the top of the file.  This will be slurped up by SiteMesh and put into the final page.  You can then customize your CSS on a page-by-page basis using something like the following: 
<pre>body#pageName element.class { background-color: blue } </pre>
</span>
<ul>
<li> Add keys in ApplicationResources.properties the titles and headings in the JSPs
</li>
</ul>
In the generated JSPs, there are two keys for the title (top of the browser window) and the header (heading in the page).  We now need to add these two keys (personDetail.title and personDetail.heading) to ApplicationResources.properties.
<pre>
# -- person detail page --
personDetail.title=Person Detail
personDetail.heading=Person Information
</pre>

<dl>
<dt></dt><dd><i>Just above, we added "personForm.*" keys to this file, so why do I use personForm </i>and<i> personDetail?  The best reason is because it gives a nice separation between form labels and text on the page.  Another reason is because all the *Form.* give you a nice representation of all the fields in your database.  </dd>
</dl>
<p>I recently had a client who wanted all fields in the database searchable.  This was fairly easy to do.  I just looked up all the keys in ApplicationResources.properties which contained "Form." and then put them into a drop-down.  On the UI, the user was able to enter a search term and select the column they wanted to search.  I was glad I followed this Form vs. Detail distinction on that project!</i>
</p>
<p></p>
<h3 id='section-WebWorkActions-CreatePersonActionTestToTestPersonAction2'>Create PersonActionTest to test PersonAction <a class="footnote" name="ref-WebWorkActions-2">[#2]</a></h3>
To create a JUnit Test for PersonAction, start by creating a PersonActionTest.java file in the test/web/**/action directory.
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#7f0055"><b>package&nbsp;</b></font><font color="#000000">org.appfuse.webapp.action;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">org.springframework.mock.web.MockHttpServletRequest;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">com.opensymphony.webwork.ServletActionContext;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#7f0055"><b>public&nbsp;class&nbsp;</b></font><font color="#000000">PersonActionTest&nbsp;</font><font color="#7f0055"><b>extends&nbsp;</b></font><font color="#000000">BaseActionTestCase&nbsp;</font><font color="#000000">{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>private&nbsp;</b></font><font color="#000000">PersonAction&nbsp;action;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>protected&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">setUp</font><font color="#000000">()&nbsp;</font><font color="#7f0055"><b>throws&nbsp;</b></font><font color="#000000">Exception&nbsp;</font><font color="#000000">{&nbsp;&nbsp;&nbsp;&nbsp;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>super</b></font><font color="#000000">.setUp</font><font color="#000000">()</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">action&nbsp;=&nbsp;</font><font color="#000000">(</font><font color="#000000">PersonAction</font><font color="#000000">)&nbsp;</font><font color="#000000">ctx.getBean</font><font color="#000000">(</font><font color="#2a00ff">&#34;personAction&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>protected&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">tearDown</font><font color="#000000">()&nbsp;</font><font color="#7f0055"><b>throws&nbsp;</b></font><font color="#000000">Exception&nbsp;</font><font color="#000000">{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>super</b></font><font color="#000000">.tearDown</font><font color="#000000">()</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">action&nbsp;=&nbsp;</font><font color="#7f0055"><b>null</b></font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">testEdit</font><font color="#000000">()&nbsp;</font><font color="#7f0055"><b>throws&nbsp;</b></font><font color="#000000">Exception&nbsp;</font><font color="#000000">{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">log.debug</font><font color="#000000">(</font><font color="#2a00ff">&#34;testing&nbsp;edit...&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">action.setId</font><font color="#000000">(</font><font color="#2a00ff">&#34;1&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">assertNull</font><font color="#000000">(</font><font color="#000000">action.getPerson</font><font color="#000000">())</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">assertEquals</font><font color="#000000">(</font><font color="#000000">action.edit</font><font color="#000000">()</font><font color="#000000">,&nbsp;</font><font color="#2a00ff">&#34;success&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">assertNotNull</font><font color="#000000">(</font><font color="#000000">action.getPerson</font><font color="#000000">())</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">assertFalse</font><font color="#000000">(</font><font color="#000000">action.hasActionErrors</font><font color="#000000">())</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">testSave</font><font color="#000000">()&nbsp;</font><font color="#7f0055"><b>throws&nbsp;</b></font><font color="#000000">Exception&nbsp;</font><font color="#000000">{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">MockHttpServletRequest&nbsp;request&nbsp;=&nbsp;</font><font color="#7f0055"><b>new&nbsp;</b></font><font color="#000000">MockHttpServletRequest</font><font color="#000000">()</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">ServletActionContext.setRequest</font><font color="#000000">(</font><font color="#000000">request</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">action.setId</font><font color="#000000">(</font><font color="#2a00ff">&#34;1&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">assertEquals</font><font color="#000000">(</font><font color="#000000">action.edit</font><font color="#000000">()</font><font color="#000000">,&nbsp;</font><font color="#2a00ff">&#34;success&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">assertNotNull</font><font color="#000000">(</font><font color="#000000">action.getPerson</font><font color="#000000">())</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f7f5f">//&nbsp;update&nbsp;last&nbsp;name&nbsp;and&nbsp;save</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">action.getPerson</font><font color="#000000">()</font><font color="#000000">.setLastName</font><font color="#000000">(</font><font color="#2a00ff">&#34;Updated&nbsp;Last&nbsp;Name&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">assertEquals</font><font color="#000000">(</font><font color="#000000">action.save</font><font color="#000000">()</font><font color="#000000">,&nbsp;</font><font color="#2a00ff">&#34;input&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">assertEquals</font><font color="#000000">(</font><font color="#000000">action.getPerson</font><font color="#000000">()</font><font color="#000000">.getLastName</font><font color="#000000">()</font><font color="#000000">,&nbsp;</font><font color="#2a00ff">&#34;Updated&nbsp;Last&nbsp;Name&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">assertFalse</font><font color="#000000">(</font><font color="#000000">action.hasActionErrors</font><font color="#000000">())</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">assertFalse</font><font color="#000000">(</font><font color="#000000">action.hasFieldErrors</font><font color="#000000">())</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">assertNotNull</font><font color="#000000">(</font><font color="#000000">request.getSession</font><font color="#000000">()</font><font color="#000000">.getAttribute</font><font color="#000000">(</font><font color="#2a00ff">&#34;messages&#34;</font><font color="#000000">))</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">testRemove</font><font color="#000000">()&nbsp;</font><font color="#7f0055"><b>throws&nbsp;</b></font><font color="#000000">Exception&nbsp;</font><font color="#000000">{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">MockHttpServletRequest&nbsp;request&nbsp;=&nbsp;</font><font color="#7f0055"><b>new&nbsp;</b></font><font color="#000000">MockHttpServletRequest</font><font color="#000000">()</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">ServletActionContext.setRequest</font><font color="#000000">(</font><font color="#000000">request</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">action.setDelete</font><font color="#000000">(</font><font color="#2a00ff">&#34;&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">Person&nbsp;person&nbsp;=&nbsp;</font><font color="#7f0055"><b>new&nbsp;</b></font><font color="#000000">Person</font><font color="#000000">()</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">person.setId</font><font color="#000000">(</font><font color="#7f0055"><b>new&nbsp;</b></font><font color="#000000">Long</font><font color="#000000">(</font><font color="#990000">2</font><font color="#000000">))</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">action.setPerson</font><font color="#000000">(</font><font color="#000000">person</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">assertEquals</font><font color="#000000">(</font><font color="#000000">action.delete</font><font color="#000000">()</font><font color="#000000">,&nbsp;</font><font color="#2a00ff">&#34;success&#34;</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">assertNotNull</font><font color="#000000">(</font><font color="#000000">request.getSession</font><font color="#000000">()</font><font color="#000000">.getAttribute</font><font color="#000000">(</font><font color="#2a00ff">&#34;messages&#34;</font><font color="#000000">))</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#000000">}</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>Nothing will compile at this point because you need to create the PersonAction that you're referring to in this test.
</p>
<h3 id='section-WebWorkActions-CreatePersonAction3'>Create PersonAction <a class="footnote" name="ref-WebWorkActions-3">[#3]</a></h3>
<p>In src/web/**/action, create a PersonAction.java file with the following contents:
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#7f0055"><b>package&nbsp;</b></font><font color="#000000">org.appfuse.webapp.action;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">java.util.ArrayList;</font><br/>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">java.util.List;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">org.appfuse.model.Person;</font><br/>
<font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">org.appfuse.service.PersonManager;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#7f0055"><b>public&nbsp;class&nbsp;</b></font><font color="#000000">PersonAction&nbsp;</font><font color="#7f0055"><b>extends&nbsp;</b></font><font color="#000000">BaseAction&nbsp;</font><font color="#000000">{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>private&nbsp;</b></font><font color="#000000">Person&nbsp;person;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>private&nbsp;</b></font><font color="#000000">String&nbsp;id;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>private&nbsp;</b></font><font color="#000000">PersonManager&nbsp;personManager;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">setId</font><font color="#000000">(</font><font color="#000000">String&nbsp;id</font><font color="#000000">)&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>this</b></font><font color="#000000">.id&nbsp;=&nbsp;id;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">setPersonManager</font><font color="#000000">(</font><font color="#000000">PersonManager&nbsp;manager</font><font color="#000000">)&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>this</b></font><font color="#000000">.personManager&nbsp;=&nbsp;manager;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#000000">Person&nbsp;getPerson</font><font color="#000000">()&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>return&nbsp;</b></font><font color="#000000">person;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">setPerson</font><font color="#000000">(</font><font color="#000000">Person&nbsp;person</font><font color="#000000">)&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>this</b></font><font color="#000000">.person&nbsp;=&nbsp;person;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#000000">String&nbsp;delete</font><font color="#000000">()&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">personManager.removePerson</font><font color="#000000">(</font><font color="#000000">String.valueOf</font><font color="#000000">(</font><font color="#000000">person.getId</font><font color="#000000">()))</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">saveMessage</font><font color="#000000">(</font><font color="#000000">getText</font><font color="#000000">(</font><font color="#2a00ff">&#34;person.deleted&#34;</font><font color="#000000">))</font><font color="#000000">;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>return&nbsp;</b></font><font color="#000000">SUCCESS;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#000000">String&nbsp;edit</font><font color="#000000">()&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>if&nbsp;</b></font><font color="#000000">(</font><font color="#000000">id&nbsp;!=&nbsp;</font><font color="#7f0055"><b>null</b></font><font color="#000000">)&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">person&nbsp;=&nbsp;personManager.getPerson</font><font color="#000000">(</font><font color="#000000">id</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}&nbsp;</font><font color="#7f0055"><b>else&nbsp;</b></font><font color="#000000">{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">person&nbsp;=&nbsp;</font><font color="#7f0055"><b>new&nbsp;</b></font><font color="#000000">Person</font><font color="#000000">()</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>return&nbsp;</b></font><font color="#000000">SUCCESS;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#000000">String&nbsp;save</font><font color="#000000">()&nbsp;</font><font color="#7f0055"><b>throws&nbsp;</b></font><font color="#000000">Exception&nbsp;</font><font color="#000000">{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>if&nbsp;</b></font><font color="#000000">(</font><font color="#000000">cancel&nbsp;!=&nbsp;</font><font color="#7f0055"><b>null</b></font><font color="#000000">)&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>return&nbsp;</b></font><font color="#2a00ff">&#34;cancel&#34;</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>if&nbsp;</b></font><font color="#000000">(</font><font color="#000000">delete&nbsp;!=&nbsp;</font><font color="#7f0055"><b>null</b></font><font color="#000000">)&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>return&nbsp;</b></font><font color="#000000">delete</font><font color="#000000">()</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>boolean&nbsp;</b></font><font color="#000000">isNew&nbsp;=&nbsp;</font><font color="#000000">(</font><font color="#000000">person.getId</font><font color="#000000">()&nbsp;</font><font color="#000000">==&nbsp;</font><font color="#7f0055"><b>null</b></font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">personManager.savePerson</font><font color="#000000">(</font><font color="#000000">person</font><font color="#000000">)</font><font color="#000000">;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">String&nbsp;key&nbsp;=&nbsp;</font><font color="#000000">(</font><font color="#000000">isNew</font><font color="#000000">)&nbsp;</font><font color="#000000">?&nbsp;</font><font color="#2a00ff">&#34;person.added&#34;&nbsp;</font><font color="#000000">:&nbsp;</font><font color="#2a00ff">&#34;person.updated&#34;</font><font color="#000000">;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">saveMessage</font><font color="#000000">(</font><font color="#000000">getText</font><font color="#000000">(</font><font color="#000000">key</font><font color="#000000">))</font><font color="#000000">;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>if&nbsp;</b></font><font color="#000000">(</font><font color="#000000">!isNew</font><font color="#000000">)&nbsp;{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>return&nbsp;</b></font><font color="#000000">INPUT;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}&nbsp;</font><font color="#7f0055"><b>else&nbsp;</b></font><font color="#000000">{</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>return&nbsp;</b></font><font color="#000000">SUCCESS;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br/>
<font color="#000000">}</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>There are a few keys you (might) need to add to ApplicationResources.properties to display the success messages.  This file is located in <i>web/WEB-INF/classes</i> - open it and add the following:
</p>
<dl>
<dt></dt><dd><i>I usually add these under the <tt># -- success messages --</tt> comment.</i></dd>
</dl>
<pre>person.added=Person has been added successfully.
person.updated=Person has been updated successfully.
person.deleted=Person has been deleted successfully.
</pre>

<p>You could use generic <i>added</i>, <i>deleted</i> and <i>updated</i> messages, whatever works for you.  It's nice to have separate messages in case these need to change on a per-entity basis.
</p>
<p>You might notice that the code we're using to call the PersonManager is the same as the code we used in our PersonManagerTest.  Both PersonAction and PersonManagerTest are <i>clients</i> of PersonManagerImpl, so this makes perfect sense.
</p>
<p>Now you need to tell Spring and WebWork that this action exists.  First, add a bean definition for PersonAction to web/WEB-INF/action-servlet.xml:
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;bean&nbsp;id=</font><font color="#2a00ff">&#34;personAction&#34;&nbsp;</font><font color="#7f0055"><b>class</b></font><font color="#000000">=</font><font color="#2a00ff">&#34;org.appfuse.webapp.action.PersonAction&#34;&nbsp;</font><font color="#000000">singleton=</font><font color="#2a00ff">&#34;false&#34;</font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;property&nbsp;name=</font><font color="#2a00ff">&#34;personManager&#34;&nbsp;</font><font color="#000000">ref=</font><font color="#2a00ff">&#34;personManager&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/bean&gt;</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>Then add an entry that refers to this bean in web/WEB-INF/classes/xwork.xml:
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;action&nbsp;name=</font><font color="#2a00ff">&#34;editPerson&#34;&nbsp;</font><font color="#7f0055"><b>class</b></font><font color="#000000">=</font><font color="#2a00ff">&#34;personAction&#34;&nbsp;</font><font color="#000000">method=</font><font color="#2a00ff">&#34;edit&#34;</font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;result&nbsp;name=</font><font color="#2a00ff">&#34;success&#34;</font><font color="#000000">&gt;/WEB-INF/pages/personForm.jsp&lt;/result&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/action&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;action&nbsp;name=</font><font color="#2a00ff">&#34;savePerson&#34;&nbsp;</font><font color="#7f0055"><b>class</b></font><font color="#000000">=</font><font color="#2a00ff">&#34;personAction&#34;&nbsp;</font><font color="#000000">method=</font><font color="#2a00ff">&#34;save&#34;</font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;result&nbsp;name=</font><font color="#2a00ff">&#34;cancel&#34;&nbsp;</font><font color="#000000">type=</font><font color="#2a00ff">&#34;redirect&#34;</font><font color="#000000">&gt;mainMenu.html&lt;/result&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;result&nbsp;name=</font><font color="#2a00ff">&#34;input&#34;</font><font color="#000000">&gt;/WEB-INF/pages/personForm.jsp&lt;/result&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;result&nbsp;name=</font><font color="#2a00ff">&#34;success&#34;&nbsp;</font><font color="#000000">type=</font><font color="#2a00ff">&#34;redirect&#34;</font><font color="#000000">&gt;mainMenu.html&lt;/result&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/action&gt;</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<h3 id='section-WebWorkActions-RunThePersonActionTest4'>Run the PersonActionTest <a class="footnote" name="ref-WebWorkActions-4">[#4]</a></h3>
If you look at our PersonActionTest, all the tests depend on having a record with id=1 in the database (and testRemove depends on id=2), so let's add those records to our sample data file (metadata/sql/sample-data.xml). I'd just add it at the bottom - order is not important since it (currently) does not relate to any other tables.
<pre>
  &lt;table name='person'&gt;
    &lt;column&gt;id&lt;/column&gt;
    &lt;column&gt;first_name&lt;/column&gt;
    &lt;column&gt;last_name&lt;/column&gt;
    &lt;row&gt;
      &lt;value&gt;1&lt;/value&gt;
      &lt;value&gt;Matt&lt;/value&gt;
      &lt;value&gt;Raible&lt;/value&gt;
    &lt;/row&gt;
    &lt;row&gt;
      &lt;value&gt;2&lt;/value&gt;
      &lt;value&gt;James&lt;/value&gt;
      &lt;value&gt;Davidson&lt;/value&gt;
    &lt;/row&gt;
  &lt;/table&gt;
</pre>

<p>DBUnit loads this file before we running any of the tests, so this record will be available to your Action test.
</p>
<p>Make sure are in the base directory of your project and all files are saved.  If you run <b>ant test-web -Dtestcase=PersonAction</b> - everything should work as planned.  
</p>
<span style="color:green">BUILD SUCCESSFUL<br />
Total time: 21 seconds</span>
<p></p>
<h3 id='section-WebWorkActions-CleanUpTheJSPToMakeItPresentable5'>Clean up the JSP to make it presentable <a class="footnote" name="ref-WebWorkActions-5">[#5]</a></h3>
Now let's clean up the generated personForm.jsp by making the "id" property a hidden field. Remove the following code block from web/pages/personForm.jsp:
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;ww:textfield&nbsp;label=</font><font color="#2a00ff">&#34;%{getText('person.id')}&#34;&nbsp;</font><font color="#000000">name=</font><font color="#2a00ff">&#34;person.id&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">value=</font><font color="#2a00ff">&#34;%{person.id}&#34;&nbsp;</font><font color="#000000">required=</font><font color="#2a00ff">&#34;true&#34;</font><font color="#000000">/&gt;</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>And add the following before the &lt;table&gt; tag:
</p>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#000000">&lt;ww:hidden&nbsp;name=</font><font color="#2a00ff">&#34;person.id&#34;&nbsp;</font><font color="#000000">value=</font><font color="#2a00ff">&#34;%{person.id}&#34;</font><font color="#000000">/&gt;</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>If you want to add a usability enhancement to your form, you can set the cursor to focus on the first field when the page loads.  Simply add the following JavaScript at the bottom of your form:
</p>
<pre>&lt;script type="text/javascript"&gt;
    Form.focusFirstElement(document.forms["personForm"]);
&lt;/script&gt;</pre>
  
<p>Now if you execute <b>ant db-load deploy</b>, start Tomcat and point your browser to <a class="external" href="http://localhost:8080/appfuse/editPerson.html?id=1">http://localhost:8080/appfuse/editPerson.html?id=1</a><img class="outlink" src="images/out.png" alt="" />, you should see something like this:
</p>
<div style="border: 1px solid black; margin: 0 auto; height: 166px; width: 337px">
<img class="inline" src="attach/CreateActions/personForm-final.png" alt="CreateActions/personForm-final.png" />
</div>
<p>Finally, to make this page more user friendly, you may want to add a message for your users at the top of the form, but this can easily be done by adding text (using &lt;fmt:message&gt;) at the top of the personForm.jsp page.
</p>
<h3 id='section-WebWorkActions-OptionalCreateACanooWebTestToTestBrowserLikeActions6'>[Optional] Create a Canoo WebTest to test browser-like actions <a class="footnote" name="ref-WebWorkActions-6">[#6]</a></h3>
The final (optional) step in this tutorial is to create a <a class="external" href="http://webtest.canoo.com">Canoo WebTest</a><img class="outlink" src="images/out.png" alt="" /> to test the JSPs.  
<dl>
<dt></dt><dd><i>I say this step is optional, because you can run the same tests through your browser.</i></dd>
</dl>
<p>You can use the following URLs to test the different actions for adding, editing and saving a user.
</p>
<ul>
<li> Add - <a class="external" href="http://localhost:8080/appfuse/editPerson.html">http://localhost:8080/appfuse/editPerson.html</a><img class="outlink" src="images/out.png" alt="" />.
</li>
<li> Edit - <a class="external" href="http://localhost:8080/appfuse/editPerson.html?id=1">http://localhost:8080/appfuse/editPerson.html?id=1</a><img class="outlink" src="images/out.png" alt="" /> (make sure and run <b>ant db-load</b> first).
</li>
<li> Delete - Use the edit link above and click on the Delete button.
</li>
<li> Save - Click <a class="external" href="http://localhost:8080/appfuse/editPerson.html?id=1">edit</a><img class="outlink" src="images/out.png" alt="" /> and then click the Save button.
</li>
</ul>
<p>Canoo tests are pretty slick in that they're simply configured in an XML file.  To add tests for add, edit, save and delete, open test/web/web-tests.xml and add the following XML.  You'll notice that this fragment has a target named <i>PersonTests</i> that runs all the related tests.  
</p>
<dl>
<dt></dt><dd><i>I use CamelCase target names (vs. the traditional lowercase, dash-separated) because when you're typing </i>-Dtestcase=Name<i>, I've found that I'm used to doing CamelCase for my JUnit Tests.</i></dd>
</dl>
<p>

<!-- ======================================================== -->
<!-- = Java Sourcecode to HTML automatically converted code = -->
<!-- =   Java2Html Converter V3.5 2003 by Markus Gebhard  markus@jave.de   = -->
<!-- =     Further information: http://www.java2html.de     = -->
<div align="left">
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff">
   <tr>
  <!-- start source code -->
   <td nowrap="nowrap" valign="top" align="left">
    <code>
<font color="#ffffff"></font><br/>
<font color="#000000">&lt;!--&nbsp;runs&nbsp;person-related&nbsp;tests&nbsp;--&gt;</font><br/>
<font color="#000000">&lt;target&nbsp;name=</font><font color="#2a00ff">&#34;PersonTests&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">depends=</font><font color="#2a00ff">&#34;EditPerson,SavePerson,AddPerson,DeletePerson&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">description=</font><font color="#2a00ff">&#34;Call&nbsp;and&nbsp;executes&nbsp;all&nbsp;person&nbsp;test&nbsp;cases&nbsp;(targets)&#34;</font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;echo&gt;Successfully&nbsp;ran&nbsp;all&nbsp;Person&nbsp;JSP&nbsp;tests!&lt;/echo&gt;</font><br/>
<font color="#000000">&lt;/target&gt;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#000000">&lt;!--&nbsp;Verify&nbsp;the&nbsp;edit&nbsp;person&nbsp;screen&nbsp;displays&nbsp;without&nbsp;errors&nbsp;--&gt;</font><br/>
<font color="#000000">&lt;target&nbsp;name=</font><font color="#2a00ff">&#34;EditPerson&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">description=</font><font color="#2a00ff">&#34;Tests&nbsp;editing&nbsp;an&nbsp;existing&nbsp;Person's&nbsp;information&#34;</font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;webtest&nbsp;name=</font><font color="#2a00ff">&#34;editPerson&#34;</font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&amp;config;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;steps&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&amp;login;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;invoke&nbsp;description=</font><font color="#2a00ff">&#34;click&nbsp;Edit&nbsp;Person&nbsp;link&#34;&nbsp;</font><font color="#000000">url=</font><font color="#2a00ff">&#34;/editPerson.html?id=1&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;verifytitle&nbsp;description=</font><font color="#2a00ff">&#34;we&nbsp;should&nbsp;see&nbsp;the&nbsp;personDetail&nbsp;title&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">text=</font><font color="#2a00ff">&#34;.*${personDetail.title}.*&#34;&nbsp;</font><font color="#000000">regex=</font><font color="#2a00ff">&#34;true&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/steps&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/webtest&gt;</font><br/>
<font color="#000000">&lt;/target&gt;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#000000">&lt;!--&nbsp;Edit&nbsp;a&nbsp;person&nbsp;and&nbsp;then&nbsp;save&nbsp;--&gt;</font><br/>
<font color="#000000">&lt;target&nbsp;name=</font><font color="#2a00ff">&#34;SavePerson&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">description=</font><font color="#2a00ff">&#34;Tests&nbsp;editing&nbsp;and&nbsp;saving&nbsp;a&nbsp;user&#34;</font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;webtest&nbsp;name=</font><font color="#2a00ff">&#34;savePerson&#34;</font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&amp;config;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;steps&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&amp;login;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;invoke&nbsp;description=</font><font color="#2a00ff">&#34;click&nbsp;Edit&nbsp;Person&nbsp;link&#34;&nbsp;</font><font color="#000000">url=</font><font color="#2a00ff">&#34;/editPerson.html?id=1&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;verifytitle&nbsp;description=</font><font color="#2a00ff">&#34;we&nbsp;should&nbsp;see&nbsp;the&nbsp;personDetail&nbsp;title&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">text=</font><font color="#2a00ff">&#34;.*${personDetail.title}.*&#34;&nbsp;</font><font color="#000000">regex=</font><font color="#2a00ff">&#34;true&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;setinputfield&nbsp;description=</font><font color="#2a00ff">&#34;set&nbsp;lastName&#34;&nbsp;</font><font color="#000000">name=</font><font color="#2a00ff">&#34;person.lastName&#34;&nbsp;</font><font color="#000000">value=</font><font color="#2a00ff">&#34;Canoo&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;clickbutton&nbsp;label=</font><font color="#2a00ff">&#34;Save&#34;&nbsp;</font><font color="#000000">description=</font><font color="#2a00ff">&#34;Click&nbsp;Save&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;verifytitle&nbsp;description=</font><font color="#2a00ff">&#34;Page&nbsp;re-appears&nbsp;if&nbsp;save&nbsp;successful&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">text=</font><font color="#2a00ff">&#34;.*${personDetail.title}.*&#34;&nbsp;</font><font color="#000000">regex=</font><font color="#2a00ff">&#34;true&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;verifytext&nbsp;description=</font><font color="#2a00ff">&#34;verify&nbsp;success&nbsp;message&#34;&nbsp;</font><font color="#000000">text=</font><font color="#2a00ff">&#34;${person.updated}&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/steps&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/webtest&gt;</font><br/>
<font color="#000000">&lt;/target&gt;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#000000">&lt;!--&nbsp;Add&nbsp;a&nbsp;</font><font color="#7f0055"><b>new&nbsp;</b></font><font color="#000000">Person&nbsp;--&gt;</font><br/>
<font color="#000000">&lt;target&nbsp;name=</font><font color="#2a00ff">&#34;AddPerson&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">description=</font><font color="#2a00ff">&#34;Adds&nbsp;a&nbsp;new&nbsp;Person&#34;</font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;webtest&nbsp;name=</font><font color="#2a00ff">&#34;addPerson&#34;</font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&amp;config;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;steps&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&amp;login;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;invoke&nbsp;description=</font><font color="#2a00ff">&#34;click&nbsp;Add&nbsp;Button&#34;&nbsp;</font><font color="#000000">url=</font><font color="#2a00ff">&#34;/editPerson.html&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;verifytitle&nbsp;description=</font><font color="#2a00ff">&#34;we&nbsp;should&nbsp;see&nbsp;the&nbsp;personDetail&nbsp;title&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">text=</font><font color="#2a00ff">&#34;.*${personDetail.title}.*&#34;&nbsp;</font><font color="#000000">regex=</font><font color="#2a00ff">&#34;true&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;setinputfield&nbsp;description=</font><font color="#2a00ff">&#34;set&nbsp;firstName&#34;&nbsp;</font><font color="#000000">name=</font><font color="#2a00ff">&#34;person.firstName&#34;&nbsp;</font><font color="#000000">value=</font><font color="#2a00ff">&#34;Abbie&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;setinputfield&nbsp;description=</font><font color="#2a00ff">&#34;set&nbsp;lastName&#34;&nbsp;</font><font color="#000000">name=</font><font color="#2a00ff">&#34;person.lastName&#34;&nbsp;</font><font color="#000000">value=</font><font color="#2a00ff">&#34;Raible&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;clickbutton&nbsp;label=</font><font color="#2a00ff">&#34;${button.save}&#34;&nbsp;</font><font color="#000000">description=</font><font color="#2a00ff">&#34;Click&nbsp;button&nbsp;'Save'&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;verifytitle&nbsp;description=</font><font color="#2a00ff">&#34;Main&nbsp;Menu&nbsp;appears&nbsp;if&nbsp;save&nbsp;successful&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">text=</font><font color="#2a00ff">&#34;.*${mainMenu.title}.*&#34;&nbsp;</font><font color="#000000">regex=</font><font color="#2a00ff">&#34;true&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;verifytext&nbsp;description=</font><font color="#2a00ff">&#34;verify&nbsp;success&nbsp;message&#34;&nbsp;</font><font color="#000000">text=</font><font color="#2a00ff">&#34;${person.added}&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/steps&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/webtest&gt;</font><br/>
<font color="#000000">&lt;/target&gt;</font><br/>
<font color="#ffffff"></font><br/>
<font color="#000000">&lt;!--&nbsp;Delete&nbsp;existing&nbsp;person&nbsp;--&gt;</font><br/>
<font color="#000000">&lt;target&nbsp;name=</font><font color="#2a00ff">&#34;DeletePerson&#34;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">description=</font><font color="#2a00ff">&#34;Deletes&nbsp;existing&nbsp;Person&#34;</font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;webtest&nbsp;name=</font><font color="#2a00ff">&#34;deletePerson&#34;</font><font color="#000000">&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&amp;config;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;steps&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&amp;login;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;invoke&nbsp;description=</font><font color="#2a00ff">&#34;click&nbsp;Edit&nbsp;Person&nbsp;link&#34;&nbsp;</font><font color="#000000">url=</font><font color="#2a00ff">&#34;/editPerson.html?id=1&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;prepareDialogResponse&nbsp;description=</font><font color="#2a00ff">&#34;Confirm&nbsp;delete&#34;&nbsp;</font><font color="#000000">dialogType=</font><font color="#2a00ff">&#34;confirm&#34;&nbsp;</font><font color="#000000">response=</font><font color="#2a00ff">&#34;true&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;clickbutton&nbsp;label=</font><font color="#2a00ff">&#34;${button.delete}&#34;&nbsp;</font><font color="#000000">description=</font><font color="#2a00ff">&#34;Click&nbsp;button&nbsp;'Delete'&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;verifyNoDialogResponses/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;verifytitle&nbsp;description=</font><font color="#2a00ff">&#34;display&nbsp;Main&nbsp;Menu&#34;&nbsp;</font><font color="#000000">text=</font><font color="#2a00ff">&#34;.*${mainMenu.title}.*&#34;&nbsp;</font><font color="#000000">regex=</font><font color="#2a00ff">&#34;true&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;verifytext&nbsp;description=</font><font color="#2a00ff">&#34;verify&nbsp;success&nbsp;message&#34;&nbsp;</font><font color="#000000">text=</font><font color="#2a00ff">&#34;${person.deleted}&#34;</font><font color="#000000">/&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/steps&gt;</font><br/>
<font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&lt;/webtest&gt;</font><br/>
<font color="#000000">&lt;/target&gt;</font></code>
    
   </td>
  <!-- end source code -->
   </tr>
</table>
</div>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->


</p>
<p>After adding this, you should be able to run <b>ant test-canoo -Dtestcase=PersonTests</b> with Tomcat running or <b>ant test-jsp -Dtestcase=PersonTests</b> if you want Ant to start/stop Tomcat for you.  To include the PersonTests when all Canoo tests are run, add it as a dependency to the "run-all-tests" target.
</p>
<p>You'll notice that there's no logging in the client-side window by Canoo.  If you'd like to see what it's doing, you can add the following between &lt;/webtest&gt; and &lt;/target&gt; at the end of each target.
</p>
<pre>&lt;loadfile property="web-tests.result" 
    srcFile="${test.dir}/data/web-tests-result.xml"/&gt;
&lt;echo&gt;${web-tests.result}&lt;/echo&gt;</pre>

<span style="color:green">BUILD SUCCESSFUL<br />
Total time: 10 seconds</span>
<p></p>
<hr />
<p><i>Next Up:</i> <b>Part IV:</b> <a class="wikipage" href="Wiki.jsp?page=ValidationAndListWebWork">Adding Validation and List Screen</a> - Adding validation logic to the personForm so that firstName and lastName are required fields and adding a list screen to display all person records in the database.
</p>
</BODY></HTML>
